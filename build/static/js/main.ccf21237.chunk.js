(this["webpackJsonpmarigold-app"]=this["webpackJsonpmarigold-app"]||[]).push([[0],{255:function(e,t,n){},256:function(e,t,n){},323:function(e,t,n){},423:function(e,t,n){},425:function(e,t,n){},426:function(e,t,n){},431:function(e,t,n){},432:function(e,t,n){},435:function(e,t,n){},436:function(e,t,n){},437:function(e,t,n){},438:function(e,t,n){"use strict";n.r(t);var a,r=n(36),c=n(23),i=n.n(c),s=n(86),l=n(452),o=n(457),d=n(135),u="AUTH",b={LOGIN:"".concat(u,"/LOGIN"),LOGOUT:"".concat(u,"/LOGOUT")},j={user:null,accessToken:null,refreshToken:null},p=Object(l.a)(Object(s.a)({},b.LOGIN,(function(e,t){var n=t.payload;return Object(r.a)(Object(r.a)({},e),n)})),j),h={login:Object(o.a)(b.LOGIN),logout:Object(o.a)(b.LOGOUT)},O=function(e){return e.AUTH||j},m=function(){return Object(d.a)(O,(function(e){return e.user}))},v=function(){return Object(d.a)(O,(function(e){return e.accessToken}))},x=function(){return Object(d.a)(O,(function(e){return e.refreshToken}))},f=p,g="marigold_app",y="An error occurred while processing your request",S="\u2014",C=10,P=500,k="manager",I="personnel",T="supplier",_="customer",N="vat",A="vat-e",D="delivery",w="market",E="pickup",z="special",L="available",R="reorder",F="out_of_stock",B={APPROVED:"approved",PENDING:"pending",DELIVERED:"delivered",CANCELLED:"cancelled"},q="pending",V="delivered",M="cancelled",Y="paid",Q="unpaid",U="pickup",G="delivery",H="market",K="special",W={DAILY:"daily",MONTHLY:"monthly",DATE_RANGE:"date_range"},X=n(37),Z=n.n(X),J={API_URL:"http://".concat(window.location.hostname,":8000/v1/")},$=n(166),ee=n(81),te=n(167),ne=n.n(te),ae="USER_INTEFACE",re={ON_COLLAPSE_SIDEBAR:"".concat(ae,"/ON_COLLAPSE_SIDEBAR")},ce={isSidebarCollapsed:!1},ie=Object(l.a)(Object(s.a)({},re.ON_COLLAPSE_SIDEBAR,(function(e,t){var n=t.payload;return Object(r.a)(Object(r.a)({},e),{},{isSidebarCollapsed:n})})),ce),se={onCollapseSidebar:Object(o.a)(re.ON_COLLAPSE_SIDEBAR)},le=function(e){return e[ae]||ce},oe=function(){return Object(d.a)(le,(function(e){return e.isSidebarCollapsed}))},de=ie,ue=Object(ee.b)((a={router:$.routerReducer},Object(s.a)(a,u,f),Object(s.a)(a,ae,de),a)),be=function(e,t){return t.type===b.LOGOUT&&(ne.a.removeItem(g),e=void 0),ue(e,t)},je=n(58),pe=n(194),he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(je.b)(),n=[Object($.routerMiddleware)(t)],a=[ee.a.apply(void 0,n)],r={key:g,storage:ne.a,blacklist:["_persist"],keyPrefix:""},c=Object(pe.a)(r,be),i=Object(ee.d)(c,e,ee.c.apply(void 0,a));return i},Oe=n(0),me=n(41),ve=n.n(me),xe=n(28),fe=n(260),ge=n(82),ye=n(262),Se=n(30),Ce=n(20),Pe=n(33),ke=n.n(Pe),Ie=n(46),Te=n(8),_e=n(463),Ne=n(464),Ae=n(458),De=n(454),we=n(450),Ee=n(49),ze=n.p+"static/media/logo.6979545f.png",Le=n(5),Re=n.n(Le),Fe=(n(323),n(1)),Be=function(e){var t=e.children,n=e.className;return Object(Fe.jsx)("div",{className:Re()("Box",n),children:t})},qe=n(25),Ve=function(e){var t=Object(ge.b)();return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(e(n))}},Me=function(){return{user:Object(ge.c)(m()),accessToken:Object(ge.c)(v()),refreshToken:Object(ge.c)(x()),login:Ve(h.login),logout:Ve(h.logout)}},Ye={login:function(e){var t=e.body;return i.a.post("".concat("/users/","login/"),t)}},Qe="/branches/",Ue={list:function(e){var t=e.params;return i.a.get("".concat(Qe),{params:t})},create:function(e){var t=e.body;return i.a.post("".concat(Qe),t)},edit:function(e){var t=e.id,n=e.body;return i.a.patch("".concat(Qe).concat(t,"/"),n)},delete:function(e){return i.a.delete("".concat(Qe).concat(e,"/"))}},Ge="/branch-products/",He={list:function(e){var t=e.params;return i.a.get(Ge,{params:t})},convert:function(e){var t=e.body;return i.a.post("".concat(Ge,"convert/"),t)}},Ke={list:function(e){var t=e.params;return i.a.get("".concat("/clients/"),{params:t})}},We="/deliveries/",Xe={list:function(e){var t=e.params;return i.a.get("".concat(We),{params:t})},retrieve:function(e){return i.a.get("".concat(We).concat(e,"/"))},create:function(e){var t=e.body;return i.a.post("".concat(We),t)},edit:function(e){var t=e.id,n=e.body;return i.a.patch("".concat(We).concat(t,"/"),n)}},Ze="/notifications/",Je={list:function(e){var t=e.params;return i.a.get("".concat(Ze),{params:t})},count:function(){return i.a.get("".concat(Ze,"count/"))}},$e="/preorders/",et={list:function(e){var t=e.params;return i.a.get("".concat($e),{params:t})},retrieve:function(e){return i.a.get("".concat($e).concat(e,"/"))},create:function(e){var t=e.body;return i.a.post("".concat($e),t)},edit:function(e){var t=e.id,n=e.body;return i.a.patch("".concat($e).concat(t,"/"),n)}},tt={create:function(e){var t=e.body;return i.a.post("".concat("/preorder-transactions/"),t)}},nt="/products/",at={list:function(e){var t=e.params;return i.a.get("".concat(nt),{params:t})},retrieve:function(e){return i.a.get("".concat(nt).concat(e,"/"))},create:function(e){var t=e.body;return i.a.post("".concat(nt),t)},edit:function(e){var t=e.id,n=e.body;return i.a.patch("".concat(nt).concat(t,"/"),n)},delete:function(e){return i.a.delete("".concat(nt).concat(e,"/"))}},rt="/reports/",ct={listTopPayingCustomers:function(e){var t=e.params;return i.a.get("".concat(rt,"top-customers/"),{params:t})},listTopSellingProducts:function(e){var t=e.params;return i.a.get("".concat(rt,"top-products/"),{params:t})}},it={acquire:function(e){var t=e.body;return i.a.post("".concat("/tokens/","acquire/"),t)}},st="/unit-types/",lt={list:function(e){var t=e.params;return i.a.get("".concat(st),{params:t})},create:function(e){return i.a.post("".concat(st),e)},edit:function(e,t){return i.a.patch("".concat(st).concat(e,"/"),t)}},ot=function(){return Object(xe.useQuery)("useBranches",(function(){return Ue.list({params:{page:1,page_size:C}}).catch((function(e){return Promise.reject(e.errors)}))}),{initialData:{data:{results:[]}},select:function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.results}})},dt=function(e){var t=e.params,n=e.options;return Object(xe.useQuery)(["useBranchProducts",null===t||void 0===t?void 0:t.branchId,null===t||void 0===t?void 0:t.page,null===t||void 0===t?void 0:t.pageSize,null===t||void 0===t?void 0:t.search,null===t||void 0===t?void 0:t.status],(function(){return He.list({params:{branch_id:null===t||void 0===t?void 0:t.branchId,page_size:(null===t||void 0===t?void 0:t.pageSize)||C,page:(null===t||void 0===t?void 0:t.page)||1,search:null===t||void 0===t?void 0:t.search,status:null===t||void 0===t?void 0:t.status}})}),Object(r.a)({initialData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}},n))},ut=function(e){var t=e.params;return Object(xe.useQuery)(["useClients",t.type],(function(){return Ke.list({params:{type:t.type}})}),{initialData:{data:[]},select:function(e){return e.data}})},bt=function(){var e=Object(Se.c)(),t=Object(Te.a)(e,2),n=t[0],a=t[1];return{setSearchParams:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=t.shouldResetPage,i=void 0!==c&&c,s=t.shouldIncludeCurrentParams,l=void 0===s||s,o=Object(r.a)(Object(r.a)(Object(r.a)({},l?Object.fromEntries(n):{}),i?{page:1}:{}),e);Object.keys(o).forEach((function(e){return void 0===o[e]?delete o[e]:{}})),a(o)}}},jt=function(e){var t=e.params;return Object(xe.useQuery)(["useDeliveries",t.page,t.pageSize,t.paymentStatus],(function(){return Xe.list({params:{payment_status:t.paymentStatus,page:t.page,page_size:t.pageSize}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{deliveries:e.data.results,total:e.data.count}}})},pt=function(e){var t=e.params;return Object(xe.useQuery)(["useNotifications",t.page,t.pageSize,t.branchId],(function(){return Je.list({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{notifications:e.data.results,total:e.data.count}}})},ht=function(){return Object(xe.useQuery)("useNotificationsCount",(function(){return Je.count()}),{initialData:{data:0},select:function(e){return e.data},refetchInterval:2500})},Ot=function(e){var t=e.id;return Object(xe.useQuery)(["usePreorderRetrieve",t],(function(){return et.retrieve(t)}),{select:function(e){return e.data},enabled:void 0!==t})},mt=function(){return Object(xe.useMutation)((function(e){var t=e.id,n=e.description,a=e.preorderProducts,r=e.status;return et.edit({id:t,body:{description:n,preorder_products:a,status:r}})}))},vt=function(e){var t=e.params;return Object(xe.useQuery)(["usePreorders",null===t||void 0===t?void 0:t.dateCreated,null===t||void 0===t?void 0:t.dateFulfilled,null===t||void 0===t?void 0:t.page,null===t||void 0===t?void 0:t.pageSize,null===t||void 0===t?void 0:t.search,null===t||void 0===t?void 0:t.status],(function(){return et.list({params:{date_created:null===t||void 0===t?void 0:t.dateCreated,date_fulfilled:null===t||void 0===t?void 0:t.dateFulfilled,page:(null===t||void 0===t?void 0:t.page)||1,page_size:(null===t||void 0===t?void 0:t.pageSize)||C,search:null===t||void 0===t?void 0:t.search,status:null===t||void 0===t?void 0:t.status}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{preorders:e.data.results,total:e.data.count}}})},xt=function(e){var t=e.id;return Object(xe.useQuery)(["useProduct",t],(function(){return at.retrieve(t)}),{select:function(e){return e.data},enabled:void 0!==t})},ft=function(e){var t=e.params,n=e.options;return Object(xe.useQuery)(["useProducts",null===t||void 0===t?void 0:t.page,null===t||void 0===t?void 0:t.pageSize,null===t||void 0===t?void 0:t.search],(function(){return at.list({params:{page:(null===t||void 0===t?void 0:t.page)||1,page_size:(null===t||void 0===t?void 0:t.pageSize)||C,search:null===t||void 0===t?void 0:t.search,ids:null===t||void 0===t?void 0:t.ids}})}),Object(r.a)({initialData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}},n))},gt=function(e){var t=e.params;return Object(xe.useQuery)(["useReportsCustomers",t.page,t.pageSize,t.dateRange],(function(){return ct.listTopPayingCustomers({params:{page:t.page,page_size:t.pageSize,date_range:t.dateRange}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{customers:e.data.results,total:e.data.count}}})},yt=function(e){var t=e.params;return Object(xe.useQuery)(["useReportsProducts",t.page,t.pageSize,t.branchId,t.dateRange],(function(){return ct.listTopSellingProducts({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId,date_range:t.dateRange}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}})},St=function(){return{isSidebarCollapsed:Object(ge.c)(oe()),onCollapseSidebar:Ve(se.onCollapseSidebar)}},Ct=function(){return Object(xe.useQuery)("useUnitTypes",(function(){return lt.list({params:{page:1,page_size:100}}).catch((function(e){return Promise.reject(e.errors)}))}),{initialData:{data:{results:[]}},select:function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.results}})},Pt=n(11),kt=(n(423),{defaultValues:{login:"",password:""},schema:Pt.c().shape({login:Pt.d().required().label("Username"),password:Pt.d().required().label("Password")})}),It=function(){var e=Object(Oe.useState)(!1),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Ce.h)(),c=Me(),i=c.user,s=c.login;return Object(Oe.useEffect)((function(){i&&r("/")}),[i]),Object(Fe.jsx)("section",{className:"Login",children:Object(Fe.jsxs)(Be,{className:"Login_container",children:[Object(Fe.jsx)("img",{alt:"logo",className:"Login_logo",src:ze}),Object(Fe.jsx)(qe.c,{initialValues:kt.defaultValues,validationSchema:kt.schema,onSubmit:function(e,t){var n=t.setFieldError;a(!0),Ye.login({body:e}).then(function(){var t=Object(Ie.a)(ke.a.mark((function t(n){var a,r,c,i;return ke.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,it.acquire({body:{username:e.login,password:e.password}});case 2:a=t.sent,r=a.data,c=r.access,i=r.refresh,s({user:n.data,accessToken:c,refreshToken:i});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){n("password","Username, email, or password is invalid.")})).finally((function(){a(!1)}))},children:function(e){var t=e.setFieldValue;return Object(Fe.jsx)(qe.b,{className:"w-100",children:Object(Fe.jsxs)(Ae.b,{className:"w-100",direction:"vertical",size:"large",children:[Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)(De.a,{placeholder:"Username",prefix:Object(Fe.jsx)(_e.a,{}),size:"large",onChange:function(e){t("login",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"login",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)(De.a,{placeholder:"Password",prefix:Object(Fe.jsx)(Ne.a,{}),size:"large",type:"password",onChange:function(e){t("password",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"password",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsx)(Ee.a,{htmlType:"submit",loading:n,size:"large",type:"primary",block:!0,children:"Login"})]})})}})]})})},Tt=n(466),_t=n(467),Nt=n(468),At=n(469),Dt=n(470),wt=n(471),Et=n(472),zt=n(473),Lt=n(281),Rt=function(e){var t=e.status;return Object(Oe.useCallback)((function(){var e=null;switch(t){case L:e=Object(Fe.jsx)(Lt.a,{color:"green",children:"Available"});break;case R:e=Object(Fe.jsx)(Lt.a,{color:"orange",children:"Reorder"});break;case F:e=Object(Fe.jsx)(Lt.a,{color:"red",children:"Out of Stock"})}return e}),[t])()},Ft=function(e){var t=e.status;return Object(Oe.useCallback)((function(){var e=null;switch(t){case q:e=Object(Fe.jsx)(Lt.a,{color:"orange",children:"Pending"});break;case V:e=Object(Fe.jsx)(Lt.a,{color:"green",children:"Delivered"});break;case M:e=Object(Fe.jsx)(Lt.a,{color:"red",children:"Cancelled"})}return e}),[t])()},Bt=function(e){var t=e.name;return Object(Fe.jsx)(qe.a,{name:t,render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})},qt=n(445),Vt=n(270),Mt=n.p+"static/media/icon-account.d6cf778e.svg",Yt=n.p+"static/media/icon-logout.a7e54751.svg",Qt=n(39),Ut=n.n(Qt),Gt=function(e){switch(e){case k:return"Manager";case I:return"Personnel";default:return null}},Ht=function(e){return e.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")},Kt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u20b1",n=Number(e);return Z.a.isNaN(n)?"":"".concat(t).concat(Ht(Z.a.round(n,2).toFixed(2)))},Wt=function(e){return e?Ut()(e).format("MM/DD/YYYY h:mma"):""},Xt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t?"".concat(t,": "):"",a=[];return Z.a.isString(e)?a=[n+e]:Z.a.isArray(e)&&(a=e.map((function(e){return n+e}))),a},Zt=(n(425),function(e){var t=e.items,n=Object(Oe.useState)(!1),a=Object(Te.a)(n,2),r=a[0],c=a[1],i=Object(Ce.g)().pathname,s=Me(),l=s.user,o=s.logout,d=St(),u=d.isSidebarCollapsed,b=d.onCollapseSidebar,j=Object(Oe.useCallback)((function(){return"".concat(null===l||void 0===l?void 0:l.first_name," ").concat(null===l||void 0===l?void 0:l.last_name)}),[l]);return Object(Fe.jsxs)(qt.a.Sider,{breakpoint:"md",className:Re()("Sidebar",{Sidebar__collapsed:u}),collapsedWidth:"0",theme:"light",width:280,onCollapse:function(e){return b(e)},children:[Object(Fe.jsx)("img",{alt:"logo",className:"Sidebar_logo",src:ze}),Object(Fe.jsx)("div",{className:"Sidebar_sidebarList",children:t.map((function(e){return Object(Fe.jsx)(Se.b,{tabIndex:-1,to:e.link,children:Object(Fe.jsxs)("div",{className:Re()("Sidebar_sidebarList_item",{Sidebar_sidebarList_item__active:i.startsWith(e.link)}),children:[Object(Fe.jsx)(e.icon,{className:"Sidebar_sidebarList_item_icon",style:{fontSize:20,color:i.startsWith(e.link)?"#e0bc5d":"#626b77"}}),Object(Fe.jsx)("span",{className:"Sidebar_sidebarList_item_name",children:e.name}),(null===e||void 0===e?void 0:e.count)>0&&Object(Fe.jsx)("span",{className:"Sidebar_sidebarList_item_itemCount",children:null===e||void 0===e?void 0:e.count})]})},e.link)}))}),Object(Fe.jsxs)("div",{className:Re()("bottom",{active:r}),onClick:function(){return c((function(e){return!e}))},children:[Object(Fe.jsxs)("div",{className:"menu",children:[Object(Fe.jsxs)("div",{className:"item",children:[Object(Fe.jsx)("img",{alt:"icon",className:"icon",src:Mt}),Object(Fe.jsx)("span",{className:"name",children:"Account"})]}),Object(Fe.jsxs)("div",{className:"item",onClick:function(){return o()},children:[Object(Fe.jsx)("img",{alt:"icon",className:"icon",src:Yt}),Object(Fe.jsx)("span",{className:"name",children:"Logout"})]})]}),Object(Fe.jsxs)("div",{className:"user-details",children:[Object(Fe.jsx)("img",{alt:"user avatar",className:"avatar",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAvVBMVEXh4eGjo6OkpKSpqamrq6vg4ODc3Nzd3d2lpaXf39/T09PU1NTBwcHOzs7ExMS8vLysrKy+vr7R0dHFxcXX19e5ubmzs7O6urrZ2dmnp6fLy8vHx8fY2NjMzMywsLDAwMDa2trV1dWysrLIyMi0tLTCwsLKysrNzc2mpqbJycnQ0NC/v7+tra2qqqrDw8OoqKjGxsa9vb3Pz8+1tbW3t7eurq7e3t62travr6+xsbHS0tK4uLi7u7vW1tbb29sZe/uLAAAG2UlEQVR4XuzcV47dSAyG0Z+KN+ccO+ecHfe/rBl4DMNtd/cNUtXD6DtLIAhCpMiSXwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIhHnfm0cVirHTam884sVu6Q1GvPkf0heq7VE+UF5bt2y97Vat+VlRniev/EVjjp12NlgdEytLWEy5G2hepDYOt7qGob2L23Dd3valPY6dsW+jvaBOKrkm2ldBVrbag+2tYeq1oX6RxYBsF6SY3vA8to8F0roRJaZmFFK2ASWA6CiT6EhuWkoQ9gablZ6l1oW47aWoF8dpvT6FrOunoD5pa7uf6CaslyV6rqD0guzYHLRK/hwJw40Cu4MUdu9Bt8C8yR4Jt+gRbmzEKvUTicFw8kY3NonOg/aJpTTf2AWWBOBTNBkvrmWF+QNDPnZoLUNOeagpKSOVdKhK550BVa5kGLOFfMCxY92ubFuYouNC9CFdyuebKrYrsyL9hcGpgnAxVaXDJPSrGKrGreVFVkU/NmykDJj1sV2Z55s0e74hwtS9k8KvNzxY8ZozvX+L67M4/uVFwT84Kt9CPz6EjFdUqgMyCjCTSHWD4cq7jOzKMzxtGu8ddwxzzaUXHFgXkTxCqwyLyJOON0j9POc/OCpbAj+hU/Zsz9Pbk2T65VbM/mybOKbd882VexjegLPXk0L154uvF/tR5N7RjJB9bvBsLEPJgI5dCcC2P5wL3QlSClJ+bYSSpIqpljh4IkpWNzapzqB3T9vCGBuGUOtWL9hDNPizMYmjND/QIloTkSJvKB4tHRK1iaE0u9hnhgDgxi/QFJZLmLEv0FvbHlbNzTG9ApWa5KHb0J9cByFNT1DhznGOngWO9CvWQ5KdX1AXweWy7Gn/Uh9CLLQdTTCkgPLLODVCshPrSMarHWgUpkGURrl2c83drWbp+0PlRebCsvFW0G+6FtLNzXxlDuXttGrrtlbQPlacvW1ppmCDPOHgJbQ/BwpmyQnh6siHVwcJoqB3iqNx/tHY/N+pPyg7Rz83Xv0n5zuff1ppPKCSS9audf1V6i9QAAAAAAAAAAAAAAAAAAAAAAEMdyAuVeZ9I4H95/uojGgf0QjKOLT/fD88ak0ysrI6SVo9qXRWgrhIsvtaNKqs2hXNlvD0LbSDho71fKWhsxvulf2NYu+jcro42d+e0isMyCxe18R2/D6HQYWY6i4elIryE9brbMgVbzONVP2G3sBeZMsNfYFf5h715302aDIADP2Lw+CIdDQhKcGuIgKKSIk1MSMND7v6zvBvqprdqY3bWfS1itRto/O+52t+KnW+2+OdSYK+5TViS9LxxqyX07p6xUeq7hXl+WPq/AX15QI+9fDryaw5d31EP7HPGqonMb5rmvYwow/upgWTDzKYQ/C2BV3o8oSNTPYVH26FEY7zGDNfnZo0DeOYclwc6jUN4ugBVxZ0HBFp0YJoxaFK41gn7ZGxWYZtDNrSOqEK0dFLscqMbhArXuIioS3UGnHw9U5uEHFCp9quOXUGfrUSFvC11cl0p1nbK+KwHs92yFYyo2DqFEsKdq+wAqhHsqtw+hQHykescY4rnvNOC7g3TPNOEZwt3QiBuINkxpRDqEZFOaMYVgTzTkCWKFGxqyCSHVkqYsIVQQ0ZQogEwJjUkgkvNpjO8g0ZzmzCHRieacIJBLaU7qIE+bBrUhz5YGbSHPmQadIc+EBk0gT48G9SDPPQ06QZ5gQ3M2AQQa0ZwRqtCExz1kClc0ZRVCqFuacguxEhqSQC53pBlHB8HyDY3Y5BDttgnoinRoQgfinZrTuxrxgeodYiiQ+1TOz6HCy4KqLV6gREHVCqjxSsVeociaaq2hyjOVeoYyXarUhTrdZs4VeaQ6j9DIdZsXEhXpU5U+1EqoSALFtlRjC9VGHlXwRlCuTKlAWkK9rEfxehkMCB8o3EMIE1yfovUdrHiKKFb0BEMuPQrVu8CU9xNFOr3DmtcFxVm8wqBsTGHGGUxya4+CeGsHqwZjijEewDAn5Rt9dOdgWzZt6kAqMm/xylpz1EI8i3hF0SxGXQxPvJrTEHXyMuVVTF9QN+WElZuUqKPiyEodC9RV+cbKvJWos0E1TbTe4wB1l89W/GSrWY4G4G4+NUHebhwEkGGYtPgpWskQAkjSXvr8x/xlGz/RKHcr/jOrXYn/1bh0Jh7/mjfpXPALjXC+O/Av7HfzEL+nERbJZME/tpgkRYg/1Mjms48Wf1PrYzbPIIBW8aDY9j/2vsef8vz9R39bDOL/2qlDIwCBGACCOMTLl4klOpP+i4MimFe7DZy7v3rcuaYqej+f3VE1K09+AgAAAAAAAAAAAAAAAAAAAAAAgBf6wsTW1jN3CAAAAABJRU5ErkJggg=="}),Object(Fe.jsxs)("div",{className:"user-text-info",children:[Object(Fe.jsx)("span",{className:"name",children:j()}),Object(Fe.jsx)("span",{className:"role",children:Gt(null===l||void 0===l?void 0:l.user_type)})]})]})]})]})}),Jt=(n(426),function(e){var t=e.loading,n=e.loadingText,a=e.sidebarItems,r=e.children;return Object(Fe.jsx)(qt.a,{className:"Container",children:Object(Fe.jsxs)(Vt.a,{size:"large",spinning:t,tip:n,wrapperClassName:"Container_spinner",children:[Object(Fe.jsx)(Zt,{items:a}),r]})})});Jt.defaultProps={loading:!1,loadingText:"Fetching data..."};var $t,en=Jt,tn=(n(431),function(e){var t=e.title,n=e.breadcrumb,a=e.className,r=e.children,c=St().isSidebarCollapsed;return Object(Fe.jsxs)(qt.a,{className:Re()("ContentLayout",a,{ContentLayout__sidebarCollapsed:c}),children:[Object(Fe.jsx)(qt.a.Header,{className:"ContentLayout_header",children:Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)("h3",{className:"ContentLayout_header_title",children:t}),n]})}),Object(Fe.jsx)(qt.a.Content,{className:"ContentLayout_mainContent",children:r})]})}),nn=function(e){var t=e.status;return Object(Oe.useCallback)((function(){var e=null;switch(t){case Q:e=Object(Fe.jsx)(Lt.a,{color:"orange",children:"Unpaid"});break;case Y:e=Object(Fe.jsx)(Lt.a,{color:"green",children:"Paid"})}return e}),[t])()},an=function(e){var t=e.status;return Object(Oe.useCallback)((function(){var e=null;switch(t){case B.APPROVED:e=Object(Fe.jsx)(Lt.a,{color:"blue",children:"Approved"});break;case B.PENDING:e=Object(Fe.jsx)(Lt.a,{color:"orange",children:"Pending"});break;case B.DELIVERED:e=Object(Fe.jsx)(Lt.a,{color:"green",children:"Delivered"});break;case B.CANCELLED:e=Object(Fe.jsx)(Lt.a,{color:"red",children:"Cancelled"})}return e}),[t])()},rn=n(465),cn=function(e){var t=e.rank;return Object(Oe.useCallback)((function(){var e=null;switch(t){case 1:e=Object(Fe.jsx)(rn.a,{style:{fontSize:"1.5rem",marginRight:"5px",color:"#FFD700"}});break;case 2:e=Object(Fe.jsx)(rn.a,{style:{fontSize:"1.25rem",marginRight:"5px",color:"#C0C0C0"}});break;case 3:e=Object(Fe.jsx)(rn.a,{style:{fontSize:"1rem",marginRight:"5px",color:"#CD7F32"}})}return e}),[t])()},sn=n(131),ln=function(e){var t=e.children;return Object(Fe.jsxs)(Ae.b,{align:"center",className:"my-1",children:[Object(Fe.jsx)(we.a.Text,{type:"danger",children:Object(Fe.jsx)(sn.a,{})}),Object(Fe.jsx)(we.a.Text,{type:"danger",children:t})]})},on=(n(432),function(e){var t=e.className,n=e.errors;return Object(Fe.jsx)(Ae.b,{className:Re()("RequestErrors",t),direction:"vertical",children:null===n||void 0===n?void 0:n.map((function(e,t){return Object(Fe.jsx)(ln,{children:e},t)}))})}),dn=function(){var e=Object(Ce.h)(),t=Me().user,n=ht().data;Object(Oe.useEffect)((function(){t||e("/login")}),[t]);var a=Object(Oe.useCallback)((function(){return[{name:"Dashboard",icon:Tt.a,link:"/dashboard"},{name:"Products",icon:_t.a,link:"/products"},{name:"Unit Types",icon:Nt.a,link:"/unit-types"},{name:"Branches",icon:At.a,link:"/branches"},{name:"Preorders",icon:Dt.a,link:"/preorders"},{name:"Deliveries",icon:wt.a,link:"/deliveries"},{name:"Reports",icon:Et.a,link:"/reports"},{name:"Notifications",icon:zt.a,link:"/notifications",count:n}]}),[n]);return Object(Fe.jsx)(en,{sidebarItems:a(),children:Object(Fe.jsx)(Ce.b,{})})},un=n(282),bn=n(459),jn=n(448),pn=n(453),hn=function(e){var t=e.branch,n=e.onSuccess,a=e.onClose,r=Object(Oe.useState)(!1),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useRef)(),o=Object(Oe.useCallback)((function(){return{defaultValues:{id:null===t||void 0===t?void 0:t.id,name:(null===t||void 0===t?void 0:t.name)||""},schema:Pt.c().shape({name:Pt.d().required().label("Name")})}}),[t]);return Object(Fe.jsx)(pn.a,{footer:[Object(Fe.jsx)(Ee.a,{disabled:i,size:"large",onClick:a,children:"Cancel"}),Object(Fe.jsx)(Ee.a,{loading:i,size:"large",type:"primary",onClick:function(){l.current.submitForm()},children:"Submit"})],title:t?"[Edit] Branch":"[Create] Branch",centered:!0,closable:!0,visible:!0,onCancel:a,children:Object(Fe.jsx)(qe.c,{initialValues:o().defaultValues,innerRef:l,validationSchema:o().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(t,r){var c,i;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.setFieldError,s(!0),e.prev=2,i=t.id?Ue.edit:Ue.create,e.next=6,i({id:t.id,body:t});case 6:n(),a(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),c("name",y);case 13:return e.prev=13,s(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(Fe.jsxs)(qe.b,{children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Name"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"name",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]})}})})},On=[{title:"Name",dataIndex:"name"},{title:"Actions",dataIndex:"actions"}],mn=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Oe.useState)(!1),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useState)(null),o=Object(Te.a)(l,2),d=o[0],u=o[1],b=Object(Oe.useState)(!1),j=Object(Te.a)(b,2),p=j[0],h=j[1],O=ot(),m=O.isFetching,v=O.data,x=O.refetch;return Object(Oe.useEffect)((function(){var e=v.map((function(e){return{key:e.id,name:e.name,actions:Object(Fe.jsxs)(Ae.b,{children:[Object(Fe.jsx)(Ee.a,{type:"link",onClick:function(){!function(e){u(e),s(!0)}(e)},children:"Edit"}),Object(Fe.jsx)(bn.a,{cancelText:"No",okButtonProps:{loading:p},okText:"Yes",placement:"top",title:"Are you sure you want to delete ".concat(e.name,"?"),onConfirm:function(){var t;t=e.id,h(!0),Ue.delete(t).then((function(){x()})).finally((function(){h(!1)}))},children:Object(Fe.jsx)(Ee.a,{type:"link",danger:!0,children:"Delete"})})]})}}));a(e)}),[v]),Object(Fe.jsx)(tn,{title:"Branches",children:Object(Fe.jsxs)(Be,{children:[Object(Fe.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){u(null),s(!0)},children:[Object(Fe.jsx)(un.a,{})," Create Branch"]})}),Object(Fe.jsx)(jn.a,{columns:On,dataSource:n,loading:m,pagination:!1}),i&&Object(Fe.jsx)(hn,{branch:d,onClose:function(){u(null),s(!1)},onSuccess:x})]})})},vn=n(27),xn=n(474),fn=n(280),gn=n(451),yn=n(460),Sn=n(461),Cn=n(148),Pn=n(446),kn=function(){var e=Object(Se.c)(),t=Object(Te.a)(e,1)[0],n=bt().setSearchParams,a=Object(Pn.a)((function(e){n({search:e})}),P);return Object(Fe.jsxs)(yn.a,{className:"mb-4",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Search"}),Object(Fe.jsx)(De.a,{defaultValue:t.get("search"),allowClear:!0,onChange:function(e){return a(e.target.value.trim())}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Status"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",value:t.get("status"),allowClear:!0,onChange:function(e){n({status:e})},children:[Object(Fe.jsx)(Cn.a.Option,{value:L,children:"Available"}),Object(Fe.jsx)(Cn.a.Option,{value:R,children:"Reorder"}),Object(Fe.jsx)(Cn.a.Option,{value:F,children:"Out of Stock"})]})]})]})},In=function(e){var t=e.unitTypes,n=Object(Oe.useState)([]),a=Object(Te.a)(n,2),r=a[0],c=a[1],i=Object(Se.c)(),s=Object(Te.a)(i,1)[0],l=bt().setSearchParams,o=dt({params:{page:s.get("page"),pageSize:s.get("pageSize"),branchId:s.get("branchId"),search:s.get("search"),status:s.get("status")}}),d=o.isFetching,u=o.data,b=u.total,j=u.products;Object(Oe.useEffect)((function(){var e=j.map((function(e){var t={key:e.id,name:Object(Fe.jsx)(Se.b,{to:"/products?search=".concat(e.name),children:e.name}),status:Object(Fe.jsx)(Rt,{status:e.status})};return e.product_prices.forEach((function(e){t[String(e.unit_type_id)]=e.balance})),t}));c(e)}),[j]);var p=Object(Oe.useCallback)((function(){var e=Object(X.flatten)(null===j||void 0===j?void 0:j.map((function(e){return e.product_prices.map((function(e){return e.unit_type_id}))}))),n=t.filter((function(t){return e.includes(t.id)}));return[{title:"Name",dataIndex:"name",fixed:"left"}].concat(Object(vn.a)(n.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))),[{title:"Status",dataIndex:"status"}])}),[j,t]);return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(kn,{}),Object(Fe.jsx)(jn.a,{columns:p(),dataSource:r,loading:d,pagination:{current:Number(s.get("page"))||1,total:b,pageSize:Number(s.get("pageSize"))||C,onChange:function(e,t){l({page:e,pageSize:t})},disabled:0===j.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:1e3}})]})},Tn=n(462),_n=n(447),Nn=n(103),An=function(e){var t=e.branchId,n=e.onSuccess,a=e.onClose,r=Object(Oe.useState)(""),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useState)(null),o=Object(Te.a)(l,2),d=o[0],u=o[1],b=Object(Oe.useRef)(),j=ot(),p=j.isFetching,h=j.data,O=dt({params:{branchId:t,search:i}}),m=O.isFetching,v=O.data.products,x=Object(xe.useMutation)((function(e){var t=e.fromBranchProductId,n=e.fromQuantity,a=e.toBranchProductId,r=e.toQuantity;return He.convert({body:{from_branch_product_id:t,from_quantity:n,to_branch_product_id:a,to_quantity:r}})})),f=x.mutateAsync,g=x.isLoading,y=x.error,S=Object(Oe.useCallback)((function(){return{defaultValues:{branchId:t,productId:null,fromBranchProductId:null,fromQuantity:null,toBranchProductId:null,toQuantity:null},schema:Pt.c().shape({branchId:Pt.b().required().label("Branch"),productId:Pt.b().nullable().required().label("Product"),fromBranchProductId:Pt.b().nullable().required().label("Product Unit"),fromQuantity:Pt.b().nullable().max((null===d||void 0===d?void 0:d.balance)||0).required().label("Quantity"),toBranchProductId:Pt.b().nullable().required().label("Product Unit"),toQuantity:Pt.b().nullable().min(1).required().label("Quantity")})}}),[t,null===d||void 0===d?void 0:d.balance]),C=Object(Nn.useDebouncedCallback)((function(e){s(e)}),P);return Object(Fe.jsxs)(pn.a,{footer:[Object(Fe.jsx)(Ee.a,{disabled:p||m,size:"large",onClick:a,children:"Cancel"},"btnCancel"),Object(Fe.jsx)(Ee.a,{disabled:p||m,loading:g,size:"large",type:"primary",onClick:function(){b.current.submitForm()},children:"Submit"},"btnSubmit")],title:"Convert Products",width:800,centered:!0,closable:!0,visible:!0,onCancel:a,children:[Object(Fe.jsx)(on,{className:"mb-3",errors:Xt(null===y||void 0===y?void 0:y.errors)}),Object(Fe.jsx)(qe.c,{initialValues:S().defaultValues,innerRef:b,validationSchema:S().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(t){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t);case 2:n();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t,n,a,r,c,i,s,l,o,d=e.values,b=e.setFieldValue;return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)(yn.a,{gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Branch"}),Object(Fe.jsx)(Cn.a,{className:"w-100",value:d.branchId,disabled:!0,children:null===h||void 0===h?void 0:h.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(Fe.jsx)(qe.a,{name:"branchId",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Product"}),Object(Fe.jsx)(Cn.a,{className:"w-100",defaultActiveFirstOption:!1,filterOption:!1,notFoundContent:m?Object(Fe.jsx)(Vt.a,{size:"small"}):null,value:d.productId,showSearch:!0,onChange:function(e){b("productId",e);var t=v.find((function(t){return t.id===e}));b("product",t),b("fromBranchProductId",null),b("fromQuantity",null),b("toBranchProductId",null),b("toQuantity",null)},onSearch:C,children:v.map((function(e){return Object(Fe.jsxs)(Cn.a.Option,{value:e.id,children:[Object(Fe.jsx)("span",{className:"mr-3",children:e.name}),Object(Fe.jsx)(Rt,{status:e.status})]},e.id)}))}),Object(Fe.jsx)(qe.a,{component:ln,name:"productId"}),(null===d||void 0===d||null===(t=d.product)||void 0===t?void 0:t.status)===F&&Object(Fe.jsx)(Tn.a,{className:"mt-2",message:"This product is out of stock.",type:"error",showIcon:!0})]})]}),Object(Fe.jsxs)(yn.a,{className:"mt-4",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{span:12,children:[Object(Fe.jsx)(_n.a,{children:"FROM"}),Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Product Unit"}),Object(Fe.jsx)(Cn.a,{className:"w-100",disabled:(null===d||void 0===d||null===(n=d.product)||void 0===n?void 0:n.status)===F,value:d.fromBranchProductId,onChange:function(e){var t;b("fromBranchProductId",e);var n=null===d||void 0===d||null===(t=d.product)||void 0===t?void 0:t.product_prices.find((function(t){return t.id===e}));u(n),b("fromQuantity",null),b("toBranchProductId",null),b("toQuantity",null)},children:null===d||void 0===d||null===(a=d.product)||void 0===a||null===(r=a.product_prices)||void 0===r?void 0:r.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.branch_product_id,children:e.unit_type.name},e.id)}))}),Object(Fe.jsx)(qe.a,{component:ln,name:"fromBranchProductId"})]}),Object(Fe.jsxs)("div",{className:"mt-4",children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Quantity"}),Object(Fe.jsx)(De.a,{disabled:(null===d||void 0===d||null===(c=d.product)||void 0===c?void 0:c.status)===F,type:"number",value:d.fromQuantity,onChange:function(e){b("fromQuantity",e.target.value)}}),Object(Fe.jsx)(qe.a,{component:ln,name:"fromQuantity"})]})]}),Object(Fe.jsxs)(Sn.a,{span:12,children:[Object(Fe.jsx)(_n.a,{children:"TO"}),Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Product Unit"}),Object(Fe.jsx)(Cn.a,{className:"w-100",disabled:(null===d||void 0===d||null===(i=d.product)||void 0===i?void 0:i.status)===F,value:d.toBranchProductId,onChange:function(e){b("toBranchProductId",e)},children:null===d||void 0===d||null===(s=d.product)||void 0===s||null===(l=s.product_prices)||void 0===l?void 0:l.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{disabled:d.fromBranchProductId===e.id,value:e.branch_product_id,children:e.unit_type.name},e.id)}))}),Object(Fe.jsx)(qe.a,{component:ln,name:"toBranchProductId"})]}),Object(Fe.jsxs)("div",{className:"mt-4",children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Quantity"}),Object(Fe.jsx)(De.a,{disabled:(null===d||void 0===d||null===(o=d.product)||void 0===o?void 0:o.status)===F,type:"number",value:d.toQuantity,onChange:function(e){b("toQuantity",e.target.value)}}),Object(Fe.jsx)(qe.a,{component:ln,name:"toQuantity"})]})]})]})]})}})]})},Dn=function(){var e=Object(Oe.useState)(null),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(xe.useQueryClient)(),c=Object(Se.c)(),i=Object(Te.a)(c,1)[0],s=bt().setSearchParams,l=ot(),o=l.isFetching,d=l.data,u=l.error,b=Ct(),j=b.isFetching,p=b.data,h=b.error;Object(Oe.useEffect)((function(){var e;!i.has("branchId")&&d.length>0&&s({branchId:null===d||void 0===d||null===(e=d[0])||void 0===e?void 0:e.id})}),[d,i]);return Object(Fe.jsx)(tn,{title:"Dashboard",children:Object(Fe.jsxs)(Be,{children:[Object(Fe.jsxs)(Vt.a,{spinning:o||j,children:[Object(Fe.jsx)(on,{className:"mb-3",errors:[].concat(Object(vn.a)(Xt(u,"Branches")),Object(vn.a)(Xt(h,"Unit Types")))}),Object(Fe.jsx)(gn.a,{activeKey:i.get("branchId"),tabBarExtraContent:(null===d||void 0===d?void 0:d.length)>0?Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){i.get("branchId")?a(Number(i.get("branchId"))):fn.b.error("Please select a branch first before converting product quantities.")},children:[Object(Fe.jsx)(xn.a,{})," Convert Stocks"]}):null,type:"card",onTabClick:function(e){s({branchId:e})},children:d.map((function(e){var t=e.name,n=e.id;return Object(Fe.jsx)(gn.a.TabPane,{tab:t,children:Object(Fe.jsx)(In,{unitTypes:p})},n)}))})]}),n&&Object(Fe.jsx)(An,{branchId:n,onClose:function(){a(null)},onSuccess:function(){a(null),r.invalidateQueries("useBranchProducts"),fn.b.success("Successfully converted products.")}})]})})},wn=[{title:"ID",dataIndex:"id"},{title:"Customer",dataIndex:"customer"},{title:"Date Created",dataIndex:"date_created"},{title:"Schedule of Delivery",dataIndex:"schedule_of_delivery"},{title:"Date Completed",dataIndex:"date_completed"},{title:"Payment",dataIndex:"payment",align:"center"},{title:"Status",dataIndex:"status",align:"center"},{title:"Actions",dataIndex:"actions"}],En=function(){var e=Object(Se.c)(),t=Object(Te.a)(e,1)[0],n=bt().setSearchParams;return Object(Fe.jsx)(yn.a,{gutter:[16,16],children:Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Payment Status"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",value:t.get("paymentStatus"),allowClear:!0,onChange:function(e){n({paymentStatus:e})},children:[Object(Fe.jsx)(Cn.a.Option,{value:Q,children:"Unpaid"}),Object(Fe.jsx)(Cn.a.Option,{value:Y,children:"Paid"})]})]})})},zn=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Se.c)(),c=Object(Te.a)(r,1)[0],i=Object(Ce.h)(),s=bt().setSearchParams,l=jt({params:{paymentStatus:c.get("paymentStatus"),page:c.get("page"),pageSize:c.get("pageSize")}}),o=l.isFetching,d=l.data,u=d.total,b=d.deliveries;return Object(Oe.useEffect)((function(){var e=b.map((function(e){var t;return{key:e.id,id:e.id,date_created:Wt(e.datetime_created),schedule_of_delivery:Wt(e.datetime_delivery),date_completed:Wt(e.datetime_completed),payment:Object(Fe.jsx)(nn,{status:null===e||void 0===e?void 0:e.payment_status}),customer:null===e||void 0===e||null===(t=e.customer)||void 0===t?void 0:t.name,status:Object(Fe.jsx)(Ft,{status:e.status}),actions:Object(Fe.jsx)(Ee.a,{type:"primary",ghost:!0,children:Object(Fe.jsx)(Se.b,{to:"/deliveries/".concat(e.id),children:"View"})})}}));a(e)}),[b]),Object(Fe.jsx)(tn,{className:"Deliveries",title:"Deliveries",children:Object(Fe.jsxs)(Be,{children:[Object(Fe.jsxs)(yn.a,{className:"mb-4",gutter:[16,16],justify:"space-between",children:[Object(Fe.jsx)(Sn.a,{md:6,sm:12,span:24,children:Object(Fe.jsx)(En,{})}),Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){i("create")},children:[Object(Fe.jsx)(un.a,{})," Create Delivery"]})})]}),Object(Fe.jsx)(jn.a,{columns:wn,dataSource:n,loading:o,pagination:{current:Number(c.get("page"))||1,total:u,pageSize:Number(c.get("pageSize"))||C,onChange:function(e,t){s({page:e,pageSize:t})},disabled:0===b.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})]})})},Ln=n(449),Rn=n(195),Fn=n(149),Bn=(n(435),"ALL"),qn="SELECTED",Vn=function(e,t){var n=t.priceMarket,a=t.priceDelivery,r=t.pricePickup,c=t.priceSpecial,i=0;return e===U?i=n:e===G?i=a:e===H?i=r:e===K&&(i=c),i},Mn=function(e){var t=e.branches,n=e.customers,a=e.values,r=e.onSetFieldValue,c=Object(Oe.useState)(!1),i=Object(Te.a)(c,2),s=i[0],l=i[1];return Object(Fe.jsx)(Be,{children:Object(Fe.jsxs)(yn.a,{gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Branch Source"}),Object(Fe.jsx)(Cn.a,{className:"w-100",value:a.branchId,onChange:function(e){r("branchId",e)},children:t.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(Fe.jsx)(Bt,{name:"branchId"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Delivery Type"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",value:a.deliveryType,onChange:function(e){r("deliveryType",e)},children:[Object(Fe.jsx)(Cn.a.Option,{value:G,children:"Delivery"},G),Object(Fe.jsx)(Cn.a.Option,{value:U,children:"Pickup"},U),Object(Fe.jsx)(Cn.a.Option,{value:H,children:"Market"},H),Object(Fe.jsx)(Cn.a.Option,{value:K,children:"Special"},K)]}),Object(Fe.jsx)(Bt,{name:"deliveryType"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Schedule of Delivery"}),Object(Fe.jsx)(Ln.a,{allowClear:!1,className:"w-100",format:"MMM DD, YYYY hh:mm A",showTime:{format:"hh:mm A"},onOk:function(e){r("datetimeDelivery",e)}}),Object(Fe.jsx)(Bt,{name:"datetimeDelivery"})]}),Object(Fe.jsx)(Sn.a,{span:24,children:Object(Fe.jsx)(_n.a,{children:"Customer"})}),Object(Fe.jsxs)(Sn.a,{md:12,xs:18,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Customer's Name"}),Object(Fe.jsx)(Cn.a,{className:"w-100",mode:"tags",value:null!==a.customerName?[a.customerName]:[],onDeselect:function(){r("customerName",null),r("customerAddress",null),r("customerLandline",null),r("customerPhone",null),r("customerDescription",null),r("customerIsBakery",!1)},onSelect:function(e){var t=e;r("customerName",t);var a=n.find((function(e){return e.name===t}));r("customerAddress",(null===a||void 0===a?void 0:a.address)||""),r("customerLandline",(null===a||void 0===a?void 0:a.landline)||""),r("customerPhone",(null===a||void 0===a?void 0:a.phone)||""),r("customerDescription",(null===a||void 0===a?void 0:a.description)||""),r("customerIsBakery",(null===a||void 0===a?void 0:a.is_bakery)||!1)},children:n.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.name,children:e.name},e.id)}))}),Object(Fe.jsx)(Bt,{name:"customerName"})]}),Object(Fe.jsxs)(Sn.a,{md:12,xs:6,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Is Customer a Bakery/Non-market?"}),Object(Fe.jsx)(Rn.a.Group,{className:"w-100",options:[{label:"Yes",value:!0},{label:"No",value:!1}],optionType:"button",value:a.customerIsBakery,onChange:function(e){r("customerIsBakery",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"customerIsBakery"})]}),Object(Fe.jsxs)(Sn.a,{md:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Customer's Phone Number"}),Object(Fe.jsx)(De.a,{value:a.customerPhone,onChange:function(e){r("customerPhone",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"customerPhone"})]}),Object(Fe.jsxs)(Sn.a,{md:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Customer's Telephone Number"}),Object(Fe.jsx)(De.a,{value:a.customerLandline,onChange:function(e){r("customerLandline",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"customerLandline"})]}),Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Customer's Address"}),Object(Fe.jsx)(De.a,{value:a.customerAddress,onChange:function(e){r("customerAddress",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"customerAddress"})]}),Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Customer's Description"}),s?Object(Fe.jsxs)(De.a.Group,{compact:!0,children:[Object(Fe.jsx)(De.a,{style:{width:"calc(100% - 70px)"},value:a.customerDescription,onChange:function(e){r("customerDescription",e.target.value)}}),Object(Fe.jsx)(Ee.a,{type:"primary",onClick:function(){l(!1)},children:"Save"})]}):Object(Fe.jsx)(Tn.a,{action:Object(Fe.jsx)(Ee.a,{size:"small",type:"link",onClick:function(){l(!0)},children:"Edit"}),description:a.customerDescription,type:"info",showIcon:!0}),Object(Fe.jsx)(Bt,{name:"customerDescription"})]})]})})},Yn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(Oe.useState)(1),r=Object(Te.a)(a,2),c=r[0],i=r[1],s=Object(Oe.useState)(C),l=Object(Te.a)(s,2),o=l[0],d=l[1],u=Object(Oe.useState)(""),b=Object(Te.a)(u,2),j=b[0],p=b[1],h=Object(Oe.useState)(""),O=Object(Te.a)(h,2),m=O[0],v=O[1],x=Object(Oe.useState)([]),f=Object(Te.a)(x,2),g=f[0],y=f[1],S=dt({params:{branchId:t.branchId,page:c,pageSize:o,search:j,status:m},options:{enabled:!!t.branchId}}),k=S.isFetching,I=S.data,T=I.total,_=I.products;Object(Oe.useEffect)((function(){y(_.map((function(e){var a=t.deliveryProducts.find((function(t){return t.productId===e.id}));return{key:e.id,name:Object(Fe.jsx)(Fn.a,{checked:a,disabled:e.status===F,onChange:function(a){var r=[];r=a.target.checked?[].concat(Object(vn.a)(t.deliveryProducts),[{productId:e.id,productName:e.name,productStatus:e.status,productPrices:e.product_prices.map((function(e){return{branchProductId:e.branch_product_id,unitTypeId:e.unit_type_id,priceMarket:e.price_market,priceDelivery:e.price_delivery,pricePickup:e.price_pickup,priceSpecial:e.price_special,balance:e.balance,quantity:0}}))}]):t.deliveryProducts.filter((function(t){return t.productId!==e.id})),n("deliveryProducts",r)},children:e.name}),status:Object(Fe.jsx)(Rt,{status:e.status})}})))}),[_,t]),Object(Oe.useEffect)((function(){y([]),n("deliveryProducts",[])}),[t.branchId]);var N=Object(Nn.useDebouncedCallback)((function(e){p(e)}),P);return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)(yn.a,{className:"mb-4",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Search"}),Object(Fe.jsx)(De.a,{allowClear:!0,onChange:function(e){return N(e.target.value.trim())}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Status"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",allowClear:!0,onChange:function(e){v(e)},children:[Object(Fe.jsx)(Cn.a.Option,{value:L,children:"Available"}),Object(Fe.jsx)(Cn.a.Option,{value:R,children:"Reorder"})]})]})]}),Object(Fe.jsx)(jn.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}],dataSource:g,loading:k,pagination:{current:c,total:T,pageSize:o,onChange:function(e,t){i(e),d(t)},disabled:k,position:["bottomCenter"],pageSizeOptions:["10","20","50"]}})]})},Qn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(Oe.useState)([]),r=Object(Te.a)(a,2),c=r[0],i=r[1],s=Object(Oe.useState)(0),l=Object(Te.a)(s,2),o=l[0],d=l[1],u=Ct(),b=u.isFetching,j=u.data;Object(Oe.useEffect)((function(){var e=0;i(t.deliveryProducts.map((function(a,r){var c={key:a.productId,name:Object(Fe.jsx)(Fn.a,{checked:!0,onChange:function(){n("deliveryProducts",t.deliveryProducts.filter((function(e){return e.productId!==a.productId})))},children:a.productName})},i=0;return a.productPrices.forEach((function(e,a){var s=e.quantity,l=Vn(t.deliveryType,{priceMarket:e.priceMarket,priceDelivery:e.priceDelivery,pricePickup:e.pricePickup,priceSpecial:e.priceSpecial});i+=l*s,c[String(e.unitTypeId)]=Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(De.a,{style:{textAlign:"center"},type:"number",onChange:function(e){n("deliveryProducts.".concat(r,".productPrices.").concat(a,".quantity"),Number(e.target.value))}}),Object(Fe.jsx)(Bt,{name:"deliveryProducts.".concat(r,".productPrices.").concat(a,".quantity")})]})})),c.subtotal=Kt(i),e+=i,c}))),d(e)}),[t,j]);var p=Object(Oe.useCallback)((function(){var e,n=Object(X.flatten)(null===t||void 0===t||null===(e=t.deliveryProducts)||void 0===e?void 0:e.map((function(e){return e.productPrices.map((function(e){return e.unitTypeId}))}))),a=j.filter((function(e){return n.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(vn.a)(a.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Subtotal",dataIndex:"subtotal"}])}),[t,j]);return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(jn.a,{columns:p(),dataSource:c,loading:b,pagination:!1,scroll:{x:800}}),Object(Fe.jsxs)(we.a.Title,{className:"CreateDelivery_grandTotal",level:3,children:["Grand Total: ",Kt(o)]})]})},Un=function(){var e,t=Object(Oe.useState)(!1),n=Object(Te.a)(t,2),a=n[0],r=n[1],c=Object(Ce.h)(),i=ot(),s=i.isFetching,l=i.data,o=ut({params:{type:_}}),d=o.isFetching,u=o.data,b={defaultValues:{branchId:null,deliveryType:null,datetimeDelivery:null,customerName:null,customerAddress:null,customerLandline:null,customerPhone:null,customerDescription:null,customerIsBakery:!1,deliveryProducts:[]},schema:Pt.c().shape({branchId:Pt.d().required().label("Branch").nullable(),deliveryType:Pt.d().required().label("Delivery Type").nullable(),datetimeDelivery:(e="Schedule Of Delivery",Pt.d().required().nullable().test("is-valid-date","".concat(e," is not a valid time"),(function(e){return Ut()(e).isValid()})).label(e)),customerName:Pt.d().required().label("Customer Name").nullable(),customerAddress:Pt.d().required().label("Customer Address").nullable(),customerLandline:Pt.d().label("Customer Telephone").nullable(),customerPhone:Pt.d().label("Customer Phone").nullable(),customerDescription:Pt.d().label("Customer Description").nullable(),deliveryProducts:Pt.a().of(Pt.c().shape({productId:Pt.b().required(),productName:Pt.d().required(),productStatus:Pt.d().required(),productPrices:Pt.a().of(Pt.c().shape({branchProductId:Pt.b().required().label("Product"),unitTypeId:Pt.b().required(),price:Pt.b(),quantity:Pt.b().required().min(0,"Must not be negative").label("Quantity")}))}))})},j=function(e){pn.a.success({title:"Success",content:"Delivery is successfully created.",keyboard:!1,okText:"View Delivery",onOk:function(){c("/deliveries/".concat(e))}})};return Object(Fe.jsx)(tn,{title:"Create Delivery",children:Object(Fe.jsx)(Vt.a,{spinning:s||d,children:Object(Fe.jsx)(qe.c,{initialValues:b.defaultValues,validationSchema:b.schema,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(t){var n,a,c,i;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(!0),!(t.deliveryProducts.length>0)){e.next=22;break}if(e.prev=2,n=u.find((function(e){return e.name===t.customerName})),!((a=Object(X.flatten)(t.deliveryProducts.map((function(e){return e.productPrices.filter((function(e){return e.quantity>0})).map((function(e){var n=Vn(t.deliveryType,{priceMarket:e.priceMarket,priceDelivery:e.priceDelivery,pricePickup:e.pricePickup,priceSpecial:e.priceSpecial});return{branch_product_id:e.branchProductId,quantity:e.quantity,price:n}}))})))).length>0)){e.next=13;break}return e.next=8,Xe.create({body:{branch_id:t.branchId,delivery_type:t.deliveryType,datetime_delivery:(s=Ut()(t.datetimeDelivery),Ut()(s).format("YYYY-MM-DD HH:mm:ss")),customer:{id:null===n||void 0===n?void 0:n.id,name:t.customerName,description:t.customerDescription,address:t.customerAddress,landline:t.customerLandline.length>0?t.customerLandline:void 0,phone:t.customerPhone.length>0?t.customerPhone:void 0,is_bakery:t.customerIsBakery},delivery_products:a}});case 8:c=e.sent,i=c.data,j(i.id),e.next=14;break;case 13:fn.b.error("Please add quantity to products first");case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0),fn.b.error(y);case 20:e.next=23;break;case 22:fn.b.error("Please add a product first");case 23:r(!1);case 24:case"end":return e.stop()}var s}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(Fe.jsx)(qe.b,{className:"w-100",children:Object(Fe.jsxs)(Vt.a,{spinning:a,children:[Object(Fe.jsx)(Mn,{branches:l,customers:u,values:t,onSetFieldValue:n}),null!==t.branchId&&Object(Fe.jsx)(Be,{children:Object(Fe.jsxs)(gn.a,{defaultActiveKey:Bn,size:"large",type:"card",children:[Object(Fe.jsx)(gn.a.TabPane,{tab:"All",children:Object(Fe.jsx)(Yn,{values:t,onSetFieldValue:n})},Bn),Object(Fe.jsx)(gn.a.TabPane,{tab:"Selected Products (".concat(t.deliveryProducts.length,")"),children:Object(Fe.jsx)(Qn,{values:t,onSetFieldValue:n})},qn)]})}),Object(Fe.jsx)(Be,{children:Object(Fe.jsx)(yn.a,{justify:"end",children:Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsx)(Ee.a,{htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})})]})})}})})})},Gn=n(114),Hn=n(456),Kn=n(193),Wn={defaultValues:{preparedBy:"",checkedBy:"",pulledOutBy:"",deliveredBy:"",paymentStatus:""},schema:Pt.c().shape({preparedBy:Pt.d().label("Prepared By"),checkedBy:Pt.d().label("Checked By"),pulledOutBy:Pt.d().label("Pulled Out By"),deliveredBy:Pt.d().label("Delivered By"),paymentStatus:Pt.d().label("Payment Status")})},Xn=function(){var e,t,n,a,r,c,i,s,l,o=Object(Oe.useState)([]),d=Object(Te.a)(o,2),u=d[0],b=d[1],j=Object(Oe.useState)(!1),p=Object(Te.a)(j,2),h=p[0],O=p[1],m=Object(Oe.useState)(""),v=Object(Te.a)(m,2),x=v[0],f=v[1],g=Object(Ce.i)(),C=Object(Ce.h)(),k=Ct(),I=k.isFetching,T=k.data,_=function(e){var t=e.id;return Object(xe.useQuery)(["useDeliveryRetrieve",t],(function(){return Xe.retrieve(t)}),{select:function(e){return e.data},enabled:void 0!==t})}({id:g.deliveryId}),N=_.isFetching,A=_.data,D=_.refetch,w=Object(xe.useMutation)((function(e){var t=e.checkedBy,n=e.deliveredBy,a=e.id,r=e.paymentStatus,c=e.preparedBy,i=e.pulledOutBy,s=e.status;return Xe.edit({id:a,body:{checked_by:t,delivered_by:n,payment_status:r,prepared_by:c,pulled_out_by:i,status:s}})})),E=w.mutateAsync,z=w.isLoading;Object(Oe.useEffect)((function(){var e={};null===A||void 0===A||A.delivery_products.forEach((function(t){var n=t.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)})),b(Object.keys(e).map((function(t){var n=e[t],a={key:t,name:t};return n.forEach((function(e){var t=String(e.unit_type.id);a[t]=Number(e.quantity)})),a})))}),[A]);var L=Object(Oe.useCallback)((function(){var e,t=(null===A||void 0===A||null===(e=A.delivery_products)||void 0===e?void 0:e.map((function(e){return e.unit_type.id})))||[],n=T.filter((function(e){return t.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(vn.a)(n.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))))}),[A,T]),R=function(){pn.a.confirm({icon:Object(Fe.jsx)(Gn.a,{}),autoFocusButton:"cancel",centered:!0,content:"Are you sure you want to cancel this delivery?",confirmLoading:z,okText:"Yes",onOk:function(){var e=Object(Ie.a)(ke.a.mark((function e(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({id:g.deliveryId,status:M});case 2:pn.a.destroyAll(),fn.b.success("Delivery is cancelled successfully"),C("/deliveries");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})};return Object(Fe.jsxs)(tn,{className:"ViewDelivery",title:"Delivery",children:[Object(Fe.jsxs)(Vt.a,{spinning:N||I||z,children:[Object(Fe.jsxs)(Be,{children:[(null===A||void 0===A?void 0:A.status)!==M&&Object(Fe.jsx)(yn.a,{className:"mb-4",children:Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{className:"mb-4",loading:h,size:"large",type:"primary",ghost:!0,onClick:function(){if(A){O(!0);var e=new Kn.a({orientation:"p",unit:"px",format:"legal",hotfixes:["px_scaling"]}),t=function(e){var t="#000",n="#3498DB",a="#6A0DAD",r="#E74C3C",c=e.delivery_products.length+1>21,i=0,s=[].concat(Object(vn.a)(e.delivery_products.map((function(e){var t=Number(e.quantity)*Number(e.price);return i+=t,"\n    <tr>\n      <td>".concat(e.quantity,"</td>\n      <td>").concat(Object(X.upperCase)(e.unit_type.name),"</td>\n      <td>").concat(Object(X.upperCase)(e.product.name),"</td>\n      <td>").concat(Kt(e.price,"P"),"</td>\n      <td>").concat(Kt(t,"P"),"</td>\n    </tr>\n    ")}))),["<tr>\n      <td></td>\n      <td></td>\n      <td><b>TOTAL: </b></td>\n      <td></td>\n      <td>".concat(Kt(i,"P"),"</td>\n    </tr>\n    ")]).join(""),l=function(t){var n=t.color;return'\n    <div style="min-height: '.concat(c?"1324px":"auto","; color: ").concat(n," !important; border-color: ").concat(n,'; font-size: 11px !important;">\n\n      <div class="header">\n        <div class="header-text font-weight-bold">DELIVERY RECEIPT - #').concat(e.id,'</div>\n        <div>\n          <strong>ORDERED BY:</strong>\n        </div>\n        <div>\n          <span class="text-center font-weight-bold">\n            ').concat(e.customer.name,'\n          </span>\n        </div>\n        <div>\n          <strong>DATE: </strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(Ut()(e.datetime_created).format("MMM DD, YYYY"),'\n          </span>\n        </div>\n        <div>\n          <strong>ADDRESS:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.customer.address,'\n          </span>\n        </div>\n        <div>\n          <strong>RECEIVED BY:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.user.first_name," ").concat(e.user.last_name,'\n          </span>\n        </div>\n        <div>\n          <strong>TIME:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(Ut()(e.datetime_created).format("hh:mm A"),'\n          </span>\n        </div>\n        <div>\n          <strong>CONTACT NO:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.customer.phone||""," ").concat(e.customer.landline||"",'\n          </span>\n        </div>\n      </div>\n\n      <div class="products">\n        <table>\n          <tr>\n            <th colspan="2">QUANTITY</th>\n            <th>ARTICLES</th>\n            <th>UNIT PRICE</th>\n            <th>AMOUNT</th>\n          </tr>\n          ').concat(s,'\n        </table>\n      </div>\n\n      <div class="footer">\n        <div>\n          <div>Receive the above goods in good order and conditions.</div>\n          <div class="signature"></div>\n          <div class="signature-label">Customer\'s Complete Name & Signature</div>\n        </div>\n\n        <div class="users">\n          <div>\n            <strong>PREPARED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>CHECKED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>PULLED-OUT BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>DELIVERED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n        </div>\n\n        <div class="disclaimer">\n          NOTE: This order slip at the same time serves as the temporary delivery\n          receipt. Our official invoice will be issued upon return of the receipt\n          and fully signed by the customer.\n        </div>\n      </div>\n\n      <div class="note">\n        <span>BLACK = CUSTOMER\'S COPY</span>\n        <span>').concat(e.customer.is_bakery?"BLUE":"RED"," = DELIVERY'S COPY</span>\n        <span>PURPLE = MARIGOLD'S COPY</span>\n      </div>\n    </div>\n  ")};return'\n  <html lang="en">\n    <head>\n      <style>\n        .header, .products, .footer, .note {\n          width: 795px;\n        }\n  \n        .header {\n          display: grid;\n          grid-template-columns: repeat(4, 1fr);\n          border-width: 1px;\n          border-style: solid;\n        }\n  \n        .header-text {\n          grid-column: 1 / span 4;\n          text-align: center;\n        }\n  \n        .header > div {\n          padding: 1px;\n          border-top-width: 1px;\n          border-top-style: solid;\n        }\n  \n        .products table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n  \n        .products table th,\n        .products table td {\n          border-width: 1px;\n          border-style: solid;\n          text-align: center;\n        }\n  \n        .footer {\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n        }\n  \n        .footer > div {\n          padding: 2.5px;\n          border-width: 1px;\n          border-style: solid;\n        }\n  \n        .footer .signature {\n          width: 80%;\n          margin: 15px auto 0;\n          border-bottom-width: 1px;\n          border-bottom-style: solid;\n        }\n  \n        .footer .signature-label {\n          text-align: center;\n        }\n  \n        .footer .users {\n          display: grid;\n          grid-template-columns: repeat(2, 1fr);\n        }\n  \n        .footer .users span {\n          width: 80%;\n          height: 100%;\n          margin: auto 0;\n          display: block;\n          border-bottom-width: 1px;\n          border-bottom-style: solid;\n        }\n  \n        .footer .disclaimer {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          text-align: center;\n          padding: 10px;\n          font-size: 10px;\n        }\n  \n        .note {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n  \n        .text-center {\n          text-align: center;\n        }\n  \n        .font-weight-bold {\n          font-weight: bold;\n        }\n      </style>\n    </head>\n  \n    <body>\n      '.concat(l({color:t}),"\n\n      ").concat(c?"":'<hr style="width: 795px; margin: 32px 0; border-style: dotted; border-width: 1px; border-color: #9A9A9A" />',"\n\n      ").concat(l({color:e.customer.is_bakery?n:r}),"\n      \n      ").concat(c?"":'<hr style="width: 795px; margin: 32px 0; border-style: dotted; border-width: 1px; border-color: #9A9A9A" />',"\n\n      ").concat(l({color:a}),"\n    </body>\n  </html>\n  ")}(A);f(t),setTimeout((function(){e.html(t,{margin:10,filename:"Delivery_".concat(A.id),callback:function(e){window.open(e.output("bloburl").toString()),O(!1),f("")}})}),P)}else fn.b.error(y)},children:"Print Delivery"})})}),Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"ID",span:2,children:null===A||void 0===A?void 0:A.id}),Object(Fe.jsx)(Hn.b.Item,{label:"Branch",children:null===A||void 0===A||null===(e=A.branch)||void 0===e?void 0:e.name}),Object(Fe.jsx)(Hn.b.Item,{label:"Delivery Type",children:Object(X.upperFirst)(null===A||void 0===A?void 0:A.delivery_type)}),Object(Fe.jsxs)(Hn.b.Item,{label:"Created By",children:[null===A||void 0===A||null===(t=A.user)||void 0===t?void 0:t.first_name," ",null===A||void 0===A||null===(n=A.user)||void 0===n?void 0:n.last_name]}),Object(Fe.jsx)(Hn.b.Item,{label:"Datetime Created",children:Wt(null===A||void 0===A?void 0:A.datetime_created)}),Object(Fe.jsx)(Hn.b.Item,{label:"Schedule of Delivery",children:Wt(null===A||void 0===A?void 0:A.datetime_delivery)}),Object(Fe.jsx)(Hn.b.Item,{label:"Status",children:Object(Fe.jsx)(an,{status:null===A||void 0===A?void 0:A.status})})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Customer",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"Name",children:null===A||void 0===A||null===(a=A.customer)||void 0===a?void 0:a.name}),Object(Fe.jsx)(Hn.b.Item,{label:"Is a Bakery Shop?",children:(null===A||void 0===A||null===(r=A.customer)||void 0===r?void 0:r.is_bakery)?"Yes":"No"}),Object(Fe.jsx)(Hn.b.Item,{label:"Phone",children:(null===A||void 0===A||null===(c=A.customer)||void 0===c?void 0:c.phone)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Telephone",children:(null===A||void 0===A||null===(i=A.customer)||void 0===i?void 0:i.landline)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Address",span:2,children:null===A||void 0===A||null===(s=A.customer)||void 0===s?void 0:s.address}),Object(Fe.jsx)(Hn.b.Item,{label:"Description",span:2,children:null===A||void 0===A||null===(l=A.customer)||void 0===l?void 0:l.description})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsx)(jn.a,{columns:L(),dataSource:u,pagination:!1,scroll:{x:800}})]}),(null===A||void 0===A?void 0:A.status)===V&&Object(Fe.jsx)(Be,{children:Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Delivery",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"Delivery Completed",span:2,children:Wt(null===A||void 0===A?void 0:A.datetime_completed)}),Object(Fe.jsx)(Hn.b.Item,{label:"Prepared By",children:(null===A||void 0===A?void 0:A.prepared_by)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Checked By",children:(null===A||void 0===A?void 0:A.checked_by)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Pulled Out By",children:(null===A||void 0===A?void 0:A.pulled_out_by)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Delivered By",children:(null===A||void 0===A?void 0:A.delivered_by)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Payment Status",children:Object(Fe.jsx)(nn,{status:null===A||void 0===A?void 0:A.payment_status})})]})}),(null===A||void 0===A?void 0:A.status)===q&&Object(Fe.jsx)(Be,{children:Object(Fe.jsx)(qe.c,{initialValues:Wn.defaultValues,validationSchema:Wn.schema,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(t){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E({id:g.deliveryId,status:V,paymentStatus:t.paymentStatus,preparedBy:t.preparedBy,checkedBy:t.checkedBy,pulledOutBy:t.pulledOutBy,deliveredBy:t.deliveredBy}),D();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(Fe.jsxs)(qe.b,{children:[Object(Fe.jsxs)(yn.a,{gutter:[24,24],children:[Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Prepared By"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("preparedBy",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"preparedBy"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Checked By"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("checkedBy",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"checkedBy"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Pulled Out"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("pulledOutBy",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"pulledOutBy"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Delivered By"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("deliveredBy",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"deliveredBy"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Payment Status"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",value:t.payment_status,allowClear:!0,onChange:function(e){n("paymentStatus",e)},children:[Object(Fe.jsx)(Cn.a.Option,{value:Q,children:"Unpaid"}),Object(Fe.jsx)(Cn.a.Option,{value:Y,children:"Paid"})]}),Object(Fe.jsx)(Bt,{name:"paymentStatus"})]})]}),Object(Fe.jsxs)(yn.a,{className:"mt-6",gutter:[16,16],children:[Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{size:"large",block:!0,danger:!0,onClick:R,children:"Cancel Delivery"})}),Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{htmlType:"submit",size:"large",type:"primary",block:!0,children:"Set As Delivered"})})]})]})}})})]}),Object(Fe.jsx)("div",{dangerouslySetInnerHTML:{__html:x}})]})},Zn=(n(436),[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}]),Jn=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Se.c)(),c=Object(Te.a)(r,1)[0],i=bt().setSearchParams,s=pt({params:{page:c.get("page"),pageSize:c.get("pageSize"),branchId:c.get("branchId")}}),l=s.isFetching,o=s.data,d=o.total,u=o.notifications;return Object(Oe.useEffect)((function(){var e=u.map((function(e){return{key:e.id,name:"".concat(e.product.name," (").concat(e.unit_type.name,")"),status:Object(Fe.jsx)(Rt,{status:e.status})}}));a(e)}),[u]),Object(Fe.jsx)(jn.a,{columns:Zn,dataSource:n,loading:l,pagination:{current:Number(c.get("page"))||1,total:d,pageSize:Number(c.get("pageSize"))||C,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===u.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})},$n=function(){var e=Object(Se.c)(),t=Object(Te.a)(e,1)[0],n=bt().setSearchParams,a=ot(),r=a.isFetching,c=a.data;Object(Oe.useEffect)((function(){var e;!t.has("branchId")&&c.length>0&&n({branchId:null===c||void 0===c||null===(e=c[0])||void 0===e?void 0:e.id})}),[c,t]);return Object(Fe.jsx)(tn,{title:"Notifications",children:Object(Fe.jsx)(Be,{children:Object(Fe.jsx)(Vt.a,{spinning:r,children:Object(Fe.jsx)(gn.a,{activeKey:t.get("branchId"),type:"card",onTabClick:function(e){n({branchId:e})},children:c.map((function(e){var t=e.name,n=e.id;return Object(Fe.jsx)(gn.a.TabPane,{tab:t,children:Object(Fe.jsx)(Jn,{})},n)}))})})})})},ea=(n(255),[{title:"ID",dataIndex:"id"},{title:"Supplier",dataIndex:"supplier"},{title:"Date Created",dataIndex:"dateCreated"},{title:"Date Fulfilled",dataIndex:"dateFulfilled"},{title:"Status",dataIndex:"status",align:"center"},{title:"Actions",dataIndex:"actions"}]),ta=function(){var e=Object(Se.c)(),t=Object(Te.a)(e,2),n=t[0],a=t[1],c=Object(Nn.useDebouncedCallback)((function(e){a(Object(r.a)(Object(r.a)({},Object.fromEntries(n)),{},{search:e}))}),P);return Object(Fe.jsxs)(yn.a,{className:"mb-4",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Search"}),Object(Fe.jsx)(De.a,{defaultValue:n.get("search"),allowClear:!0,onChange:function(e){return c(e.target.value.trim())}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Status"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",value:n.get("status"),allowClear:!0,onChange:function(e){a(Object(r.a)(Object(r.a)({},Object.fromEntries(n)),{},{status:e||""}))},children:[Object(Fe.jsx)(Cn.a.Option,{value:B.APPROVED,children:"Approved"}),Object(Fe.jsx)(Cn.a.Option,{value:B.PENDING,children:"Pending"}),Object(Fe.jsx)(Cn.a.Option,{value:B.DELIVERED,children:"Delivered"}),Object(Fe.jsx)(Cn.a.Option,{value:B.CANCELLED,children:"Cancelled"})]})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Date Created"}),Object(Fe.jsx)(Ln.a,{className:"w-100",defaultValue:n.get("dateCreated")?Ut()(n.get("dateCreated")):null,allowClear:!0,onChange:function(e,t){a(Object(r.a)(Object(r.a)({},Object.fromEntries(n)),{},{dateCreated:t}))}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Date Fulfilled"}),Object(Fe.jsx)(Ln.a,{className:"w-100",defaultValue:n.get("dateFulfilled")?Ut()(n.get("dateFulfilled")):null,allowClear:!0,onChange:function(e,t){a(Object(r.a)(Object(r.a)({},Object.fromEntries(n)),{},{dateFulfilled:t}))}})]})]})},na=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],c=Object(Ce.h)(),i=Object(Se.c)(),s=Object(Te.a)(i,2),l=s[0],o=s[1],d=vt({params:{dateCreated:l.get("dateCreated"),dateFulfilled:l.get("dateFulfilled"),page:l.get("page"),pageSize:l.get("pageSize"),search:l.get("search"),status:l.get("status")}}),u=d.isFetching,b=d.data,j=b.total,p=b.preorders;return Object(Oe.useEffect)((function(){var e=p.map((function(e){return{key:e.id,id:e.id,supplier:e.supplier.name,dateCreated:Wt(e.datetime_created),dateFulfilled:Wt(e.datetime_fulfilled),status:Object(Fe.jsx)(an,{status:e.status}),actions:Object(Fe.jsx)(Ee.a,{type:"primary",ghost:!0,children:Object(Fe.jsx)(Se.b,{to:"/preorders/".concat(e.id),children:"View"})})}}));a(e)}),[p]),Object(Fe.jsx)(tn,{className:"Preorders",title:"Preorders",children:Object(Fe.jsxs)(Be,{children:[Object(Fe.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){c("create")},children:[Object(Fe.jsx)(un.a,{})," Create Preorder"]})}),Object(Fe.jsx)(ta,{}),Object(Fe.jsx)(jn.a,{columns:ea,dataSource:n,loading:u,pagination:{current:Number(l.get("page"))||1,total:j,pageSize:Number(l.get("pageSize"))||C,onChange:function(e,t){o(Object(r.a)(Object(r.a)({},Object.fromEntries(l)),{},{page:e,pageSize:t}))},disabled:0===p.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})]})})},aa="ALL",ra="SELECTED",ca=function(e){var t,n,a,r,c,i,s,l,o=e.preorder,d=e.branches,u=e.suppliers,b=e.values,j=e.onSetFieldValue,p=Object(Oe.useState)(!1),h=Object(Te.a)(p,2),O=h[0],m=h[1];return Object(Fe.jsx)(Be,{children:o?Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"ID",span:2,children:null===o||void 0===o?void 0:o.id}),Object(Fe.jsx)(Hn.b.Item,{label:"Branch",children:null===o||void 0===o||null===(t=o.branch)||void 0===t?void 0:t.name}),Object(Fe.jsx)(Hn.b.Item,{label:"Delivery Type",children:Z.a.upperFirst(null===o||void 0===o?void 0:o.delivery_type)}),Object(Fe.jsxs)(Hn.b.Item,{label:"Created By",children:[null===o||void 0===o||null===(n=o.user)||void 0===n?void 0:n.first_name," ",null===o||void 0===o||null===(a=o.user)||void 0===a?void 0:a.last_name]}),Object(Fe.jsx)(Hn.b.Item,{label:"Datetime Created",children:Wt(null===o||void 0===o?void 0:o.datetime_created)}),Object(Fe.jsx)(Hn.b.Item,{label:"Datetime Fulfilled",children:Wt(null===o||void 0===o?void 0:o.datetime_fulfilled)}),Object(Fe.jsx)(Hn.b.Item,{label:"Status",children:Object(Fe.jsx)(an,{status:null===o||void 0===o?void 0:o.status})}),Object(Fe.jsx)(Hn.b.Item,{label:"Description",span:2,children:Object(Fe.jsx)(Tn.a,{description:o.description,type:"info",showIcon:!0})})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Supplier",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"Name",span:2,children:null===o||void 0===o||null===(r=o.supplier)||void 0===r?void 0:r.name}),Object(Fe.jsx)(Hn.b.Item,{label:"Phone",children:(null===o||void 0===o||null===(c=o.supplier)||void 0===c?void 0:c.phone)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Telephone",children:(null===o||void 0===o||null===(i=o.supplier)||void 0===i?void 0:i.landline)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Address",span:2,children:null===o||void 0===o||null===(s=o.supplier)||void 0===s?void 0:s.address}),Object(Fe.jsx)(Hn.b.Item,{label:"Description",span:2,children:null===o||void 0===o||null===(l=o.supplier)||void 0===l?void 0:l.description})]})]}):Object(Fe.jsxs)(yn.a,{gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Branch Destination"}),Object(Fe.jsx)(Cn.a,{className:"w-100",value:b.branchId,onChange:function(e){j("branchId",e)},children:d.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(Fe.jsx)(Bt,{name:"branchId"})]}),Object(Fe.jsxs)(Sn.a,{sm:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Delivery Type"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",value:b.deliveryType,onChange:function(e){j("deliveryType",e)},children:[Object(Fe.jsx)(Cn.a.Option,{value:G,children:"Delivery"},G),Object(Fe.jsx)(Cn.a.Option,{value:U,children:"Pickup"},U)]}),Object(Fe.jsx)(Bt,{name:"deliveryType"})]}),Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Description"}),Object(Fe.jsx)(De.a,{value:b.description,onChange:function(e){j("description",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"description"})]}),Object(Fe.jsx)(Sn.a,{span:24,children:Object(Fe.jsx)(_n.a,{children:"Supplier"})}),Object(Fe.jsxs)(Sn.a,{md:12,xs:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Supplier's Name"}),Object(Fe.jsx)(Cn.a,{className:"w-100",mode:"tags",value:null!==b.supplierName?[b.supplierName]:[],onDeselect:function(){j("supplierName",null),j("supplierAddress",null),j("supplierLandline",null),j("supplierPhone",null),j("supplierDescription",null)},onSelect:function(e){var t=e;j("supplierName",t);var n=u.find((function(e){return e.name===t}));j("supplierAddress",(null===n||void 0===n?void 0:n.address)||""),j("supplierLandline",(null===n||void 0===n?void 0:n.landline)||""),j("supplierPhone",(null===n||void 0===n?void 0:n.phone)||""),j("supplierDescription",(null===n||void 0===n?void 0:n.description)||"")},children:u.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.name,children:e.name},e.id)}))}),Object(Fe.jsx)(Bt,{name:"supplierName"})]}),Object(Fe.jsxs)(Sn.a,{md:6,sm:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Supplier's Phone Number"}),Object(Fe.jsx)(De.a,{value:b.supplierPhone,onChange:function(e){j("supplierPhone",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"supplierPhone"})]}),Object(Fe.jsxs)(Sn.a,{md:6,sm:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Supplier's Telephone Number"}),Object(Fe.jsx)(De.a,{value:b.supplierLandline,onChange:function(e){j("supplierLandline",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"supplierLandline"})]}),Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Supplier's Address"}),Object(Fe.jsx)(De.a,{value:b.supplierAddress,onChange:function(e){j("supplierAddress",e.target.value)}}),Object(Fe.jsx)(Bt,{name:"supplierAddress"})]}),Object(Fe.jsxs)(Sn.a,{span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Supplier's Description"}),O?Object(Fe.jsxs)(De.a.Group,{compact:!0,children:[Object(Fe.jsx)(De.a,{style:{width:"calc(100% - 70px)"},value:b.supplierDescription,onChange:function(e){j("supplierDescription",e.target.value)}}),Object(Fe.jsx)(Ee.a,{type:"primary",onClick:function(){m(!1)},children:"Save"})]}):Object(Fe.jsx)(Tn.a,{action:Object(Fe.jsx)(Ee.a,{size:"small",type:"link",onClick:function(){m(!0)},children:"Edit"}),description:b.supplierDescription,type:"info",showIcon:!0}),Object(Fe.jsx)(Bt,{name:"supplierDescription"})]})]})})},ia=function(e){var t=e.preorder,n=e.values,a=e.onSetFieldValue,r=Object(Oe.useState)(1),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useState)(C),o=Object(Te.a)(l,2),d=o[0],u=o[1],b=Object(Oe.useState)(""),j=Object(Te.a)(b,2),p=j[0],h=j[1],O=Object(Oe.useState)(""),m=Object(Te.a)(O,2),v=m[0],x=m[1],f=Object(Oe.useState)([]),g=Object(Te.a)(f,2),y=g[0],S=g[1],k=dt({params:{branchId:n.branchId,page:i,pageSize:d,search:p,status:v},options:{enabled:!!n.branchId}}),I=k.isFetching,T=k.data,_=T.total,N=T.products;Object(Oe.useEffect)((function(){var e=N.map((function(e){var t=n.preorderProducts.find((function(t){return t.productId===e.id}));return{key:e.id,name:Object(Fe.jsx)(Fn.a,{checked:t,onChange:function(t){var r=[];r=t.target.checked?[].concat(Object(vn.a)(n.preorderProducts),[{productId:e.id,productName:e.name,productStatus:e.status,productPrices:e.product_prices.map((function(e){return{branchProductId:e.branch_product_id,unitTypeId:e.unit_type_id,quantity:0}}))}]):n.preorderProducts.filter((function(t){return t.productId!==e.id})),a("preorderProducts",r)},children:e.name}),status:Object(Fe.jsx)(Rt,{status:e.status})}}));S(e)}),[N,n]),Object(Oe.useEffect)((function(){t||(S([]),a("preorderProducts",[]))}),[t,n.branchId]);var A=Object(Nn.useDebouncedCallback)((function(e){h(e)}),P);return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)(yn.a,{className:"mb-4",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Search"}),Object(Fe.jsx)(De.a,{allowClear:!0,onChange:function(e){return A(e.target.value.trim())}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Status"}),Object(Fe.jsxs)(Cn.a,{className:"w-100",allowClear:!0,onChange:function(e){x(e)},children:[Object(Fe.jsx)(Cn.a.Option,{value:L,children:"Available"}),Object(Fe.jsx)(Cn.a.Option,{value:R,children:"Reorder"}),Object(Fe.jsx)(Cn.a.Option,{value:F,children:"Out of Stock"})]})]})]}),Object(Fe.jsx)(jn.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}],dataSource:y,loading:I,pagination:{current:i,total:_,pageSize:d,onChange:function(e,t){s(e),u(t)},disabled:I,position:["bottomCenter"],pageSizeOptions:["10","20","50"]}})]})},sa=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(Oe.useState)([]),r=Object(Te.a)(a,2),c=r[0],i=r[1],s=Ct(),l=s.isFetching,o=s.data;Object(Oe.useEffect)((function(){i(t.preorderProducts.map((function(e,a){var r={key:e.productId,name:Object(Fe.jsx)(Fn.a,{checked:!0,onChange:function(){n("preorderProducts",t.preorderProducts.filter((function(t){return t.productId!==e.productId})))},children:e.productName}),remarks:Object(Fe.jsx)(De.a,{className:"text-center",value:e.remarks||"",onChange:function(e){n("preorderProducts.".concat(a,".remarks"),e.target.value)}}),status:Object(Fe.jsx)(Rt,{status:e.productStatus})};return e.productPrices.forEach((function(e,t){r[String(e.unitTypeId)]=Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(De.a,{className:"text-center",type:"number",value:e.quantity||"",onChange:function(e){n("preorderProducts.".concat(a,".productPrices.").concat(t,".quantity"),Number(e.target.value))}}),Object(Fe.jsx)(Bt,{name:"preorderProducts.".concat(a,".productPrices.").concat(t,".quantity")})]})})),r})))}),[t,o]);var d=Object(Oe.useCallback)((function(){var e,n=Object(X.flatten)(null===t||void 0===t||null===(e=t.preorderProducts)||void 0===e?void 0:e.map((function(e){return e.productPrices.map((function(e){return e.unitTypeId}))}))),a=o.filter((function(e){return n.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(vn.a)(a.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Remarks",dataIndex:"remarks"},{title:"Status",dataIndex:"status"}])}),[t,o]);return Object(Fe.jsx)(jn.a,{columns:d(),dataSource:c,loading:l,pagination:!1,scroll:{x:800}})},la=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],c=Object(Ce.i)(),i=Object(Ce.h)(),s=Ot({id:c.preorderId}),l=s.isFetching,o=s.data,d=ot(),u=d.isFetching,b=d.data,j=ut({params:{type:T}}),p=j.isFetching,h=j.data,O=ft({params:{ids:(null===o||void 0===o?void 0:o.preorder_products)?o.preorder_products.map((function(e){return e.product.id})).join(","):null},options:{enabled:!!o}}),m=O.isFetching,v=O.data.products,x=Object(xe.useMutation)((function(e){var t=e.branchId,n=e.deliveryType,a=e.description,r=e.supplier,c=e.preorderProducts;return et.create({body:{branch_id:t,delivery_type:n,description:a,supplier:r,preorder_products:c}})})),f=x.mutateAsync,g=x.isLoading,S=mt(),C=S.mutateAsync,P=S.isLoading;Object(Oe.useEffect)((function(){if(o&&0!==v.length){var e={};null===o||void 0===o||o.preorder_products.forEach((function(t){var n=t.branch_product.product_price.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)}));var t=Object.keys(e).map((function(t){var n=e[t][0],a=e[t].map((function(e){return{id:e.branch_product.product_price.id,branchProductId:e.branch_product.id,unitTypeId:e.unit_type_id,quantity:Number(e.quantity)}})),r=a.map((function(e){return e.id})),c=v.find((function(e){return e.id===n.product.id}));if(c){var i=((null===c||void 0===c?void 0:c.product_prices)||[]).filter((function(e){var t=e.id;return!r.includes(t)}));i.length>0&&(i=i.forEach((function(e){a.push({branchProductId:n.branch_product.id,unitTypeId:e.unit_type_id,quantity:0})})))}return{productId:n.product.id,productName:n.product.name,productStatus:null,productPrices:a,remarks:n.remarks||""}}));a(t)}}),[o,v]);var k=Object(Oe.useCallback)((function(){var e;return{defaultValues:{branchId:null===o||void 0===o||null===(e=o.branch)||void 0===e?void 0:e.id,deliveryType:null,description:null,supplierName:null,supplierAddress:null,supplierLandline:null,supplierPhone:null,supplierDescription:null,preorderProducts:n},schema:Pt.c().shape(Object(r.a)(Object(r.a)({branchId:Pt.d().required().label("Branch").nullable()},o?{}:{deliveryType:Pt.d().required().label("Delivery Type").nullable(),description:Pt.d().label("Description").nullable(),supplierName:Pt.d().required().label("Supplier Name").nullable(),supplierAddress:Pt.d().required().label("Supplier Address").nullable(),supplierLandline:Pt.d().label("Supplier Telephone").nullable(),supplierPhone:Pt.d().label("Supplier Phone").nullable(),supplierDescription:Pt.d().label("Supplier Description").nullable()}),{},{preorderProducts:Pt.a().of(Pt.c().shape({productId:Pt.b().required(),productName:Pt.d().required(),productStatus:Pt.d().nullable(),remarks:Pt.d().nullable(),productPrices:Pt.a().of(Pt.c().shape({branchProductId:Pt.b().required().label("Product"),unitTypeId:Pt.b().required(),quantity:Pt.b().required().min(0,"Must not be negative").label("Quantity"),remarks:Pt.d().label("Remarks")}))}))}))}}),[o,n]),I=function(e){pn.a.success({title:"Success",content:"Preorder is successfully created.",keyboard:!1,okText:"View Preorder",onOk:function(){i("/preorders/".concat(e))}})};return Object(Fe.jsx)(tn,{title:o?"Edit Preorder":"Create Preorder",children:Object(Fe.jsx)(Vt.a,{spinning:l||u||p||m,children:Object(Fe.jsx)(qe.c,{initialValues:k().defaultValues,validationSchema:k().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(t,n){var a,r,c,i,s,l,d,u;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.setFieldError,!(t.preorderProducts.length>0)){e.next=31;break}if(e.prev=2,r=h.find((function(e){return e.name===t.supplierName})),!((c=Object(X.flatten)(t.preorderProducts.map((function(e){return e.productPrices.filter((function(e){return e.quantity>0})).map((function(t){return{branch_product_id:t.branchProductId,quantity:t.quantity,remarks:e.remarks}}))})))).length>0)){e.next=23;break}if(i=null,!o){e.next=15;break}return e.next=10,C({id:o.id,preorderProducts:c});case 10:s=e.sent,l=s.data,i=l,e.next=20;break;case 15:return e.next=17,f({branchId:t.branchId,deliveryType:t.deliveryType,description:t.description,supplier:{id:null===r||void 0===r?void 0:r.id,name:t.supplierName,description:t.supplierDescription,address:t.supplierAddress,landline:t.supplierLandline,phone:t.supplierPhone},preorderProducts:c});case 17:d=e.sent,u=d.data,i=u;case 20:I(i.id),e.next=24;break;case 23:fn.b.error("Please add quantity to products first");case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(2),a("response",y);case 29:e.next=32;break;case 31:fn.b.error("Please add a product first");case 32:case"end":return e.stop()}}),e,null,[[2,26]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(Fe.jsx)(qe.b,{className:"w-100",children:Object(Fe.jsxs)(Vt.a,{spinning:g||P,children:[Object(Fe.jsx)(ca,{branches:b,preorder:o,suppliers:h,values:t,onSetFieldValue:n}),null!==t.branchId&&Object(Fe.jsx)(Be,{children:Object(Fe.jsxs)(gn.a,{defaultActiveKey:aa,size:"large",type:"card",children:[Object(Fe.jsx)(gn.a.TabPane,{tab:"All",children:Object(Fe.jsx)(ia,{preorder:o,values:t,onSetFieldValue:n})},aa),Object(Fe.jsx)(gn.a.TabPane,{tab:"Selected Products (".concat(t.preorderProducts.length,")"),children:Object(Fe.jsx)(sa,{values:t,onSetFieldValue:n})},ra)]})}),Object(Fe.jsx)(Be,{children:Object(Fe.jsx)(yn.a,{justify:"end",children:Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsx)(Ee.a,{htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})})]})})}})})})},oa=function(e){var t=e.preorder,n=e.preorderProducts,a=e.columns,r=e.onSuccess,c=e.onClose,i=Object(Oe.useState)(!1),s=Object(Te.a)(i,2),l=s[0],o=s[1],d=Object(Oe.useState)([]),u=Object(Te.a)(d,2),b=u[0],j=u[1],p=Object(Oe.useState)([]),h=Object(Te.a)(p,2),O=h[0],m=h[1],v=Object(Oe.useRef)();Object(Oe.useEffect)((function(){var e=[],t=0;j(Object.keys(n).map((function(a){var r={key:a,name:a};return n[a].forEach((function(n){var a=n.branch_product.product_price.unit_type,c="".concat(t,".quantity");r[String(a)]=Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(De.a,{style:{textAlign:"center"},type:"number",onChange:function(e){v.current.setFieldValue(c,Number(e.target.value))}}),Object(Fe.jsx)(Bt,{name:c})]}),e.push({preorderProductId:n.id,quantity:""}),t++})),r}))),m(e)}),[n]);var x=Object(Oe.useCallback)((function(){return{defaultValues:O,schema:Pt.a().of(Pt.c().shape({preorderProductId:Pt.b().required(),quantity:Pt.b().required("Required")}))}}),[O]);return Object(Fe.jsx)(pn.a,{footer:[Object(Fe.jsx)(Ee.a,{disabled:l,size:"large",onClick:c,children:"Cancel"},"btnCancel"),Object(Fe.jsx)(Ee.a,{loading:l,size:"large",type:"primary",onClick:function(){v.current.submitForm()},children:"Submit"},"btnSubmit")],title:"[Create] Preorder Transaction",width:800,centered:!0,closable:!0,visible:!0,onCancel:c,children:Object(Fe.jsx)(qe.c,{initialValues:x().defaultValues,innerRef:v,validationSchema:x().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(n){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,tt.create({body:{preorder_id:t.id,preorder_transaction_products:n.map((function(e){return{preorder_product_id:e.preorderProductId,quantity:e.quantity}}))}});case 4:r(),c(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),fn.b.error(y);case 11:return e.prev=11,o(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),children:Object(Fe.jsx)(qe.b,{children:Object(Fe.jsx)(jn.a,{columns:a,dataSource:b,loading:l,pagination:!1,scroll:{x:600}})})})})},da=function(e){var t=e.preorderTransaction,n=e.unitTypes,a=e.onClose,r=Object(Oe.useState)([]),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useState)([]),o=Object(Te.a)(l,2),d=o[0],u=o[1];Object(Oe.useEffect)((function(){var e={};t.preorder_transaction_products.forEach((function(t){var n=t.product_name;void 0===e[n]&&(e[n]=[]),e[n].push(t)}));var n=[];u(Object.keys(e).map((function(t){var a={key:t,name:t};return e[t].forEach((function(e){var t=e.unit_type_id;n.push(t),a[String(t)]=Number(e.quantity)})),a}))),s(n)}),[t]);var b=Object(Oe.useCallback)((function(){var e=n.filter((function(e){return i.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(vn.a)(e.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))))}),[i,n]);return Object(Fe.jsxs)(pn.a,{footer:[Object(Fe.jsx)(Ee.a,{size:"large",onClick:a,children:"Close"},"btnCancel")],title:"Preorder Transaction",width:800,centered:!0,closable:!0,visible:!0,onCancel:a,children:[Object(Fe.jsxs)(Hn.b,{column:1,labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"ID",children:t.id}),Object(Fe.jsxs)(Hn.b.Item,{label:"Received By",children:[t.user.first_name," ",t.user.last_name]}),Object(Fe.jsx)(Hn.b.Item,{label:"Date Created",children:Wt(t.datetime_created)})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsx)(jn.a,{columns:b(),dataSource:d,pagination:!1,scroll:{x:600}})]})},ua=[{title:"ID",dataIndex:"id"},{title:"Date Created",dataIndex:"datetime_created"},{title:"Received By",dataIndex:"received_by"},{title:"Action",dataIndex:"actions"}],ba=function(){var e,t,n,a,r,c,i,s,l,o=Object(Oe.useState)(!1),d=Object(Te.a)(o,2),u=d[0],b=d[1],j=Object(Oe.useState)(!1),p=Object(Te.a)(j,2),h=p[0],O=p[1],m=Object(Oe.useState)([]),v=Object(Te.a)(m,2),x=v[0],f=v[1],g=Object(Oe.useState)({}),C=Object(Te.a)(g,2),P=C[0],k=C[1],I=Object(Oe.useState)([]),T=Object(Te.a)(I,2),_=T[0],N=T[1],A=Object(Oe.useState)(!1),D=Object(Te.a)(A,2),w=D[0],E=D[1],z=Object(Oe.useState)([]),L=Object(Te.a)(z,2),R=L[0],F=L[1],q=Object(Oe.useState)(null),V=Object(Te.a)(q,2),M=V[0],Y=V[1],Q=Object(Oe.useState)(""),U=Object(Te.a)(Q,2),G=U[0],H=U[1],K=Object(Oe.useState)(!1),W=Object(Te.a)(K,2),Z=W[0],J=W[1],$=Object(Ce.i)(),ee=Ct(),te=ee.isFetching,ne=ee.data,ae=Ot({id:$.preorderId}),re=ae.isFetching,ce=ae.data,ie=ae.refetch,se=mt(),le=se.isLoading,oe=se.mutateAsync;Object(Oe.useEffect)((function(){var e={};null===ce||void 0===ce||ce.preorder_products.forEach((function(t){var n=t.branch_product.product_price.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)})),k(e);var t=[];f(Object.keys(e).map((function(n){var a,r={key:n,name:n,remarks:(null===(a=e[n][0])||void 0===a?void 0:a.remarks)||""};return e[n].forEach((function(e){var n=e.branch_product.product_price.unit_type;t.push(n),r[String(n)]="\n          ".concat(Number(e.fulfilled_quantity)," / ").concat(Number(e.quantity))})),r}))),N(t),H((null===ce||void 0===ce?void 0:ce.description)||"")}),[ce]),Object(Oe.useEffect)((function(){(null===ce||void 0===ce?void 0:ce.preorder_transactions)&&F(ce.preorder_transactions.map((function(e){return{row:e.id,id:e.id,datetime_created:Wt(e.datetime_created),received_by:"".concat(e.user.first_name," ").concat(e.user.last_name),actions:Object(Fe.jsx)(Ee.a,{type:"link",onClick:function(){Y(e)},children:"View"})}})))}),[ce]);var de=Object(Oe.useCallback)((function(){var e=ne.filter((function(e){return _.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(vn.a)(e.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Remarks",dataIndex:"remarks"}])}),[_,ne]),ue=function(e){b(!0),et.edit({id:$.preorderId,body:{status:e}}).then(ie).catch((function(e){console.error("Error: ",e),fn.b.error(y)})).finally((function(){b(!1)}))};return Object(Fe.jsx)(tn,{className:"ViewPreorder",title:"Preorder",children:Object(Fe.jsxs)(Vt.a,{spinning:re||te||u,children:[Object(Fe.jsxs)(Be,{children:[Object(Fe.jsxs)(yn.a,{className:"ViewPreorder_setPreorderAsComplete",gutter:[25,12],justify:"space-between",children:[Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{loading:h,size:"large",type:"primary",ghost:!0,onClick:function(){ce?(O(!0),new Kn.a("p","pt","a4").html(function(e,t){var n,a,r,c,i,s,l,o=e.preorder_products.map((function(e){var n=t.find((function(t){return t.id===e.unit_type_id})).name;return{name:"".concat(e.product.name," (").concat(n,")"),quantity:e.quantity}}));return'\n\t\t<div style="width: 430pt; font-family: \'Courier\', Geneva, Tahoma, sans-serif; font-size: 10pt; line-height: 125%">\n\t\t\t<div style="text-align: center;">\n\t\t\t\t\t<div style="font-size: 15pt;">Marigold Store</div>\n\t\t\t\t\t<div>[ORDER SLIP]</div>\n\t\t\t</div>\n\n\t\t\t<br />\n\n\t\t\t<table style="width: 100%;">\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Order ID:</td>\n\t\t\t\t\t<td>'.concat(e.id,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Created By:</td>\n\t\t\t\t\t<td>').concat(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.first_name," ").concat(null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.last_name,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Delivery Type:</td>\n\t\t\t\t\t<td>').concat(Object(X.upperFirst)(null===e||void 0===e?void 0:e.delivery_type),'</td>\n\t\t\t\t</tr>\n                <tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Datetime Created:</td>\n\t\t\t\t\t<td>').concat(Wt(null===e||void 0===e?void 0:e.datetime_created),'</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<br />\n\n      <table style="width: 100%;">\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Supplier Name:</td>\n\t\t\t\t\t<td>').concat(null===e||void 0===e||null===(r=e.supplier)||void 0===r?void 0:r.name,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Phone:</td>\n          <td>').concat((null===e||void 0===e||null===(c=e.supplier)||void 0===c?void 0:c.phone)||"",'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Telephone:</td>\n          <td>').concat((null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.landline)||"",'</td>\n\t\t\t\t</tr>\n        <tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Address:</td>\n          <td>').concat(null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.address,'</td>\n\t\t\t\t</tr>\n        <tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Description:</td>\n          <td>').concat(null===e||void 0===e||null===(l=e.supplier)||void 0===l?void 0:l.description,'</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<br />\n\n\t\t\t<table style="width: 100%;">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th style="text-align: left">Name</th>\n\t\t\t\t\t\t<th style="text-align: center">Quantity</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>  \n\t\t\t\t<tbody>\n\t\t\t\t\t').concat(o.map((function(e){return'\t\n                <tr>\n                    <td style="width: 200pt;">'.concat(e.name,'</td>\n                    <td style="text-align: center">').concat(e.quantity,"</td>\n                </tr>")})).join(""),"\n\t\t\t\t</tbody>\n\t\t\t</table>\t\t\t\n\t\t</div>\n\t")}(ce,ne),{x:10,y:10,filename:"Preorder_".concat(ce.id),callback:function(e){window.open(e.output("bloburl").toString()),O(!1)}})):fn.b.error(y)},children:"Print Preorder"})}),(null===ce||void 0===ce?void 0:ce.status)===B.APPROVED&&(null===ce||void 0===ce||null===(e=ce.preorder_transactions)||void 0===e?void 0:e.length)>0&&Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{className:"ViewPreorder_setPreorderAsComplete_button",size:"large",type:"primary",onClick:function(){ue(B.DELIVERED)},children:"Set Preorder As Complete"})})]}),Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"ID",span:2,children:null===ce||void 0===ce?void 0:ce.id}),Object(Fe.jsx)(Hn.b.Item,{label:"Branch",children:null===ce||void 0===ce||null===(t=ce.branch)||void 0===t?void 0:t.name}),Object(Fe.jsx)(Hn.b.Item,{label:"Delivery Type",children:Object(X.upperFirst)(null===ce||void 0===ce?void 0:ce.delivery_type)}),Object(Fe.jsxs)(Hn.b.Item,{label:"Created By",children:[null===ce||void 0===ce||null===(n=ce.user)||void 0===n?void 0:n.first_name," ",null===ce||void 0===ce||null===(a=ce.user)||void 0===a?void 0:a.last_name]}),Object(Fe.jsx)(Hn.b.Item,{label:"Datetime Created",children:Wt(null===ce||void 0===ce?void 0:ce.datetime_created)}),Object(Fe.jsx)(Hn.b.Item,{label:"Datetime Fulfilled",children:Wt(null===ce||void 0===ce?void 0:ce.datetime_fulfilled)}),Object(Fe.jsx)(Hn.b.Item,{label:"Status",children:Object(Fe.jsx)(an,{status:null===ce||void 0===ce?void 0:ce.status})}),Object(Fe.jsx)(Hn.b.Item,{label:"Description",span:2,children:Z?Object(Fe.jsxs)(De.a.Group,{compact:!0,children:[Object(Fe.jsx)(De.a,{style:{width:"calc(100% - 80px)"},value:G,onChange:function(e){H(e.target.value)}}),Object(Fe.jsx)(Ee.a,{loading:le,type:"primary",onClick:Object(Ie.a)(ke.a.mark((function e(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe({id:ce.id,description:G});case 2:J(!1);case 3:case"end":return e.stop()}}),e)}))),children:"Save"})]}):Object(Fe.jsx)(Tn.a,{action:Object(Fe.jsx)(Ee.a,{size:"small",type:"link",onClick:function(){J(!0)},children:"Edit"}),description:G,type:"info",showIcon:!0})})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsxs)(Hn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Supplier",bordered:!0,children:[Object(Fe.jsx)(Hn.b.Item,{label:"Name",span:2,children:null===ce||void 0===ce||null===(r=ce.supplier)||void 0===r?void 0:r.name}),Object(Fe.jsx)(Hn.b.Item,{label:"Phone",children:(null===ce||void 0===ce||null===(c=ce.supplier)||void 0===c?void 0:c.phone)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Telephone",children:(null===ce||void 0===ce||null===(i=ce.supplier)||void 0===i?void 0:i.landline)||S}),Object(Fe.jsx)(Hn.b.Item,{label:"Address",span:2,children:null===ce||void 0===ce||null===(s=ce.supplier)||void 0===s?void 0:s.address}),Object(Fe.jsx)(Hn.b.Item,{label:"Description",span:2,children:null===ce||void 0===ce||null===(l=ce.supplier)||void 0===l?void 0:l.description})]}),Object(Fe.jsx)(_n.a,{}),(null===ce||void 0===ce?void 0:ce.status)===B.PENDING&&Object(Fe.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(Fe.jsx)(Ee.a,{size:"large",type:"primary",ghost:!0,children:Object(Fe.jsx)(Se.b,{to:"/preorders/".concat(null===ce||void 0===ce?void 0:ce.id,"/edit"),children:"Edit Products"})})}),Object(Fe.jsx)(jn.a,{columns:de(),dataSource:x,pagination:!1,scroll:{x:800}}),(null===ce||void 0===ce?void 0:ce.status)===B.PENDING&&Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(_n.a,{}),Object(Fe.jsxs)(yn.a,{gutter:[25,12],children:[Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{size:"large",block:!0,danger:!0,onClick:function(){ue(B.CANCELLED)},children:"Cancel Preorder"})}),Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(Ee.a,{size:"large",type:"primary",block:!0,onClick:function(){ue(B.APPROVED)},children:"Approve Preorder"})})]})]})]}),[B.APPROVED,B.DELIVERED].includes(null===ce||void 0===ce?void 0:ce.status)&&Object(Fe.jsxs)(Be,{children:[Object(Fe.jsxs)(yn.a,{className:"mb-4",justify:"space-between",children:[Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsx)(we.a.Title,{level:4,children:"Transactions"})}),(null===ce||void 0===ce?void 0:ce.status)===B.APPROVED&&Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){E(!0)},children:[Object(Fe.jsx)(un.a,{})," Create Transaction"]})})]}),Object(Fe.jsx)(jn.a,{columns:ua,dataSource:R,pagination:!1,scroll:{x:800}})]}),w&&Object(Fe.jsx)(oa,{columns:de(),preorder:ce,preorderProducts:P,onClose:function(){E(!1)},onSuccess:function(){ie(),E(!1)}}),M&&Object(Fe.jsx)(da,{preorderTransaction:M,unitTypes:ne,onClose:function(){Y(null)}})]})})},ja=(n(256),n(455)),pa=function(e){var t,n=e.product,a=e.unitTypes,r=e.onClose;return Object(Fe.jsxs)(pn.a,{className:"ViewProductModal Modal__large Modal__hasFooter",footer:[Object(Fe.jsx)(Ee.a,{onClick:r,children:"Close"})],title:"View Product",centered:!0,closable:!0,visible:!0,onCancel:r,children:[Object(Fe.jsxs)(yn.a,{gutter:[8,8],children:[Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Name: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:n.name}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Unit Cost: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:Kt(n.unit_cost)}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Vat Type: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(X.upperCase)(n.vat_type)})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsx)(ja.a,{children:null===n||void 0===n||null===(t=n.product_prices)||void 0===t?void 0:t.map((function(e){var t=a.find((function(t){return t.id===e.unit_type_id})).name||"";return Object(Fe.jsx)(ja.a.Panel,{header:t,children:Object(Fe.jsxs)(yn.a,{gutter:[8,8],children:[Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price Market: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:Kt(e.price_market)}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price Delivery: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:Kt(e.price_delivery)}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price Pickup: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:Kt(e.price_pickup)}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price Special: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:Kt(e.price_special)}),Object(Fe.jsx)(Sn.a,{lg:12,children:Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Reorder Point: "})}),Object(Fe.jsx)(Sn.a,{lg:12,children:e.reorder_point})]})},String(e.id))}))})]})},ha=function(e){var t=e.onSetPriceType,n=Object(Se.c)(),a=Object(Te.a)(n,1)[0],r=bt().setSearchParams,c=Object(Pn.a)((function(e){r({search:e})}),P);return Object(Fe.jsxs)(yn.a,{className:"mb-4",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Search"}),Object(Fe.jsx)(De.a,{defaultValue:a.get("search"),allowClear:!0,onChange:function(e){return c(e.target.value.trim())}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price Type"}),Object(Fe.jsx)(Rn.a.Group,{className:"w-100",defaultValue:D,options:[{label:"Delivery",value:D},{label:"Market",value:w},{label:"Pickup",value:E},{label:"Special",value:z}],optionType:"button",onChange:function(e){t(e.target.value)}})]})]})},Oa=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Oe.useState)(D),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useState)(null),o=Object(Te.a)(l,2),d=o[0],u=o[1],b=Object(Oe.useState)(!1),j=Object(Te.a)(b,2),p=j[0],h=j[1],O=Object(Se.c)(),m=Object(Te.a)(O,1)[0],v=Object(Ce.h)(),x=bt().setSearchParams,f=Ct(),g=f.isFetching,S=f.data,P=ft({params:{page:m.get("page"),pageSize:m.get("pageSize"),search:m.get("search")}}),k=P.isFetching,I=P.data,T=I.total,_=I.products,N=P.refetch;Object(Oe.useEffect)((function(){var e=_.map((function(e){var t={key:e.id,name:Object(Fe.jsx)(Ee.a,{className:"pa-0",type:"link",onClick:function(){u(e)},children:e.name}),unitCost:Kt(e.unit_cost),actions:Object(Fe.jsxs)(Ae.b,{size:"small",children:[Object(Fe.jsx)(Ee.a,{type:"primary",ghost:!0,onClick:function(){v("/products/".concat(e.id))},children:"Edit"}),Object(Fe.jsx)(bn.a,{cancelText:"Cancel",okButtonProps:{danger:!0},okText:"Delete",placement:"topLeft",title:"Are you sure you want to delete ".concat(e.name,"?"),onConfirm:function(){var t;t=e.id,h(!0),at.delete(t).then((function(){N()})).catch((function(){fn.b.error(y)})).finally((function(){h(!1)}))},children:Object(Fe.jsx)(Ee.a,{type:"primary",danger:!0,ghost:!0,children:"Delete"})})]})};return e.product_prices.forEach((function(e){t[String(e.unit_type_id)]=Kt(e["price_".concat(i)])})),t}));a(e)}),[_,i]);var A=Object(Oe.useCallback)((function(){var e=Object(X.flatten)(null===_||void 0===_?void 0:_.map((function(e){return e.product_prices.map((function(e){return e.unit_type_id}))}))),t=S.filter((function(t){return e.includes(t.id)}));return[{title:"Name",dataIndex:"name",width:250,fixed:"left"},{title:"Unit Cost",dataIndex:"unitCost"}].concat(Object(vn.a)(t.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))),[{title:"Actions",dataIndex:"actions"}])}),[_,S]);return Object(Fe.jsxs)(tn,{className:"Products",title:"Products",children:[Object(Fe.jsxs)(Be,{children:[Object(Fe.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){v("create")},children:[Object(Fe.jsx)(un.a,{})," Create Product"]})}),Object(Fe.jsx)(ha,{onSetPriceType:s}),Object(Fe.jsx)(jn.a,{columns:A(),dataSource:n,loading:k||g||p,pagination:{current:Number(m.get("page"))||1,total:T,pageSize:Number(m.get("pageSize"))||C,onChange:function(e,t){x({page:e,pageSize:t})},disabled:0===_.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:1500}})]}),d&&Object(Fe.jsx)(pa,{product:d,unitTypes:S,onClose:function(){u(null)}})]})},ma=n(73),va=function(e){var t=e.index,n=e.isCreate,a=e.unitTypes,r=e.values,c=e.onRemoveProductPrice,i=e.onSetFieldValue;return Object(Fe.jsxs)(yn.a,{gutter:[4,4],children:[Object(Fe.jsxs)(Sn.a,{sm:6,xs:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price (Market)"}),Object(Fe.jsx)(De.a,{prefix:"\u20b1",type:"number",value:r.priceMarket,onChange:function(e){i("productPrices.".concat(t,".priceMarket"),e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"productPrices.".concat(t,".priceMarket"),render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{sm:6,xs:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price (Delivery)"}),Object(Fe.jsx)(De.a,{prefix:"\u20b1",type:"number",value:r.priceDelivery,onChange:function(e){i("productPrices.".concat(t,".priceDelivery"),e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"productPrices.".concat(t,".priceDelivery"),render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{sm:6,xs:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price (Pickup)"}),Object(Fe.jsx)(De.a,{prefix:"\u20b1",type:"number",value:r.pricePickup,onChange:function(e){i("productPrices.".concat(t,".pricePickup"),e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"productPrices.".concat(t,".pricePickup"),render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{sm:6,xs:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Price (Special)"}),Object(Fe.jsx)(De.a,{prefix:"\u20b1",type:"number",value:r.priceSpecial,onChange:function(e){i("productPrices.".concat(t,".priceSpecial"),e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"productPrices.".concat(t,".priceSpecial"),render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{sm:6,xs:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Reorder Point"}),Object(Fe.jsx)(De.a,{type:"number",value:r.reorderPoint,onChange:function(e){i("productPrices.".concat(t,".reorderPoint"),e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"productPrices.".concat(t,".reorderPoint"),render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{sm:6,xs:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Unit Type"}),Object(Fe.jsx)(Cn.a,{className:"w-100",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},optionFilterProp:"children",value:r.unitType,showSearch:!0,onChange:function(e){i("productPrices.".concat(t,".unitType"),e)},children:a.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(Fe.jsx)(qe.a,{name:"productPrices.".concat(t,".unitType"),render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),n&&Object(Fe.jsx)(Sn.a,{sm:12,xs:24,children:Object(Fe.jsx)(yn.a,{align:"middle",justify:"center",style:{height:"100%"},children:Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsxs)(Ee.a,{htmlType:"button",type:"dashed",danger:!0,onClick:c,children:[Object(Fe.jsx)(ma.a,{})," DELETE PRICE"]})})})})]})},xa=function(){var e=Object(Oe.useState)(!1),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Ce.i)(),c=Object(Ce.h)(),i=Ct(),s=i.isFetching,l=i.data,o=xt({id:r.productId}),d=o.isFetching,u=o.data,b=void 0===r.productId,j=Object(Oe.useCallback)((function(){return{defaultValues:{id:null===u||void 0===u?void 0:u.id,name:(null===u||void 0===u?void 0:u.name)||"",unitCost:(null===u||void 0===u?void 0:u.unit_cost)||"",vatType:(null===u||void 0===u?void 0:u.vat_type)||"",productPrices:(null===u||void 0===u?void 0:u.product_prices.map((function(e){return{id:e.id,priceMarket:Number(e.price_market),priceDelivery:Number(e.price_delivery),pricePickup:Number(e.price_pickup),priceSpecial:Number(e.price_special),reorderPoint:Number(e.reorder_point),unitType:e.unit_type_id}})))||[]},schema:Pt.c().shape({name:Pt.d().required().label("Name"),unitCost:Pt.d().required().label("Unit Cost"),vatType:Pt.d().required().label("VAT"),productPrices:Pt.a().of(Pt.c().shape({priceMarket:Pt.b().positive("Must be greater than zero").required("Required"),priceDelivery:Pt.b().positive("Must be greater than zero").required("Required"),pricePickup:Pt.b().positive("Must be greater than zero").required("Required"),priceSpecial:Pt.b().positive("Must be greater than zero").required("Required"),reorderPoint:Pt.b(),unitType:Pt.d().required("Required")}))})}}),[u]),p=function(e){var t=b?"created":"updated";pn.a.success({title:"Success",content:"".concat(e.name," is successfully ").concat(t,". Press the button below to go back to the products screen."),keyboard:!1,okText:"Proceed",onOk:function(){c("/products")}})};return Object(Fe.jsx)(tn,{title:"Products",children:Object(Fe.jsx)(Vt.a,{spinning:s||d||n,children:Object(Fe.jsx)(Be,{children:Object(Fe.jsx)(qe.c,{initialValues:j().defaultValues,validationSchema:j().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(t,n){var r,c,i,s;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.setFieldError,a(!0),!(t.productPrices.length>0)){e.next=18;break}return e.prev=3,c=b?at.create:at.edit,e.next=7,c({id:t.id,body:{name:t.name,unit_cost:t.unitCost,vat_type:t.vatType,product_prices:t.productPrices.map((function(e){return{id:e.id,unit_type_id:e.unitType,price_market:e.priceMarket,price_delivery:e.priceDelivery,price_pickup:e.pricePickup,price_special:e.priceSpecial,reorder_point:e.reorderPoint||0}}))}});case 7:i=e.sent,s=i.data,p(s),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0),r("response",y);case 16:e.next=19;break;case 18:fn.b.error("Please add a product price first");case 19:a(!1);case 20:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(Fe.jsxs)(qe.b,{className:"w-100",children:[Object(Fe.jsx)(qe.a,{name:"response",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}}),Object(Fe.jsxs)(yn.a,{gutter:[24,24],children:[Object(Fe.jsxs)(Sn.a,{lg:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Name"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"name",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Unit Cost"}),Object(Fe.jsx)(De.a,{prefix:"\u20b1",type:"number",value:t.unitCost,onChange:function(e){n("unitCost",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"unitCost",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]}),Object(Fe.jsxs)(Sn.a,{lg:12,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"VAT"}),Object(Fe.jsx)(Rn.a.Group,{buttonStyle:"solid",className:"w-100",options:[{label:"VAT",value:N},{label:"VAT-Exempted",value:A}],optionType:"button",value:t.vatType,onChange:function(e){n("vatType",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"vatType",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]})]}),Object(Fe.jsx)(_n.a,{children:"PRICES"}),Object(Fe.jsxs)(yn.a,{gutter:[16,32],children:[t.productPrices.map((function(e,a){return Object(Fe.jsx)(Sn.a,{span:24,children:Object(Fe.jsx)(va,{index:a,isCreate:b,unitTypes:l,values:e,onRemoveProductPrice:function(){n("productPrices",function(e,t){return t.productPrices.filter((function(t,n){return n!==e}))}(a,t))},onSetFieldValue:n})},a)})),Object(Fe.jsx)(Sn.a,{span:24,children:Object(Fe.jsxs)(Ee.a,{className:"ModifyProduct_btnAddPrice",htmlType:"button",size:"large",type:"primary",ghost:!0,onClick:function(){n("productPrices",function(e){return[].concat(Object(vn.a)(e.productPrices),[{priceMarket:"",priceDelivery:"",pricePickup:"",priceSpecial:"",reorderPoint:"",unitType:""}])}(t))},children:[Object(Fe.jsx)(un.a,{})," Add Price"]})})]}),Object(Fe.jsx)(_n.a,{}),Object(Fe.jsx)(yn.a,{justify:"end",children:Object(Fe.jsx)(Sn.a,{children:Object(Fe.jsx)(Ee.a,{className:"ModifyProduct_btnSubmit",htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})]})}})})})})},fa=[{title:"Rank",dataIndex:"rank"},{title:"Name",dataIndex:"name"},{title:"Total Purchase",dataIndex:"total_purchase"}],ga=function(){var e,t,n,a=Object(Oe.useState)(W.DAILY),r=Object(Te.a)(a,2),c=r[0],i=r[1],s=Object(Se.c)(),l=Object(Te.a)(s,1)[0],o=bt().setSearchParams,d=(null===(e=l.get("dateRange"))||void 0===e?void 0:e.toString())||W.DAILY;return Object(Oe.useEffect)((function(){![W.DAILY,W.MONTHLY].includes(d)&&(null===d||void 0===d?void 0:d.indexOf(","))?i(W.DATE_RANGE):i(d)}),[d]),Object(Fe.jsx)(yn.a,{className:"Products_filter",gutter:[16,16],children:Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{style:{width:"100%",display:"block"},strong:!0,children:"Date Range"}),Object(Fe.jsx)(Rn.a.Group,{options:[{label:"Daily",value:W.DAILY},{label:"Monthly",value:W.MONTHLY},{label:"Select Date Range",value:W.DATE_RANGE}],optionType:"button",value:c,onChange:function(e){var t=e.target.value;i(t),t!==W.DATE_RANGE&&o({dateRange:t})}}),c===W.DATE_RANGE&&Object(Fe.jsx)(Ln.a.RangePicker,{defaultPickerValue:2===(null===(t=d.split(","))||void 0===t?void 0:t.length)?[Ut()(d.split(",")[0]),Ut()(d.split(",")[1])]:void 0,defaultValue:2===(null===(n=d.split(","))||void 0===n?void 0:n.length)?[Ut()(d.split(",")[0]),Ut()(d.split(",")[1])]:void 0,format:"MM/DD/YY",onCalendarChange:function(e,t){(null===e||void 0===e?void 0:e[0])&&(null===e||void 0===e?void 0:e[1])&&o({dateRange:t.join(",")})}})]})})},ya=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Se.c)(),c=Object(Te.a)(r,1)[0],i=bt().setSearchParams,s=gt({params:{page:c.get("page"),pageSize:c.get("pageSize"),dateRange:c.get("dateRange")||W.DAILY}}),l=s.isFetching,o=s.data,d=o.total,u=o.customers;return Object(Oe.useEffect)((function(){var e=c.get("page")||1,t=c.get("pageSize")||C,n=(Number(e)-1)*Number(t),r=u.map((function(e,t){var a=n+t+1;return{key:e.id,rank:Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(cn,{rank:a})," ",Object(Fe.jsx)("span",{children:a})]}),name:e.name,total_purchase:Kt(e.total_purchase)}}));a(r)}),[u]),Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(ga,{}),Object(Fe.jsx)(jn.a,{columns:fa,dataSource:n,loading:l,pagination:{current:Number(c.get("page"))||1,total:d,pageSize:Number(c.get("pageSize"))||C,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===u.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})]})},Sa=function(e){var t,n,a,r=e.branches,c=Object(Oe.useState)(W.DAILY),i=Object(Te.a)(c,2),s=i[0],l=i[1],o=Object(Se.c)(),d=Object(Te.a)(o,1)[0],u=bt().setSearchParams,b=(null===(t=d.get("dateRange"))||void 0===t?void 0:t.toString())||W.DAILY;return Object(Oe.useEffect)((function(){![W.DAILY,W.MONTHLY].includes(b)&&(null===b||void 0===b?void 0:b.indexOf(","))?l(W.DATE_RANGE):l(b)}),[b]),Object(Fe.jsxs)(yn.a,{className:"Products_filter",gutter:[16,16],children:[Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Branch"}),Object(Fe.jsx)(Cn.a,{className:"w-100",value:Number(d.get("branchId"))||void 0,allowClear:!0,onChange:function(e){u({branchId:e})},children:r.map((function(e){return Object(Fe.jsx)(Cn.a.Option,{value:e.id,children:e.name},e.id)}))})]}),Object(Fe.jsxs)(Sn.a,{lg:12,span:24,children:[Object(Fe.jsx)(we.a.Text,{style:{width:"100%",display:"block"},strong:!0,children:"Date Range"}),Object(Fe.jsx)(Rn.a.Group,{options:[{label:"Daily",value:W.DAILY},{label:"Monthly",value:W.MONTHLY},{label:"Select Date Range",value:W.DATE_RANGE}],optionType:"button",value:s,onChange:function(e){var t=e.target.value;l(t),t!==W.DATE_RANGE&&u({dateRange:t})}}),s===W.DATE_RANGE&&Object(Fe.jsx)(Ln.a.RangePicker,{defaultPickerValue:2===(null===(n=b.split(","))||void 0===n?void 0:n.length)?[Ut()(b.split(",")[0]),Ut()(b.split(",")[1])]:void 0,defaultValue:2===(null===(a=b.split(","))||void 0===a?void 0:a.length)?[Ut()(b.split(",")[0]),Ut()(b.split(",")[1])]:void 0,format:"MM/DD/YY",onCalendarChange:function(e,t){(null===e||void 0===e?void 0:e[0])&&(null===e||void 0===e?void 0:e[1])&&u({dateRange:t.join(",")})}})]})]})},Ca=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Se.c)(),c=Object(Te.a)(r,1)[0],i=bt().setSearchParams,s=ot(),l=s.isFetching,o=s.data,d=yt({params:{page:c.get("page"),pageSize:c.get("pageSize"),branchId:c.get("branchId"),dateRange:c.get("dateRange")||W.DAILY}}),u=d.isFetching,b=d.data,j=b.total,p=b.products;Object(Oe.useEffect)((function(){var e=c.get("page")||1,t=c.get("pageSize")||C,n=(Number(e)-1)*Number(t),r=p.map((function(e,t){var a=n+t+1,r={key:e.id,rank:Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(cn,{rank:a})," ",Object(Fe.jsx)("span",{children:a})]}),name:e.name,total_sales:Kt(e.total_sales)};return e.product_prices.forEach((function(e){r[String(e.unit_type.id)]="".concat(Kt(e.total_sales)," - (").concat(e.total_quantity,")")})),r}));a(r)}),[p]);var h=Object(Oe.useCallback)((function(){var e={};Object(X.flatten)(null===p||void 0===p?void 0:p.map((function(e){return e.product_prices.map((function(e){return e.unit_type}))}))).forEach((function(t){e[t.name]=t}));var t=Object.keys(e).sort().map((function(t){return{title:e[t].name,dataIndex:String(e[t].id)}}));return[{title:"Rank",dataIndex:"rank"},{title:"Name",dataIndex:"name"},{title:"Total Sales",dataIndex:"total_sales"}].concat(Object(vn.a)(t))}),[p]);return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(Sa,{branches:o}),Object(Fe.jsx)(jn.a,{columns:h(),dataSource:n,loading:u||l,pagination:{current:Number(c.get("page"))||1,total:j,pageSize:Number(c.get("pageSize"))||C,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===p.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:1250}})]})},Pa=function(){var e=bt().setSearchParams;return Object(Fe.jsx)(tn,{title:"Reports",children:Object(Fe.jsx)(Be,{children:Object(Fe.jsxs)(gn.a,{type:"card",destroyInactiveTabPane:!0,onTabClick:function(){e({},{shouldResetPage:!0})},children:[Object(Fe.jsx)(gn.a.TabPane,{tab:"Customers",children:Object(Fe.jsx)(ya,{})},"customers"),Object(Fe.jsx)(gn.a.TabPane,{tab:"Products",children:Object(Fe.jsx)(Ca,{})},"products")]})})})},ka=function(e){var t=e.unitType,n=e.onClose,a=function(){var e=Object(xe.useQueryClient)();return Object(xe.useMutation)((function(e){var t=e.name;return lt.create({name:t})}),{onSuccess:function(){e.invalidateQueries("useUnitTypes")}})}(),r=a.mutateAsync,c=a.isLoading,i=a.error,s=function(){var e=Object(xe.useQueryClient)();return Object(xe.useMutation)((function(e){var t=e.id,n=e.name;return lt.edit(t,{name:n})}),{onSuccess:function(){e.invalidateQueries("useUnitTypes")}})}(),l=s.mutateAsync,o=s.isLoading,d=s.error,u=Object(Oe.useRef)(),b=Object(Oe.useCallback)((function(){return{defaultValues:{id:null===t||void 0===t?void 0:t.id,name:(null===t||void 0===t?void 0:t.name)||""},schema:Pt.c().shape({name:Pt.d().required().label("Name")})}}),[t]);return Object(Fe.jsxs)(pn.a,{footer:[Object(Fe.jsx)(Ee.a,{disabled:c||o,size:"large",onClick:n,children:"Cancel"}),Object(Fe.jsx)(Ee.a,{loading:c||o,size:"large",type:"primary",onClick:Object(Ie.a)(ke.a.mark((function e(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.current.submitForm();case 2:case"end":return e.stop()}}),e)}))),children:"Submit"})],title:t?"[Edit] Unit Type":"[Create] Unit Type",centered:!0,closable:!0,visible:!0,onCancel:n,children:[Object(Fe.jsx)(on,{errors:[].concat(Object(vn.a)(Xt(null===i||void 0===i?void 0:i.errors)),Object(vn.a)(Xt(null===d||void 0===d?void 0:d.errors))),withSpaceBottom:!0}),Object(Fe.jsx)(qe.c,{initialValues:b().defaultValues,innerRef:u,validationSchema:b().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ie.a)(ke.a.mark((function e(a){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("formData",a),!t){e.next=7;break}return e.next=4,l(a);case 4:fn.b.success("Discount option was edited successfully"),e.next=10;break;case 7:return e.next=9,r(a);case 9:fn.b.success("Discount option was created successfully");case 10:n();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(Fe.jsxs)(qe.b,{children:[Object(Fe.jsx)(we.a.Text,{strong:!0,children:"Name"}),Object(Fe.jsx)(De.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(Fe.jsx)(qe.a,{name:"name",render:function(e){return Object(Fe.jsx)(we.a.Text,{type:"danger",children:e})}})]})}})]})},Ia=[{title:"Name",dataIndex:"name"},{title:"Actions",dataIndex:"actions"}],Ta=function(){var e=Object(Oe.useState)([]),t=Object(Te.a)(e,2),n=t[0],a=t[1],r=Object(Oe.useState)(!1),c=Object(Te.a)(r,2),i=c[0],s=c[1],l=Object(Oe.useState)(null),o=Object(Te.a)(l,2),d=o[0],u=o[1],b=Ct(),j=b.isFetching,p=b.data;return Object(Oe.useEffect)((function(){var e=p.map((function(e){return{key:e.id,name:e.name,actions:Object(Fe.jsx)(Ae.b,{children:Object(Fe.jsx)(Ee.a,{type:"link",onClick:function(){!function(e){u(e),s(!0)}(e)},children:"Edit"})})}}));a(e)}),[p]),Object(Fe.jsx)(tn,{title:"Unit Types",children:Object(Fe.jsxs)(Be,{children:[Object(Fe.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(Fe.jsxs)(Ee.a,{size:"large",type:"primary",onClick:function(){u(null),s(!0)},children:[Object(Fe.jsx)(un.a,{})," Create Unit Type"]})}),Object(Fe.jsx)(jn.a,{columns:Ia,dataSource:n,loading:j,pagination:!1}),i&&Object(Fe.jsx)(ka,{unitType:d,onClose:function(){u(null),s(!1)}})]})})},_a=function(){return Object(Fe.jsx)(Se.a,{children:Object(Fe.jsxs)(Ce.e,{children:[Object(Fe.jsxs)(Ce.c,{element:Object(Fe.jsx)(dn,{}),path:"/",children:[Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Dn,{}),path:"dashboard"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(mn,{}),path:"branches"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Oa,{}),path:"products"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(xa,{}),path:"products/create"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(xa,{}),path:"products/:productId"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(na,{}),path:"preorders"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(ba,{}),path:"preorders/:preorderId"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(la,{}),path:"preorders/:preorderId/edit"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(la,{}),path:"preorders/create"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(zn,{}),path:"deliveries"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Xn,{}),path:"deliveries/:deliveryId"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Un,{}),path:"deliveries/create"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Pa,{}),path:"reports"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)($n,{}),path:"notifications"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Ta,{}),path:"unit-types"}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(Ce.a,{to:"/dashboard",replace:!0}),path:"/"})]}),Object(Fe.jsx)(Ce.c,{element:Object(Fe.jsx)(It,{}),path:"login"})]})})},Na=(n(437),function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,616)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))}),Aa=he();$t=Aa,i.a.defaults.baseURL=J.API_URL,i.a.defaults.timeout=4e4,i.a.defaults.headers.common["Content-Type"]="application/json",i.a.interceptors.request.use((function(e){if(e.baseURL!==J.API_URL)return e;var t=$t.getState().AUTH.accessToken;return e.headers.authorization=t?"Bearer ".concat(t):null,e}),(function(e){return Promise.reject(e)})),i.a.interceptors.response.use(null,(function(e){var t=Object(r.a)({},e);if(e.isAxiosError){var n,a,c;if(401===(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status)){var s=$t.getState().AUTH.refreshToken;return s?fetch("".concat(J.API_URL,"/tokens/access/verify/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s})}).then((function(e){return e.json()})).then((function(e){if("token_not_valid"===(null===e||void 0===e?void 0:e.code))throw $t.dispatch(h.logout()),new Error("refresh token has already expired");return fetch("".concat(J.API_URL,"/tokens/renew/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:s})})})).then((function(e){return e.json()})).then((function(t){var n=t.access,a=t.refresh;return $t.dispatch(h.login({access_token:n,refresh_token:a})),e.config.headers.authorization=n,i.a.request(e.config)})).catch((function(){return Promise.reject(e)})):Promise.reject(e)}if("string"===typeof(null===e||void 0===e||null===(a=e.response)||void 0===a?void 0:a.data))t.errors=[e.response.data];else if("object"===typeof(null===e||void 0===e||null===(c=e.response)||void 0===c?void 0:c.data)){var l;t.errors=Z.a.flatten(Z.a.values(null===e||void 0===e||null===(l=e.response)||void 0===l?void 0:l.data))}else t.errors=[y]}return Promise.reject(t)}));var Da=new xe.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1}}});ve.a.render(Object(Fe.jsxs)(xe.QueryClientProvider,{client:Da,children:[Object(Fe.jsx)(ge.a,{store:Aa,children:Object(Fe.jsx)(ye.a,{loading:null,persistor:Object(pe.b)(Aa),children:Object(Fe.jsx)(_a,{})})}),Object(Fe.jsx)(fe.ReactQueryDevtools,{initialIsOpen:!0})]}),document.getElementById("root")),Na()}},[[438,1,2]]]);
//# sourceMappingURL=main.ccf21237.chunk.js.map