(this["webpackJsonpmarigold-app"]=this["webpackJsonpmarigold-app"]||[]).push([[0],{208:function(e,t,n){},209:function(e,t,n){},251:function(e,t,n){},320:function(e,t,n){},420:function(e,t,n){},422:function(e,t,n){},423:function(e,t,n){},428:function(e,t,n){},429:function(e,t,n){},430:function(e,t,n){},431:function(e,t,n){},432:function(e,t,n){"use strict";n.r(t);var a,r=n(24),c=n.n(r),i=n(85),s=n(70),l=n(446),o=n(451),d=n(133),u="AUTH",b={LOGIN:"".concat(u,"/LOGIN"),LOGOUT:"".concat(u,"/LOGOUT")},j={user:null,accessToken:null,refreshToken:null},p=Object(l.a)(Object(i.a)({},b.LOGIN,(function(e,t){var n=t.payload;return Object(s.a)(Object(s.a)({},e),n)})),j),h={login:Object(o.a)(b.LOGIN),logout:Object(o.a)(b.LOGOUT)},O=function(e){return e.AUTH||j},m=function(){return Object(d.a)(O,(function(e){return e.user}))},v=function(){return Object(d.a)(O,(function(e){return e.accessToken}))},x=function(){return Object(d.a)(O,(function(e){return e.refreshToken}))},f=p,g={API_URL:"http://".concat(window.location.hostname,":8000/v1/")},y="marigold_app",S="An error occurred while processing your request",P="\u2014",C="manager",k="personnel",_="supplier",T="customer",I="vat",A="vat-e",D="delivery",N="market",w="pickup",E="special",z="available",L="reorder",R="out_of_stock",F={APPROVED:"approved",PENDING:"pending",DELIVERED:"delivered",CANCELLED:"cancelled"},V="pending",q="delivered",B="cancelled",M="paid",Y="unpaid",G="pickup",K="delivery",U="market",W={DAILY:"daily",MONTHLY:"monthly",DATE_RANGE:"date_range"},Q=n(164),H=n(80),X=n(165),Z=n.n(X),J="USER_INTEFACE",$={ON_COLLAPSE_SIDEBAR:"".concat(J,"/ON_COLLAPSE_SIDEBAR")},ee={isSidebarCollapsed:!1},te=Object(l.a)(Object(i.a)({},$.ON_COLLAPSE_SIDEBAR,(function(e,t){var n=t.payload;return Object(s.a)(Object(s.a)({},e),{},{isSidebarCollapsed:n})})),ee),ne={onCollapseSidebar:Object(o.a)($.ON_COLLAPSE_SIDEBAR)},ae=function(e){return e[J]||ee},re=function(){return Object(d.a)(ae,(function(e){return e.isSidebarCollapsed}))},ce=te,ie=Object(H.b)((a={router:Q.routerReducer},Object(i.a)(a,u,f),Object(i.a)(a,J,ce),a)),se=function(e,t){return t.type===b.LOGOUT&&(Z.a.removeItem(y),e=void 0),ie(e,t)},le=n(56),oe=n(190),de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(le.b)(),n=[Object(Q.routerMiddleware)(t)],a=[H.a.apply(void 0,n)],r={key:y,storage:Z.a,blacklist:["_persist"],keyPrefix:""},c=Object(oe.a)(r,se),i=Object(H.d)(c,e,H.c.apply(void 0,a));return i},ue=n(0),be=n(37),je=n.n(be),pe=n(32),he=n(255),Oe=n(81),me=n(257),ve=n(31),xe=n(20),fe=n(44),ge=n.n(fe),ye=n(62),Se=n(8),Pe=n(457),Ce=n(458),ke=n(452),_e=n(448),Te=n(444),Ie=n(47),Ae=n.p+"static/media/logo.6979545f.png",De=n(5),Ne=n.n(De),we=(n(320),n(1)),Ee=function(e){var t=e.children,n=e.className;return Object(we.jsx)("div",{className:Ne()("Box",n),children:t})},ze=n(28),Le=function(e){var t=Object(Oe.b)();return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(e(n))}},Re=function(){return{user:Object(Oe.c)(m()),accessToken:Object(Oe.c)(v()),refreshToken:Object(Oe.c)(x()),login:Le(h.login),logout:Le(h.logout)}},Fe={login:function(e){var t=e.body;return c.a.post("".concat("/users/","login/"),t)}},Ve="/branches/",qe={list:function(e){var t=e.params;return c.a.get("".concat(Ve),{params:t})},create:function(e){var t=e.body;return c.a.post("".concat(Ve),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(Ve).concat(t,"/"),n)},delete:function(e){return c.a.delete("".concat(Ve).concat(e,"/"))}},Be={list:function(e){var t=e.params;return c.a.get("".concat("/branch-products/"),{params:t})}},Me={list:function(e){var t=e.params;return c.a.get("".concat("/clients/"),{params:t})}},Ye="/deliveries/",Ge={list:function(e){var t=e.params;return c.a.get("".concat(Ye),{params:t})},retrieve:function(e){return c.a.get("".concat(Ye).concat(e,"/"))},create:function(e){var t=e.body;return c.a.post("".concat(Ye),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(Ye).concat(t,"/"),n)}},Ke="/notifications/",Ue={list:function(e){var t=e.params;return c.a.get("".concat(Ke),{params:t})},count:function(){return c.a.get("".concat(Ke,"count/"))}},We="/preorders/",Qe={list:function(e){var t=e.params;return c.a.get("".concat(We),{params:t})},retrieve:function(e){return c.a.get("".concat(We).concat(e,"/"))},create:function(e){var t=e.body;return c.a.post("".concat(We),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(We).concat(t,"/"),n)}},He={create:function(e){var t=e.body;return c.a.post("".concat("/preorder-transactions/"),t)}},Xe="/products/",Ze={list:function(e){var t=e.params;return c.a.get("".concat(Xe),{params:t})},retrieve:function(e){return c.a.get("".concat(Xe).concat(e,"/"))},create:function(e){var t=e.body;return c.a.post("".concat(Xe),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(Xe).concat(t,"/"),n)},delete:function(e){return c.a.delete("".concat(Xe).concat(e,"/"))}},Je="/reports/",$e={listTopPayingCustomers:function(e){var t=e.params;return c.a.get("".concat(Je,"top-customers/"),{params:t})},listTopSellingProducts:function(e){var t=e.params;return c.a.get("".concat(Je,"top-products/"),{params:t})}},et={acquire:function(e){var t=e.body;return c.a.post("".concat("/tokens/","acquire/"),t)}},tt={list:function(e){var t=e.params;return c.a.get("".concat("/unit-types/"),{params:t})}},nt=function(){return Object(pe.useQuery)("useBranches",(function(){return qe.list({params:{page:1,page_size:100}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[]}},select:function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.results}})},at=function(e){var t=e.params;return Object(pe.useQuery)(["useBranchProducts",t.page,t.pageSize,t.search,t.branchId,t.status],(function(){return Be.list({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId,search:t.search,status:t.status}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}})},rt=function(e){var t=e.params;return Object(pe.useQuery)(["useClients",t.type],(function(){return Me.list({params:{type:t.type}})}),{refetchOnWindowFocus:!1,placeholderData:{data:[]},select:function(e){return e.data}})},ct=function(){var e=Object(ve.c)(),t=Object(Se.a)(e,2),n=t[0],a=t[1];return{setSearchParams:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.shouldResetPage,c=void 0!==r&&r,i=t.shouldIncludeCurrentParams,l=void 0===i||i,o=Object(s.a)(Object(s.a)(Object(s.a)({},l?Object.fromEntries(n):{}),c?{page:1}:{}),e);Object.keys(o).forEach((function(e){return void 0===o[e]?delete o[e]:{}})),a(o)}}},it=function(e){var t=e.params;return Object(pe.useQuery)(["useDeliveries",t.page,t.pageSize,t.paymentStatus],(function(){return Ge.list({params:{payment_status:t.paymentStatus,page:t.page,page_size:t.pageSize}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{deliveries:e.data.results,total:e.data.count}}})},st=function(e){var t=e.id;return Object(pe.useQuery)(["useDelivery",t],(function(){return Ge.retrieve(t)}),{refetchOnWindowFocus:!1,select:function(e){return e.data},enabled:void 0!==t})},lt=function(e){var t=e.params;return Object(pe.useQuery)(["useNotifications",t.page,t.pageSize,t.branchId],(function(){return Ue.list({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{notifications:e.data.results,total:e.data.count}}})},ot=function(){return Object(pe.useQuery)("useNotificationsCount",(function(){return Ue.count()}),{refetchOnWindowFocus:!1,placeholderData:{data:0},select:function(e){return e.data},refetchInterval:2500})},dt=function(e){var t=e.id;return Object(pe.useQuery)(["usePreorder",t],(function(){return Qe.retrieve(t)}),{refetchOnWindowFocus:!1,select:function(e){return e.data},enabled:void 0!==t})},ut=function(e){var t=e.params;return Object(pe.useQuery)(["usePreorders",t.page,t.pageSize],(function(){return Qe.list({params:{page:t.page,page_size:t.pageSize}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{preorders:e.data.results,total:e.data.count}}})},bt=function(e){var t=e.id;return Object(pe.useQuery)(["useProduct",t],(function(){return Ze.retrieve(t)}),{refetchOnWindowFocus:!1,select:function(e){return e.data},enabled:void 0!==t})},jt=function(e){var t=e.params;return Object(pe.useQuery)(["useProducts",t.page,t.pageSize,t.search],(function(){return Ze.list({params:{page:t.page,page_size:t.pageSize,search:t.search}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}})},pt=function(e){var t=e.params;return Object(pe.useQuery)(["useReportsCustomers",t.page,t.pageSize,t.dateRange],(function(){return $e.listTopPayingCustomers({params:{page:t.page,page_size:t.pageSize,date_range:t.dateRange}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{customers:e.data.results,total:e.data.count}}})},ht=function(e){var t=e.params;return Object(pe.useQuery)(["useReportsProducts",t.page,t.pageSize,t.branchId,t.dateRange],(function(){return $e.listTopSellingProducts({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId,date_range:t.dateRange}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}})},Ot=function(){return{isSidebarCollapsed:Object(Oe.c)(re()),onCollapseSidebar:Le(ne.onCollapseSidebar)}},mt=function(){return Object(pe.useQuery)("useUnitTypes",(function(){return tt.list({params:{page:1,page_size:100}})}),{refetchOnWindowFocus:!1,placeholderData:{data:{results:[]}},select:function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.results}})},vt=n(15),xt=(n(420),{defaultValues:{login:"",password:""},schema:vt.c().shape({login:vt.d().required().label("Username"),password:vt.d().required().label("Password")})}),ft=function(){var e=Object(ue.useState)(!1),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(xe.g)(),c=Re(),i=c.user,s=c.login;return Object(ue.useEffect)((function(){i&&r("/")}),[i]),Object(we.jsx)("section",{className:"Login",children:Object(we.jsxs)(Ee,{className:"Login_container",children:[Object(we.jsx)("img",{alt:"logo",className:"Login_logo",src:Ae}),Object(we.jsx)(ze.c,{initialValues:xt.defaultValues,validationSchema:xt.schema,onSubmit:function(e,t){var n=t.setFieldError;a(!0),Fe.login({body:e}).then(function(){var t=Object(ye.a)(ge.a.mark((function t(n){var a,r,c,i;return ge.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,et.acquire({body:{username:e.login,password:e.password}});case 2:a=t.sent,r=a.data,c=r.access,i=r.refresh,s({user:n.data,accessToken:c,refreshToken:i});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){n("password","Username, email, or password is invalid.")})).finally((function(){a(!1)}))},children:function(e){var t=e.setFieldValue;return Object(we.jsx)(ze.b,{style:{width:"100%"},children:Object(we.jsxs)(ke.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(we.jsxs)("div",{children:[Object(we.jsx)(_e.a,{placeholder:"Username",prefix:Object(we.jsx)(Pe.a,{}),size:"large",onChange:function(e){t("login",e.target.value)}}),Object(we.jsx)(ze.a,{name:"login",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)("div",{children:[Object(we.jsx)(_e.a,{placeholder:"Password",prefix:Object(we.jsx)(Ce.a,{}),size:"large",type:"password",onChange:function(e){t("password",e.target.value)}}),Object(we.jsx)(ze.a,{name:"password",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsx)(Ie.a,{htmlType:"submit",loading:n,size:"large",type:"primary",block:!0,children:"Login"})]})})}})]})})},gt=n(460),yt=n(461),St=n(462),Pt=n(463),Ct=n(464),kt=n(465),_t=n(466),Tt=n(276),It=function(e){var t=e.status;return Object(ue.useCallback)((function(){var e=null;switch(t){case z:e=Object(we.jsx)(Tt.a,{color:"green",children:"Available"});break;case L:e=Object(we.jsx)(Tt.a,{color:"orange",children:"Reorder"});break;case R:e=Object(we.jsx)(Tt.a,{color:"red",children:"Out of Stock"})}return e}),[t])()},At=function(e){var t=e.status;return Object(ue.useCallback)((function(){var e=null;switch(t){case V:e=Object(we.jsx)(Tt.a,{color:"orange",children:"Pending"});break;case q:e=Object(we.jsx)(Tt.a,{color:"green",children:"Delivered"});break;case B:e=Object(we.jsx)(Tt.a,{color:"red",children:"Cancelled"})}return e}),[t])()},Dt=function(e){var t=e.name;return Object(we.jsx)(ze.a,{name:t,render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})},Nt=n(439),wt=n(265),Et=n.p+"static/media/icon-account.d6cf778e.svg",zt=n.p+"static/media/icon-logout.a7e54751.svg",Lt=n(39),Rt=n(38),Ft=n.n(Rt),Vt=function(e){switch(e){case C:return"Manager";case k:return"Personnel";default:return null}},qt=function(e){return e.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")},Bt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u20b1",n=Number(e);return Object(Lt.isNaN)(n)?"":"".concat(t).concat(qt(Object(Lt.round)(n,2).toFixed(2)))},Mt=function(e){return e?Ft()(e).format("MM/DD/YYYY h:mma"):""},Yt=(n(422),function(e){var t=e.items,n=Object(ue.useState)(!1),a=Object(Se.a)(n,2),r=a[0],c=a[1],i=Object(xe.f)().pathname,s=Re(),l=s.user,o=s.logout,d=Ot(),u=d.isSidebarCollapsed,b=d.onCollapseSidebar,j=Object(ue.useCallback)((function(){return"".concat(null===l||void 0===l?void 0:l.first_name," ").concat(null===l||void 0===l?void 0:l.last_name)}),[l]);return Object(we.jsxs)(Nt.a.Sider,{breakpoint:"md",className:Ne()("Sidebar",{Sidebar__collapsed:u}),collapsedWidth:"0",theme:"light",width:280,onCollapse:function(e){return b(e)},children:[Object(we.jsx)("img",{alt:"logo",className:"Sidebar_logo",src:Ae}),Object(we.jsx)("div",{className:"Sidebar_sidebarList",children:t.map((function(e){return Object(we.jsx)(ve.b,{tabIndex:-1,to:e.link,children:Object(we.jsxs)("div",{className:Ne()("Sidebar_sidebarList_item",{Sidebar_sidebarList_item__active:i.startsWith(e.link)}),children:[Object(we.jsx)(e.icon,{className:"Sidebar_sidebarList_item_icon",style:{fontSize:20,color:i.startsWith(e.link)?"#e0bc5d":"#626b77"}}),Object(we.jsx)("span",{className:"Sidebar_sidebarList_item_name",children:e.name}),(null===e||void 0===e?void 0:e.count)>0&&Object(we.jsx)("span",{className:"Sidebar_sidebarList_item_itemCount",children:null===e||void 0===e?void 0:e.count})]})},e.link)}))}),Object(we.jsxs)("div",{className:Ne()("bottom",{active:r}),onClick:function(){return c((function(e){return!e}))},children:[Object(we.jsxs)("div",{className:"menu",children:[Object(we.jsxs)("div",{className:"item",children:[Object(we.jsx)("img",{alt:"icon",className:"icon",src:Et}),Object(we.jsx)("span",{className:"name",children:"Account"})]}),Object(we.jsxs)("div",{className:"item",onClick:function(){return o()},children:[Object(we.jsx)("img",{alt:"icon",className:"icon",src:zt}),Object(we.jsx)("span",{className:"name",children:"Logout"})]})]}),Object(we.jsxs)("div",{className:"user-details",children:[Object(we.jsx)("img",{alt:"user avatar",className:"avatar",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAvVBMVEXh4eGjo6OkpKSpqamrq6vg4ODc3Nzd3d2lpaXf39/T09PU1NTBwcHOzs7ExMS8vLysrKy+vr7R0dHFxcXX19e5ubmzs7O6urrZ2dmnp6fLy8vHx8fY2NjMzMywsLDAwMDa2trV1dWysrLIyMi0tLTCwsLKysrNzc2mpqbJycnQ0NC/v7+tra2qqqrDw8OoqKjGxsa9vb3Pz8+1tbW3t7eurq7e3t62travr6+xsbHS0tK4uLi7u7vW1tbb29sZe/uLAAAG2UlEQVR4XuzcV47dSAyG0Z+KN+ccO+ecHfe/rBl4DMNtd/cNUtXD6DtLIAhCpMiSXwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIhHnfm0cVirHTam884sVu6Q1GvPkf0heq7VE+UF5bt2y97Vat+VlRniev/EVjjp12NlgdEytLWEy5G2hepDYOt7qGob2L23Dd3valPY6dsW+jvaBOKrkm2ldBVrbag+2tYeq1oX6RxYBsF6SY3vA8to8F0roRJaZmFFK2ASWA6CiT6EhuWkoQ9gablZ6l1oW47aWoF8dpvT6FrOunoD5pa7uf6CaslyV6rqD0guzYHLRK/hwJw40Cu4MUdu9Bt8C8yR4Jt+gRbmzEKvUTicFw8kY3NonOg/aJpTTf2AWWBOBTNBkvrmWF+QNDPnZoLUNOeagpKSOVdKhK550BVa5kGLOFfMCxY92ubFuYouNC9CFdyuebKrYrsyL9hcGpgnAxVaXDJPSrGKrGreVFVkU/NmykDJj1sV2Z55s0e74hwtS9k8KvNzxY8ZozvX+L67M4/uVFwT84Kt9CPz6EjFdUqgMyCjCTSHWD4cq7jOzKMzxtGu8ddwxzzaUXHFgXkTxCqwyLyJOON0j9POc/OCpbAj+hU/Zsz9Pbk2T65VbM/mybOKbd882VexjegLPXk0L154uvF/tR5N7RjJB9bvBsLEPJgI5dCcC2P5wL3QlSClJ+bYSSpIqpljh4IkpWNzapzqB3T9vCGBuGUOtWL9hDNPizMYmjND/QIloTkSJvKB4tHRK1iaE0u9hnhgDgxi/QFJZLmLEv0FvbHlbNzTG9ApWa5KHb0J9cByFNT1DhznGOngWO9CvWQ5KdX1AXweWy7Gn/Uh9CLLQdTTCkgPLLODVCshPrSMarHWgUpkGURrl2c83drWbp+0PlRebCsvFW0G+6FtLNzXxlDuXttGrrtlbQPlacvW1ppmCDPOHgJbQ/BwpmyQnh6siHVwcJoqB3iqNx/tHY/N+pPyg7Rz83Xv0n5zuff1ppPKCSS9audf1V6i9QAAAAAAAAAAAAAAAAAAAAAAEMdyAuVeZ9I4H95/uojGgf0QjKOLT/fD88ak0ysrI6SVo9qXRWgrhIsvtaNKqs2hXNlvD0LbSDho71fKWhsxvulf2NYu+jcro42d+e0isMyCxe18R2/D6HQYWY6i4elIryE9brbMgVbzONVP2G3sBeZMsNfYFf5h715302aDIADP2Lw+CIdDQhKcGuIgKKSIk1MSMND7v6zvBvqprdqY3bWfS1itRto/O+52t+KnW+2+OdSYK+5TViS9LxxqyX07p6xUeq7hXl+WPq/AX15QI+9fDryaw5d31EP7HPGqonMb5rmvYwow/upgWTDzKYQ/C2BV3o8oSNTPYVH26FEY7zGDNfnZo0DeOYclwc6jUN4ugBVxZ0HBFp0YJoxaFK41gn7ZGxWYZtDNrSOqEK0dFLscqMbhArXuIioS3UGnHw9U5uEHFCp9quOXUGfrUSFvC11cl0p1nbK+KwHs92yFYyo2DqFEsKdq+wAqhHsqtw+hQHykescY4rnvNOC7g3TPNOEZwt3QiBuINkxpRDqEZFOaMYVgTzTkCWKFGxqyCSHVkqYsIVQQ0ZQogEwJjUkgkvNpjO8g0ZzmzCHRieacIJBLaU7qIE+bBrUhz5YGbSHPmQadIc+EBk0gT48G9SDPPQ06QZ5gQ3M2AQQa0ZwRqtCExz1kClc0ZRVCqFuacguxEhqSQC53pBlHB8HyDY3Y5BDttgnoinRoQgfinZrTuxrxgeodYiiQ+1TOz6HCy4KqLV6gREHVCqjxSsVeociaaq2hyjOVeoYyXarUhTrdZs4VeaQ6j9DIdZsXEhXpU5U+1EqoSALFtlRjC9VGHlXwRlCuTKlAWkK9rEfxehkMCB8o3EMIE1yfovUdrHiKKFb0BEMuPQrVu8CU9xNFOr3DmtcFxVm8wqBsTGHGGUxya4+CeGsHqwZjijEewDAn5Rt9dOdgWzZt6kAqMm/xylpz1EI8i3hF0SxGXQxPvJrTEHXyMuVVTF9QN+WElZuUqKPiyEodC9RV+cbKvJWos0E1TbTe4wB1l89W/GSrWY4G4G4+NUHebhwEkGGYtPgpWskQAkjSXvr8x/xlGz/RKHcr/jOrXYn/1bh0Jh7/mjfpXPALjXC+O/Av7HfzEL+nERbJZME/tpgkRYg/1Mjms48Wf1PrYzbPIIBW8aDY9j/2vsef8vz9R39bDOL/2qlDIwCBGACCOMTLl4klOpP+i4MimFe7DZy7v3rcuaYqej+f3VE1K09+AgAAAAAAAAAAAAAAAAAAAAAAgBf6wsTW1jN3CAAAAABJRU5ErkJggg=="}),Object(we.jsxs)("div",{className:"user-text-info",children:[Object(we.jsx)("span",{className:"name",children:j()}),Object(we.jsx)("span",{className:"role",children:Vt(null===l||void 0===l?void 0:l.user_type)})]})]})]})]})}),Gt=(n(423),function(e){var t=e.loading,n=e.loadingText,a=e.sidebarItems,r=e.children;return Object(we.jsx)(Nt.a,{className:"Container",children:Object(we.jsxs)(wt.a,{size:"large",spinning:t,tip:n,wrapperClassName:"Container_spinner",children:[Object(we.jsx)(Yt,{items:a}),r]})})});Gt.defaultProps={loading:!1,loadingText:"Fetching data..."};var Kt,Ut=Gt,Wt=(n(428),function(e){var t=e.title,n=e.breadcrumb,a=e.className,r=e.children,c=Ot().isSidebarCollapsed;return Object(we.jsxs)(Nt.a,{className:Ne()("ContentLayout",a,{ContentLayout__sidebarCollapsed:c}),children:[Object(we.jsx)(Nt.a.Header,{className:"ContentLayout_header",children:Object(we.jsxs)("div",{children:[Object(we.jsx)("h3",{className:"ContentLayout_header_title",children:t}),n]})}),Object(we.jsx)(Nt.a.Content,{className:"ContentLayout_mainContent",children:r})]})}),Qt=function(e){var t=e.status;return Object(ue.useCallback)((function(){var e=null;switch(t){case Y:e=Object(we.jsx)(Tt.a,{color:"orange",children:"Unpaid"});break;case M:e=Object(we.jsx)(Tt.a,{color:"green",children:"Paid"})}return e}),[t])()},Ht=function(e){var t=e.status;return Object(ue.useCallback)((function(){var e=null;switch(t){case F.APPROVED:e=Object(we.jsx)(Tt.a,{color:"blue",children:"Approved"});break;case F.PENDING:e=Object(we.jsx)(Tt.a,{color:"orange",children:"Pending"});break;case F.DELIVERED:e=Object(we.jsx)(Tt.a,{color:"green",children:"Delivered"});break;case F.CANCELLED:e=Object(we.jsx)(Tt.a,{color:"red",children:"Cancelled"})}return e}),[t])()},Xt=n(459),Zt=function(e){var t=e.rank;return Object(ue.useCallback)((function(){var e=null;switch(t){case 1:e=Object(we.jsx)(Xt.a,{style:{fontSize:"1.5rem",marginRight:"5px",color:"#FFD700"}});break;case 2:e=Object(we.jsx)(Xt.a,{style:{fontSize:"1.25rem",marginRight:"5px",color:"#C0C0C0"}});break;case 3:e=Object(we.jsx)(Xt.a,{style:{fontSize:"1rem",marginRight:"5px",color:"#CD7F32"}})}return e}),[t])()},Jt=function(){var e=Object(xe.g)(),t=Re().user,n=ot().data;Object(ue.useEffect)((function(){t||e("/login")}),[t]);var a=Object(ue.useCallback)((function(){return[{name:"Dashboard",icon:gt.a,link:"/dashboard"},{name:"Products",icon:yt.a,link:"/products"},{name:"Branches",icon:St.a,link:"/branches"},{name:"Preorders",icon:Pt.a,link:"/preorders"},{name:"Deliveries",icon:Ct.a,link:"/deliveries"},{name:"Reports",icon:kt.a,link:"/reports"},{name:"Notifications",icon:_t.a,link:"/notifications",count:n}]}),[n]);return Object(we.jsx)(Ut,{sidebarItems:a(),children:Object(we.jsx)(xe.a,{})})},$t=n(277),en=n(453),tn=n(454),nn=n(455),an=n(442),rn=n(447),cn=function(e){var t=e.branch,n=e.onSuccess,a=e.onClose,r=Object(ue.useState)(!1),c=Object(Se.a)(r,2),i=c[0],s=c[1],l=Object(ue.useRef)(),o=Object(ue.useCallback)((function(){return{defaultValues:{id:null===t||void 0===t?void 0:t.id,name:(null===t||void 0===t?void 0:t.name)||""},schema:vt.c().shape({name:vt.d().required().label("Name")})}}),[t]);return Object(we.jsx)(rn.a,{footer:[Object(we.jsx)(Ie.a,{disabled:i,size:"large",onClick:a,children:"Cancel"}),Object(we.jsx)(Ie.a,{loading:i,size:"large",type:"primary",onClick:function(){l.current.submitForm()},children:"Submit"})],title:t?"[Edit] Branch":"[Create] Branch",centered:!0,closable:!0,visible:!0,onCancel:a,children:Object(we.jsx)(ze.c,{initialValues:o().defaultValues,innerRef:l,validationSchema:o().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(ye.a)(ge.a.mark((function e(t,r){var c,i;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.setFieldError,s(!0),e.prev=2,i=t.id?qe.edit:qe.create,e.next=6,i({id:t.id,body:t});case 6:n(),a(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),c("name",S);case 13:return e.prev=13,s(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(we.jsxs)(ze.b,{children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Name"}),Object(we.jsx)(_e.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(we.jsx)(ze.a,{name:"name",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]})}})})},sn=(n(429),[{title:"Name",dataIndex:"name"},{title:"Actions",dataIndex:"actions"}]),ln=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ue.useState)(!1),c=Object(Se.a)(r,2),i=c[0],s=c[1],l=Object(ue.useState)(null),o=Object(Se.a)(l,2),d=o[0],u=o[1],b=Object(ue.useState)(!1),j=Object(Se.a)(b,2),p=j[0],h=j[1],O=nt(),m=O.isFetching,v=O.data,x=O.refetch;return Object(ue.useEffect)((function(){var e=v.map((function(e){return{key:e.id,name:e.name,actions:Object(we.jsxs)(ke.b,{children:[Object(we.jsx)(Ie.a,{type:"link",onClick:function(){!function(e){u(e),s(!0)}(e)},children:"Edit"}),Object(we.jsx)(en.a,{cancelText:"No",okButtonProps:{loading:p},okText:"Yes",placement:"top",title:"Are you sure you want to delete ".concat(e.name,"?"),onConfirm:function(){var t;t=e.id,h(!0),qe.delete(t).then((function(){x()})).finally((function(){h(!1)}))},children:Object(we.jsx)(Ie.a,{type:"link",danger:!0,children:"Delete"})})]})}}));a(e)}),[v]),Object(we.jsx)(Wt,{className:"Branches",title:"Branches",children:Object(we.jsxs)(Ee,{children:[Object(we.jsx)(tn.a,{className:"Branches_createRow",justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsxs)(Ie.a,{size:"large",type:"primary",onClick:function(){u(null),s(!0)},children:[Object(we.jsx)($t.a,{})," Create Branch"]})})}),Object(we.jsx)(an.a,{columns:sn,dataSource:n,loading:m,pagination:!1,rowKey:"key"}),i&&Object(we.jsx)(cn,{branch:d,onClose:function(){u(null),s(!1)},onSuccess:x})]})})},on=n(445),dn=n(26),un=n(147),bn=n(440),jn=function(){var e=Object(ve.c)(),t=Object(Se.a)(e,1)[0],n=ct().setSearchParams,a=Object(bn.a)((function(e){n({search:e})}),500);return Object(we.jsxs)(tn.a,{className:"Products_filter",gutter:[15,15],children:[Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Search"}),Object(we.jsx)(_e.a,{defaultValue:t.get("search"),allowClear:!0,onChange:function(e){return a(e.target.value.trim())}})]}),Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Status"}),Object(we.jsxs)(un.a,{style:{width:"100%"},value:t.get("status"),allowClear:!0,onChange:function(e){n({status:e})},children:[Object(we.jsx)(un.a.Option,{value:z,children:"Available"}),Object(we.jsx)(un.a.Option,{value:L,children:"Reorder"}),Object(we.jsx)(un.a.Option,{value:R,children:"Out of Stock"})]})]})]})},pn=function(e){var t=e.unitTypes,n=Object(ue.useState)([]),a=Object(Se.a)(n,2),r=a[0],c=a[1],i=Object(ve.c)(),s=Object(Se.a)(i,1)[0],l=ct().setSearchParams,o=at({params:{page:s.get("page"),pageSize:s.get("pageSize"),branchId:s.get("branchId"),search:s.get("search"),status:s.get("status")}}),d=o.isFetching,u=o.data,b=u.total,j=u.products;Object(ue.useEffect)((function(){var e=j.map((function(e){var t={key:e.id,name:Object(we.jsx)(ve.b,{className:"BranchProducts_productName",to:"/products?search=".concat(e.name),children:e.name}),status:Object(we.jsx)(It,{status:e.status})};return e.product_prices.forEach((function(e){t[String(e.unit_type_id)]=e.balance})),t}));c(e)}),[j]);var p=Object(ue.useCallback)((function(){var e=Object(Lt.flatten)(null===j||void 0===j?void 0:j.map((function(e){return e.product_prices.map((function(e){return e.unit_type_id}))}))),n=t.filter((function(t){return e.includes(t.id)}));return[{title:"Name",dataIndex:"name",fixed:"left"}].concat(Object(dn.a)(n.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))),[{title:"Status",dataIndex:"status"}])}),[j,t]);return Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(jn,{}),Object(we.jsx)(an.a,{columns:p(),dataSource:r,loading:d,pagination:{current:s.get("page")||1,total:b,pageSize:s.get("pageSize")||10,onChange:function(e,t){l({page:e,pageSize:t})},disabled:0===j.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:800}})]})},hn=function(){var e=Object(ve.c)(),t=Object(Se.a)(e,1)[0],n=ct().setSearchParams,a=nt(),r=a.isFetching,c=a.data,i=mt(),s=i.isFetching,l=i.data;Object(ue.useEffect)((function(){var e;!t.has("branchId")&&c.length>0&&n({branchId:null===c||void 0===c||null===(e=c[0])||void 0===e?void 0:e.id})}),[c,t]);return Object(we.jsx)(Wt,{title:"Dashboard",children:Object(we.jsx)(Ee,{children:Object(we.jsx)(wt.a,{spinning:r||s,children:Object(we.jsx)(on.a,{activeKey:t.get("branchId"),type:"card",onTabClick:function(e){n({branchId:e})},children:c.map((function(e){var t=e.name,n=e.id;return Object(we.jsx)(on.a.TabPane,{tab:t,children:Object(we.jsx)(pn,{unitTypes:l})},n)}))})})})})},On=(n(208),[{title:"ID",dataIndex:"id"},{title:"Date Created",dataIndex:"date_created"},{title:"Schedule of Delivery",dataIndex:"schedule_of_delivery"},{title:"Date Completed",dataIndex:"date_completed"},{title:"Payment",dataIndex:"payment",align:"center"},{title:"Customer",dataIndex:"customer"},{title:"Status",dataIndex:"status",align:"center"},{title:"Actions",dataIndex:"actions"}]),mn=function(){var e=Object(ve.c)(),t=Object(Se.a)(e,1)[0],n=ct().setSearchParams;return Object(we.jsx)(tn.a,{gutter:[15,15],children:Object(we.jsxs)(nn.a,{span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Status"}),Object(we.jsxs)(un.a,{style:{width:"100%"},value:t.get("paymentStatus"),allowClear:!0,onChange:function(e){n({paymentStatus:e})},children:[Object(we.jsx)(un.a.Option,{value:Y,children:"Unpaid"}),Object(we.jsx)(un.a.Option,{value:M,children:"Paid"})]})]})})},vn=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ve.c)(),c=Object(Se.a)(r,1)[0],i=Object(xe.g)(),s=ct().setSearchParams,l=it({params:{paymentStatus:c.get("paymentStatus"),page:c.get("page"),pageSize:c.get("pageSize")}}),o=l.isFetching,d=l.data,u=d.total,b=d.deliveries;return Object(ue.useEffect)((function(){var e=b.map((function(e){var t;return{key:e.id,id:e.id,date_created:Mt(e.datetime_created),schedule_of_delivery:Mt(e.datetime_delivery),date_completed:Mt(e.datetime_completed),payment:Object(we.jsx)(Qt,{status:null===e||void 0===e?void 0:e.payment_status}),customer:null===e||void 0===e||null===(t=e.customer)||void 0===t?void 0:t.name,status:Object(we.jsx)(At,{status:e.status}),actions:Object(we.jsx)(ve.b,{to:"/deliveries/".concat(e.id),children:"View"})}}));a(e)}),[b]),Object(we.jsx)(Wt,{className:"Deliveries",title:"Deliveries",children:Object(we.jsxs)(Ee,{children:[Object(we.jsxs)(tn.a,{className:"Deliveries_createRow",gutter:[15,15],justify:"space-between",children:[Object(we.jsx)(nn.a,{md:6,sm:12,span:24,children:Object(we.jsx)(mn,{})}),Object(we.jsx)(nn.a,{children:Object(we.jsxs)(Ie.a,{size:"large",type:"primary",onClick:function(){i("create")},children:[Object(we.jsx)($t.a,{})," Create Delivery"]})})]}),Object(we.jsx)(an.a,{columns:On,dataSource:n,loading:o,pagination:{current:c.get("page")||1,total:u,pageSize:c.get("pageSize")||10,onChange:function(e,t){s({page:e,pageSize:t})},disabled:0===b.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:800}})]})})},xn=n(275),fn=n(443),gn=n(441),yn=n(456),Sn=n(148),Pn="ALL",Cn="SELECTED",kn=function(e,t){var n=0,a=t.priceMarket,r=t.priceDelivery,c=t.pricePickup;return e===G?n=a:e===K?n=r:e===U&&(n=c),n},_n=function(e){var t=e.branches,n=e.customers,a=e.values,r=e.onSetFieldValue,c=Object(ue.useState)(!1),i=Object(Se.a)(c,2),s=i[0],l=i[1];return Object(we.jsx)(Ee,{children:Object(we.jsxs)(tn.a,{gutter:[15,15],children:[Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Branch Source"}),Object(we.jsx)(un.a,{style:{width:"100%"},value:a.branchId,onChange:function(e){r("branchId",e)},children:t.map((function(e){return Object(we.jsx)(un.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(we.jsx)(Dt,{name:"branchId"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Delivery Type"}),Object(we.jsxs)(un.a,{style:{width:"100%"},value:a.deliveryType,onChange:function(e){r("deliveryType",e)},children:[Object(we.jsx)(un.a.Option,{value:K,children:"Delivery"},K),Object(we.jsx)(un.a.Option,{value:G,children:"Pickup"},G),Object(we.jsx)(un.a.Option,{value:U,children:"Market"},U)]}),Object(we.jsx)(Dt,{name:"deliveryType"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Schedule of Delivery"}),Object(we.jsx)(fn.a,{allowClear:!1,format:"MMM DD, YYYY hh:mm A",showTime:{format:"hh:mm A"},style:{width:"100%"},onOk:function(e){r("datetimeDelivery",e)}}),Object(we.jsx)(Dt,{name:"datetimeDelivery"})]}),Object(we.jsx)(nn.a,{span:24,children:Object(we.jsx)(gn.a,{children:"Customer"})}),Object(we.jsxs)(nn.a,{md:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Customer's Name"}),Object(we.jsx)(un.a,{mode:"tags",style:{width:"100%"},value:null!==a.customerName?[a.customerName]:[],onDeselect:function(){r("customerName",null),r("customerAddress",null),r("customerLandline",null),r("customerPhone",null),r("customerDescription",null)},onSelect:function(e){var t=e;r("customerName",t);var a=n.find((function(e){return e.name===t}));r("customerAddress",(null===a||void 0===a?void 0:a.address)||""),r("customerLandline",(null===a||void 0===a?void 0:a.landline)||""),r("customerPhone",(null===a||void 0===a?void 0:a.phone)||""),r("customerDescription",(null===a||void 0===a?void 0:a.description)||"")},children:n.map((function(e){return Object(we.jsx)(un.a.Option,{value:e.name,children:e.name},e.id)}))}),Object(we.jsx)(Dt,{name:"customerName"})]}),Object(we.jsxs)(nn.a,{md:6,sm:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Customer's Phone Number"}),Object(we.jsx)(_e.a,{value:a.customerPhone,onChange:function(e){r("customerPhone",e.target.value)}}),Object(we.jsx)(Dt,{name:"customerPhone"})]}),Object(we.jsxs)(nn.a,{md:6,sm:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Customer's Telephone Number"}),Object(we.jsx)(_e.a,{value:a.customerLandline,onChange:function(e){r("customerLandline",e.target.value)}}),Object(we.jsx)(Dt,{name:"customerLandline"})]}),Object(we.jsxs)(nn.a,{span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Customer's Address"}),Object(we.jsx)(_e.a,{value:a.customerAddress,onChange:function(e){r("customerAddress",e.target.value)}}),Object(we.jsx)(Dt,{name:"customerAddress"})]}),Object(we.jsxs)(nn.a,{span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Customer's Description"}),s?Object(we.jsxs)(_e.a.Group,{compact:!0,children:[Object(we.jsx)(_e.a,{style:{width:"calc(100% - 70px)"},value:a.customerDescription,onChange:function(e){r("customerDescription",e.target.value)}}),Object(we.jsx)(Ie.a,{type:"primary",onClick:function(){l(!1)},children:"Save"})]}):Object(we.jsx)(yn.a,{action:Object(we.jsx)(Ie.a,{size:"small",type:"link",onClick:function(){l(!0)},children:"Edit"}),description:a.customerDescription,type:"info",showIcon:!0}),Object(we.jsx)(Dt,{name:"customerDescription"})]})]})})},Tn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(ue.useState)(1),r=Object(Se.a)(a,2),c=r[0],i=r[1],s=Object(ue.useState)(10),l=Object(Se.a)(s,2),o=l[0],d=l[1],u=Object(ue.useState)([]),b=Object(Se.a)(u,2),j=b[0],p=b[1],h=at({params:{page:c,pageSize:o,branchId:t.branchId}}),O=h.isFetching,m=h.data,v=m.total,x=m.products;return Object(ue.useEffect)((function(){p(x.map((function(e){var a=t.deliveryProducts.find((function(t){return t.productId===e.id}));return{key:e.id,name:Object(we.jsx)(Sn.a,{checked:a,disabled:e.status===R,onChange:function(a){var r=[];r=a.target.checked?[].concat(Object(dn.a)(t.deliveryProducts),[{productId:e.id,productName:e.name,productStatus:e.status,productPrices:e.product_prices.map((function(e){return{branchProductId:e.branch_product_id,unitTypeId:e.unit_type_id,priceMarket:e.price_market,priceDelivery:e.price_delivery,pricePickup:e.price_pickup,balance:e.balance,quantity:0}}))}]):t.deliveryProducts.filter((function(t){return t.productId!==e.id})),n("deliveryProducts",r)},children:e.name}),status:Object(we.jsx)(It,{status:e.status})}})))}),[x,t]),Object(ue.useEffect)((function(){p([]),n("deliveryProducts",[])}),[t.branchId]),Object(we.jsx)(an.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}],dataSource:j,loading:O,pagination:{current:c,total:v,pageSize:o,onChange:function(e,t){i(e),d(t)},disabled:O,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key"})},In=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(ue.useState)([]),r=Object(Se.a)(a,2),c=r[0],i=r[1],s=Object(ue.useState)(0),l=Object(Se.a)(s,2),o=l[0],d=l[1],u=mt(),b=u.isFetching,j=u.data;Object(ue.useEffect)((function(){var e=0;i(t.deliveryProducts.map((function(a,r){var c={key:a.productId,name:Object(we.jsx)(Sn.a,{checked:!0,onChange:function(){n("deliveryProducts",t.deliveryProducts.filter((function(e){return e.productId!==a.productId})))},children:a.productName})},i=0;return a.productPrices.forEach((function(e,a){var s=e.quantity,l=kn(t.deliveryType,{priceMarket:e.priceMarket,priceDelivery:e.priceDelivery,pricePickup:e.pricePickup});i+=l*s,c[String(e.unitTypeId)]=Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(_e.a,{style:{textAlign:"center"},type:"number",onChange:function(e){n("deliveryProducts.".concat(r,".productPrices.").concat(a,".quantity"),Number(e.target.value))}}),Object(we.jsx)(Dt,{name:"deliveryProducts.".concat(r,".productPrices.").concat(a,".quantity")})]})})),c.subtotal=Bt(i),e+=i,c}))),d(e)}),[t,j]);var p=Object(ue.useCallback)((function(){var e,n=Object(Lt.flatten)(null===t||void 0===t||null===(e=t.deliveryProducts)||void 0===e?void 0:e.map((function(e){return e.productPrices.map((function(e){return e.unitTypeId}))}))),a=j.filter((function(e){return n.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(dn.a)(a.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Subtotal",dataIndex:"subtotal"}])}),[t,j]);return Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(an.a,{columns:p(),dataSource:c,loading:b,pagination:!1,rowKey:"key",scroll:{x:800}}),Object(we.jsxs)(Te.a.Title,{className:"CreateDelivery_grandTotal",level:3,children:["Grand Total: ",Bt(o)]})]})},An=function(){var e,t=Object(ue.useState)(!1),n=Object(Se.a)(t,2),a=n[0],r=n[1],c=Object(xe.g)(),i=nt(),s=i.isFetching,l=i.data,o=rt({params:{type:T}}),d=o.isFetching,u=o.data,b={defaultValues:{branchId:null,deliveryType:null,datetimeDelivery:null,customerName:null,customerAddress:null,customerLandline:null,customerPhone:null,customerDescription:null,deliveryProducts:[]},schema:vt.c().shape({branchId:vt.d().required().label("Branch").nullable(),deliveryType:vt.d().required().label("Delivery Type").nullable(),datetimeDelivery:(e="Schedule Of Delivery",vt.d().required().nullable().test("is-valid-date","".concat(e," is not a valid time"),(function(e){return Ft()(e).isValid()})).label(e)),customerName:vt.d().required().label("Customer Name").nullable(),customerAddress:vt.d().required().label("Customer Address").nullable(),customerLandline:vt.d().label("Customer Telephone").nullable(),customerPhone:vt.d().label("Customer Phone").nullable(),customerDescription:vt.d().label("Customer Description").nullable(),deliveryProducts:vt.a().of(vt.c().shape({productId:vt.b().required(),productName:vt.d().required(),productStatus:vt.d().required(),productPrices:vt.a().of(vt.c().shape({branchProductId:vt.b().required().label("Product"),unitTypeId:vt.b().required(),price:vt.b(),quantity:vt.b().required().min(0,"Must not be negative").label("Quantity")}))}))})},j=function(e){rn.a.success({title:"Success",content:"Delivery is successfully created.",keyboard:!1,okText:"View Delivery",onOk:function(){c("/deliveries/".concat(e))}})};return Object(we.jsx)(Wt,{title:"Create Delivery",children:Object(we.jsx)(wt.a,{spinning:s||d,children:Object(we.jsx)(ze.c,{initialValues:b.defaultValues,validationSchema:b.schema,onSubmit:function(){var e=Object(ye.a)(ge.a.mark((function e(t){var n,a,c,i;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(!0),!(t.deliveryProducts.length>0)){e.next=22;break}if(e.prev=2,n=u.find((function(e){return e.name===t.customerName})),!((a=Object(Lt.flatten)(t.deliveryProducts.map((function(e){return e.productPrices.filter((function(e){return e.quantity>0})).map((function(e){var n=kn(t.deliveryType,{priceMarket:e.priceMarket,priceDelivery:e.priceDelivery,pricePickup:e.pricePickup});return{branch_product_id:e.branchProductId,quantity:e.quantity,price:n}}))})))).length>0)){e.next=13;break}return e.next=8,Ge.create({body:{branch_id:t.branchId,delivery_type:t.deliveryType,datetime_delivery:(s=Ft()(t.datetimeDelivery),Ft()(s).format("YYYY-MM-DD HH:mm:ss")),customer:{id:null===n||void 0===n?void 0:n.id,name:t.customerName,description:t.customerDescription,address:t.customerAddress,landline:t.customerLandline.length>0?t.customerLandline:void 0,phone:t.customerPhone.length>0?t.customerPhone:void 0},delivery_products:a}});case 8:c=e.sent,i=c.data,j(i.id),e.next=14;break;case 13:xn.b.error("Please add quantity to products first");case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0),xn.b.error(S);case 20:e.next=23;break;case 22:xn.b.error("Please add a product first");case 23:r(!1);case 24:case"end":return e.stop()}var s}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.errors,r=e.setFieldValue;return Object(we.jsxs)(ze.b,{style:{width:"100%"},children:[console.log("errors",n),console.log("values",t),Object(we.jsxs)(wt.a,{spinning:a,children:[Object(we.jsx)(_n,{branches:l,customers:u,values:t,onSetFieldValue:r}),null!==t.branchId&&Object(we.jsx)(Ee,{children:Object(we.jsxs)(on.a,{defaultActiveKey:Pn,size:"large",type:"card",children:[Object(we.jsx)(on.a.TabPane,{tab:"All",children:Object(we.jsx)(Tn,{values:t,onSetFieldValue:r})},Pn),Object(we.jsx)(on.a.TabPane,{tab:"Selected Products (".concat(t.deliveryProducts.length,")"),children:Object(we.jsx)(In,{values:t,onSetFieldValue:r})},Cn)]})}),Object(we.jsx)(Ee,{children:Object(we.jsx)(tn.a,{justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsx)(Ie.a,{htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})})]})]})}})})})},Dn=n(450),Nn=n(189),wn={defaultValues:{preparedBy:"",checkedBy:"",pulledOutBy:"",deliveredBy:"",paymentStatus:""},schema:vt.c().shape({preparedBy:vt.d().label("Prepared By"),checkedBy:vt.d().label("Checked By"),pulledOutBy:vt.d().label("Pulled Out By"),deliveredBy:vt.d().label("Delivered By"),paymentStatus:vt.d().label("Payment Status")})},En=function(){var e,t,n,a,r,c,i,s,l=Object(ue.useState)(!1),o=Object(Se.a)(l,2),d=o[0],u=o[1],b=Object(ue.useState)([]),j=Object(Se.a)(b,2),p=j[0],h=j[1],O=Object(ue.useState)(!1),m=Object(Se.a)(O,2),v=m[0],x=m[1],f=Object(ue.useState)(""),g=Object(Se.a)(f,2),y=g[0],C=g[1],k=Object(xe.h)(),_=mt(),T=_.isFetching,I=_.data,A=st({id:k.deliveryId}),D=A.isFetching,N=A.data,w=A.refetch;Object(ue.useEffect)((function(){var e={};null===N||void 0===N||N.delivery_products.forEach((function(t){var n=t.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)})),h(Object.keys(e).map((function(t){var n=e[t],a={key:t,name:t};return n.forEach((function(e){var t=String(e.unit_type.id);a[t]=Number(e.quantity)})),a})))}),[N]);var E=Object(ue.useCallback)((function(){var e,t=(null===N||void 0===N||null===(e=N.delivery_products)||void 0===e?void 0:e.map((function(e){return e.unit_type.id})))||[],n=I.filter((function(e){return t.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(dn.a)(n.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))))}),[N,I]);return Object(we.jsxs)(Wt,{className:"ViewDelivery",title:"Delivery",children:[Object(we.jsxs)(wt.a,{spinning:D||T||d,children:[Object(we.jsxs)(Ee,{children:[(null===N||void 0===N?void 0:N.status)!==B&&Object(we.jsx)(tn.a,{className:"ViewDelivery_print",children:Object(we.jsx)(nn.a,{sm:12,xs:24,children:Object(we.jsx)(Ie.a,{loading:v,size:"large",type:"primary",ghost:!0,onClick:function(){if(N){x(!0);var e=new Nn.a({orientation:"p",unit:"px",format:"legal",hotfixes:["px_scaling"]}),t=function(e){var t=2*(e.delivery_products.length+1)>42,n=0,a=[].concat(Object(dn.a)(e.delivery_products.map((function(e){var t=Number(e.quantity)*Number(e.price);return n+=t,"\n    <tr>\n      <td>".concat(e.quantity,"</td>\n      <td>").concat(Object(Lt.upperCase)(e.unit_type.name),"</td>\n      <td>").concat(Object(Lt.upperCase)(e.product.name),"</td>\n      <td>").concat(Bt(e.price,"P"),"</td>\n      <td>").concat(Bt(t,"P"),"</td>\n    </tr>\n    ")}))),["<tr>\n      <td></td>\n      <td></td>\n      <td><b>TOTAL: </b></td>\n      <td></td>\n      <td>".concat(Bt(n,"P"),"</td>\n    </tr>\n    ")]).join(""),r=function(){return'\n       <div class="header">\n        <div class="header-text font-weight-bold">DELIVERY RECEIPT - #'.concat(e.id,'</div>\n        <div>\n          <strong>ORDERED BY:</strong>\n        </div>\n        <div>\n          <span class="text-center font-weight-bold">\n            ').concat(e.customer.name,'\n          </span>\n        </div>\n        <div>\n          <strong>DATE: </strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(Ft()(e.datetime_created).format("MMM DD, YYYY"),'\n          </span>\n        </div>\n        <div>\n          <strong>ADDRESS:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.customer.address,'\n          </span>\n        </div>\n        <div>\n          <strong>RECEIVED BY:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.user.first_name," ").concat(e.user.last_name,'\n          </span>\n        </div>\n        <div>\n          <strong>TIME:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n          ').concat(Ft()(e.datetime_created).format("hh:mm A"),'\n          </span>\n        </div>\n        <div>\n          <strong>CONTACT NO:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.customer.phone||""," ").concat(e.customer.landline||"",'\n          </span>\n        </div>\n      </div>\n  \n      <div class="products">\n        <table>\n          <tr>\n            <th colspan="2">QUANTITY</th>\n            <th>ARTICLES</th>\n            <th>UNIT PRICE</th>\n            <th>AMOUNT</th>\n          </tr>\n          ').concat(a,'\n        </table>\n      </div>\n  \n      <div class="footer">\n        <div>\n          <div>Receive the above goods in good order and conditions.</div>\n          <div class="signature"></div>\n          <div class="signature-label">Customer\'s Complete Name & Signature</div>\n        </div>\n  \n        <div class="users">\n          <div>\n            <strong>PREPARED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>CHECKED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>PULLED-OUT BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>DELIVERED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n        </div>\n  \n        <div class="disclaimer">\n          NOTE: This order slip at the same time serves as the temporary delivery\n          receipt. Our official invoice will be issued upon return of the receipt\n          and fully signed by the customer.\n        </div>\n      </div>\n  \n      <div class="note">\n        <span>BLACK = CUSTOMER\'S COPY</span>\n        <span>BLUE = MARIGOLD\'S COPY</span>\n      </div>')};return'\n  <html lang="en">\n    <head>\n      <style>\n        * {\n          font-size: 11px;\n        }\n  \n        .header, .products, .footer, .note {\n          width: 795px;\n        }\n  \n        .header {\n          display: grid;\n          grid-template-columns: repeat(4, 1fr);\n          border: 1px solid black;\n        }\n  \n        .header-text {\n          grid-column: 1 / span 4;\n          text-align: center;\n        }\n  \n        .header > div {\n          padding: 1px;\n          border-top: 1px solid black;\n        }\n  \n        .products table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n  \n        .products table th,\n        .products table td {\n          border: 1px solid black;\n          text-align: center;\n        }\n  \n        .footer {\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n        }\n  \n        .footer > div {\n          padding: 2.5px;\n          border: 1px solid black;\n        }\n  \n        .footer .signature {\n          width: 80%;\n          border-bottom: 1px solid black;\n          margin: 15px auto 0;\n        }\n  \n        .footer .signature-label {\n          text-align: center;\n        }\n  \n        .footer .users {\n          display: grid;\n          grid-template-columns: repeat(2, 1fr);\n        }\n  \n        .footer .users span {\n          width: 80%;\n          height: 100%;\n          border-bottom: 1px solid black;\n          margin: auto 0;\n          display: block;\n        }\n  \n        .footer .disclaimer {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          text-align: center;\n          padding: 10px;\n          font-size: 10px;\n        }\n  \n        .note {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n  \n        .text-center {\n          text-align: center;\n        }\n  \n        .font-weight-bold {\n          font-weight: bold;\n        }\n      </style>\n    </head>\n  \n    <body>\n      <div style="height: '.concat(t?"1300px":"auto",';">\n        ').concat(r(),'\n      </div>\n\n      </br></br>\n\n      <div style="color: #00A2FF !important;">\n        ').concat(r(),"\n      </div>\n    </body>\n  </html>\n  ")}(N);C(t),setTimeout((function(){e.html(t,{margin:10,filename:"Delivery_".concat(N.id),callback:function(e){window.open(e.output("bloburl").toString()),x(!1),C("")}})}),2e3)}else xn.b.error(S)},children:"Print Delivery"})})}),Object(we.jsxs)(Dn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(we.jsx)(Dn.b.Item,{label:"ID",span:2,children:null===N||void 0===N?void 0:N.id}),Object(we.jsx)(Dn.b.Item,{label:"Branch",children:null===N||void 0===N||null===(e=N.branch)||void 0===e?void 0:e.name}),Object(we.jsx)(Dn.b.Item,{label:"Delivery Type",children:Object(Lt.upperFirst)(null===N||void 0===N?void 0:N.delivery_type)}),Object(we.jsxs)(Dn.b.Item,{label:"Created By",children:[null===N||void 0===N||null===(t=N.user)||void 0===t?void 0:t.first_name," ",null===N||void 0===N||null===(n=N.user)||void 0===n?void 0:n.last_name]}),Object(we.jsx)(Dn.b.Item,{label:"Datetime Created",children:Mt(null===N||void 0===N?void 0:N.datetime_created)}),Object(we.jsx)(Dn.b.Item,{label:"Schedule of Delivery",children:Mt(null===N||void 0===N?void 0:N.datetime_fulfilled)}),Object(we.jsx)(Dn.b.Item,{label:"Status",children:Object(we.jsx)(Ht,{status:null===N||void 0===N?void 0:N.status})})]}),Object(we.jsx)(gn.a,{}),Object(we.jsxs)(Dn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Customer",bordered:!0,children:[Object(we.jsx)(Dn.b.Item,{label:"Name",span:2,children:null===N||void 0===N||null===(a=N.customer)||void 0===a?void 0:a.name}),Object(we.jsx)(Dn.b.Item,{label:"Phone",children:(null===N||void 0===N||null===(r=N.customer)||void 0===r?void 0:r.phone)||P}),Object(we.jsx)(Dn.b.Item,{label:"Telephone",children:(null===N||void 0===N||null===(c=N.customer)||void 0===c?void 0:c.landline)||P}),Object(we.jsx)(Dn.b.Item,{label:"Address",span:2,children:null===N||void 0===N||null===(i=N.customer)||void 0===i?void 0:i.address}),Object(we.jsx)(Dn.b.Item,{label:"Description",span:2,children:null===N||void 0===N||null===(s=N.customer)||void 0===s?void 0:s.description})]}),Object(we.jsx)(gn.a,{}),Object(we.jsx)(an.a,{columns:E(),dataSource:p,pagination:!1,rowKey:"key",scroll:{x:800}})]}),(null===N||void 0===N?void 0:N.status)===q&&Object(we.jsx)(Ee,{children:Object(we.jsxs)(Dn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Delivery",bordered:!0,children:[Object(we.jsx)(Dn.b.Item,{label:"Delivery Completed",span:2,children:Mt(null===N||void 0===N?void 0:N.datetime_completed)}),Object(we.jsx)(Dn.b.Item,{label:"Prepared By",children:(null===N||void 0===N?void 0:N.prepared_by)||P}),Object(we.jsx)(Dn.b.Item,{label:"Checked By",children:(null===N||void 0===N?void 0:N.checked_by)||P}),Object(we.jsx)(Dn.b.Item,{label:"Pulled Out By",children:(null===N||void 0===N?void 0:N.pulled_out_by)||P}),Object(we.jsx)(Dn.b.Item,{label:"Delivered By",children:(null===N||void 0===N?void 0:N.delivered_by)||P}),Object(we.jsx)(Dn.b.Item,{label:"Payment Status",children:Object(we.jsx)(Qt,{status:null===N||void 0===N?void 0:N.payment_status})})]})}),(null===N||void 0===N?void 0:N.status)===V&&Object(we.jsx)(Ee,{children:Object(we.jsx)(ze.c,{initialValues:wn.defaultValues,validationSchema:wn.schema,onSubmit:function(){var e=Object(ye.a)(ge.a.mark((function e(t){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,Ge.edit({id:k.deliveryId,body:{status:q,payment_status:t.paymentStatus,prepared_by:t.preparedBy,checked_by:t.checkedBy,pulled_out_by:t.pulledOutBy,delivered_by:t.deliveredBy}});case 4:w(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),xn.b.error(S);case 10:return e.prev=10,u(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(we.jsxs)(ze.b,{children:[Object(we.jsxs)(tn.a,{gutter:[24,24],children:[Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Prepared By"}),Object(we.jsx)(_e.a,{value:t.name,onChange:function(e){n("preparedBy",e.target.value)}}),Object(we.jsx)(Dt,{name:"preparedBy"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Checked By"}),Object(we.jsx)(_e.a,{value:t.name,onChange:function(e){n("checkedBy",e.target.value)}}),Object(we.jsx)(Dt,{name:"checkedBy"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Pulled Out"}),Object(we.jsx)(_e.a,{value:t.name,onChange:function(e){n("pulledOutBy",e.target.value)}}),Object(we.jsx)(Dt,{name:"pulledOutBy"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Delivered By"}),Object(we.jsx)(_e.a,{value:t.name,onChange:function(e){n("deliveredBy",e.target.value)}}),Object(we.jsx)(Dt,{name:"deliveredBy"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Payment Status"}),Object(we.jsxs)(un.a,{style:{width:"100%"},value:t.payment_status,allowClear:!0,onChange:function(e){n("paymentStatus",e)},children:[Object(we.jsx)(un.a.Option,{value:Y,children:"Unpaid"}),Object(we.jsx)(un.a.Option,{value:M,children:"Paid"})]}),Object(we.jsx)(Dt,{name:"paymentStatus"})]})]}),Object(we.jsx)(tn.a,{className:"ViewDelivery_setAsDelivered",justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsx)(Ie.a,{htmlType:"submit",size:"large",type:"primary",children:"Set As Delivered"})})})]})}})})]}),Object(we.jsx)("div",{dangerouslySetInnerHTML:{__html:y}})]})},zn=(n(430),[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}]),Ln=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ve.c)(),c=Object(Se.a)(r,1)[0],i=ct().setSearchParams,s=lt({params:{page:c.get("page"),pageSize:c.get("pageSize"),branchId:c.get("branchId")}}),l=s.isFetching,o=s.data,d=o.total,u=o.notifications;return Object(ue.useEffect)((function(){var e=u.map((function(e){return{key:e.id,name:"".concat(e.product.name," (").concat(e.unit_type.name,")"),status:Object(we.jsx)(It,{status:e.status})}}));a(e)}),[u]),Object(we.jsx)(an.a,{columns:zn,dataSource:n,loading:l,pagination:{current:c.get("page")||1,total:d,pageSize:c.get("pageSize")||10,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===u.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:800}})},Rn=function(){var e=Object(ve.c)(),t=Object(Se.a)(e,1)[0],n=ct().setSearchParams,a=nt(),r=a.isFetching,c=a.data;Object(ue.useEffect)((function(){var e;!t.has("branchId")&&c.length>0&&n({branchId:null===c||void 0===c||null===(e=c[0])||void 0===e?void 0:e.id})}),[c,t]);return Object(we.jsx)(Wt,{title:"Notifications",children:Object(we.jsx)(Ee,{children:Object(we.jsx)(wt.a,{spinning:r,children:Object(we.jsx)(on.a,{activeKey:t.get("branchId"),type:"card",onTabClick:function(e){n({branchId:e})},children:c.map((function(e){var t=e.name,n=e.id;return Object(we.jsx)(on.a.TabPane,{tab:t,children:Object(we.jsx)(Ln,{})},n)}))})})})})},Fn=(n(209),[{title:"ID",dataIndex:"id"},{title:"Date Created",dataIndex:"date_created"},{title:"Date Fulfilled",dataIndex:"date_fulfilled"},{title:"Status",dataIndex:"status",align:"center"},{title:"Actions",dataIndex:"actions"}]),Vn=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ve.c)(),c=Object(Se.a)(r,1)[0],i=Object(xe.g)(),s=ct().setSearchParams,l=ut({params:{page:c.get("page"),pageSize:c.get("pageSize")}}),o=l.isFetching,d=l.data,u=d.total,b=d.preorders;return Object(ue.useEffect)((function(){var e=b.map((function(e){return{key:e.id,id:e.id,date_created:Mt(e.datetime_created),date_fulfilled:Mt(e.datetime_fulfilled),status:Object(we.jsx)(Ht,{status:e.status}),actions:Object(we.jsx)(Ie.a,{type:"link",onClick:function(){i("/preorders/".concat(e.id))},children:"View"})}}));a(e)}),[b]),Object(we.jsx)(Wt,{className:"Preorders",title:"Preorders",children:Object(we.jsxs)(Ee,{children:[Object(we.jsx)(tn.a,{className:"Preorders_createRow",justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsxs)(Ie.a,{size:"large",type:"primary",onClick:function(){i("create")},children:[Object(we.jsx)($t.a,{})," Create Preorder"]})})}),Object(we.jsx)(an.a,{columns:Fn,dataSource:n,loading:o,pagination:{current:c.get("page")||1,total:u,pageSize:c.get("pageSize")||10,onChange:function(e,t){s({page:e,pageSize:t})},disabled:0===b.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:800}})]})})},qn="ALL",Bn="SELECTED",Mn=function(e){var t=e.branches,n=e.suppliers,a=e.values,r=e.onSetFieldValue,c=Object(ue.useState)(!1),i=Object(Se.a)(c,2),s=i[0],l=i[1];return Object(we.jsx)(Ee,{children:Object(we.jsxs)(tn.a,{gutter:[15,15],children:[Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Branch Destination"}),Object(we.jsx)(un.a,{style:{width:"100%"},value:a.branchId,onChange:function(e){r("branchId",e)},children:t.map((function(e){return Object(we.jsx)(un.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(we.jsx)(Dt,{name:"branchId"})]}),Object(we.jsxs)(nn.a,{sm:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Delivery Type"}),Object(we.jsxs)(un.a,{style:{width:"100%"},value:a.deliveryType,onChange:function(e){r("deliveryType",e)},children:[Object(we.jsx)(un.a.Option,{value:K,children:"Delivery"},K),Object(we.jsx)(un.a.Option,{value:G,children:"Pickup"},G)]}),Object(we.jsx)(Dt,{name:"deliveryType"})]}),Object(we.jsx)(nn.a,{span:24,children:Object(we.jsx)(gn.a,{children:"Supplier"})}),Object(we.jsxs)(nn.a,{md:12,xs:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Supplier's Name"}),Object(we.jsx)(un.a,{mode:"tags",style:{width:"100%"},value:null!==a.supplierName?[a.supplierName]:[],onDeselect:function(){r("supplierName",null),r("supplierAddress",null),r("supplierLandline",null),r("supplierPhone",null),r("supplierDescription",null)},onSelect:function(e){var t=e;r("supplierName",t);var a=n.find((function(e){return e.name===t}));r("supplierAddress",(null===a||void 0===a?void 0:a.address)||""),r("supplierLandline",(null===a||void 0===a?void 0:a.landline)||""),r("supplierPhone",(null===a||void 0===a?void 0:a.phone)||""),r("supplierDescription",(null===a||void 0===a?void 0:a.description)||"")},children:n.map((function(e){return Object(we.jsx)(un.a.Option,{value:e.name,children:e.name},e.id)}))}),Object(we.jsx)(Dt,{name:"supplierName"})]}),Object(we.jsxs)(nn.a,{md:6,sm:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Supplier's Phone Number"}),Object(we.jsx)(_e.a,{value:a.supplierPhone,onChange:function(e){r("supplierPhone",e.target.value)}}),Object(we.jsx)(Dt,{name:"supplierPhone"})]}),Object(we.jsxs)(nn.a,{md:6,sm:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Supplier's Telephone Number"}),Object(we.jsx)(_e.a,{value:a.supplierLandline,onChange:function(e){r("supplierLandline",e.target.value)}}),Object(we.jsx)(Dt,{name:"supplierLandline"})]}),Object(we.jsxs)(nn.a,{span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Supplier's Address"}),Object(we.jsx)(_e.a,{value:a.supplierAddress,onChange:function(e){r("supplierAddress",e.target.value)}}),Object(we.jsx)(Dt,{name:"supplierAddress"})]}),Object(we.jsxs)(nn.a,{span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Supplier's Description"}),s?Object(we.jsxs)(_e.a.Group,{compact:!0,children:[Object(we.jsx)(_e.a,{style:{width:"calc(100% - 70px)"},value:a.supplierDescription,onChange:function(e){r("supplierDescription",e.target.value)}}),Object(we.jsx)(Ie.a,{type:"primary",onClick:function(){l(!1)},children:"Save"})]}):Object(we.jsx)(yn.a,{action:Object(we.jsx)(Ie.a,{size:"small",type:"link",onClick:function(){l(!0)},children:"Edit"}),description:a.supplierDescription,type:"info",showIcon:!0}),Object(we.jsx)(Dt,{name:"supplierDescription"})]})]})})},Yn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(ue.useState)(1),r=Object(Se.a)(a,2),c=r[0],i=r[1],s=Object(ue.useState)(10),l=Object(Se.a)(s,2),o=l[0],d=l[1],u=Object(ue.useState)(""),b=Object(Se.a)(u,2),j=b[0],p=(b[1],Object(ue.useState)("")),h=Object(Se.a)(p,2),O=h[0],m=(h[1],Object(ue.useState)([])),v=Object(Se.a)(m,2),x=v[0],f=v[1],g=at({params:{page:c,pageSize:o,branchId:t.branchId,search:j,status:O}}),y=g.isFetching,S=g.data,P=S.total,C=S.products;return Object(ue.useEffect)((function(){f(C.map((function(e){var a=t.preorderProducts.find((function(t){return t.productId===e.id}));return{key:e.id,name:Object(we.jsx)(Sn.a,{checked:a,onChange:function(a){var r=[];r=a.target.checked?[].concat(Object(dn.a)(t.preorderProducts),[{productId:e.id,productName:e.name,productStatus:e.status,productPrices:e.product_prices.map((function(e){return{branchProductId:e.branch_product_id,unitTypeId:e.unit_type_id,quantity:0}}))}]):t.preorderProducts.filter((function(t){return t.productId!==e.id})),n("preorderProducts",r)},children:e.name}),status:Object(we.jsx)(It,{status:e.status})}})))}),[C,t]),Object(ue.useEffect)((function(){f([]),n("preorderProducts",[])}),[t.branchId]),Object(we.jsx)(an.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}],dataSource:x,loading:y,pagination:{current:c,total:P,pageSize:o,onChange:function(e,t){i(e),d(t)},disabled:y,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key"})},Gn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(ue.useState)([]),r=Object(Se.a)(a,2),c=r[0],i=r[1],s=mt(),l=s.isFetching,o=s.data;Object(ue.useEffect)((function(){i(t.preorderProducts.map((function(e,a){var r={key:e.productId,name:Object(we.jsx)(Sn.a,{checked:!0,onChange:function(){n("preorderProducts",t.preorderProducts.filter((function(t){return t.productId!==e.productId})))},children:e.productName}),status:Object(we.jsx)(It,{status:e.productStatus})};return e.productPrices.forEach((function(e,t){r[String(e.unitTypeId)]=Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(_e.a,{style:{textAlign:"center"},type:"number",onChange:function(e){n("preorderProducts.".concat(a,".productPrices.").concat(t,".quantity"),Number(e.target.value))}}),Object(we.jsx)(Dt,{name:"preorderProducts.".concat(a,".productPrices.").concat(t,".quantity")})]})})),r})))}),[t,o]);var d=Object(ue.useCallback)((function(){var e,n=Object(Lt.flatten)(null===t||void 0===t||null===(e=t.preorderProducts)||void 0===e?void 0:e.map((function(e){return e.productPrices.map((function(e){return e.unitTypeId}))}))),a=o.filter((function(e){return n.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(dn.a)(a.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Status",dataIndex:"status"}])}),[t,o]);return Object(we.jsx)(an.a,{columns:d(),dataSource:c,loading:l,pagination:!1,rowKey:"key"})},Kn=function(){var e=Object(ue.useState)(!1),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(xe.g)(),c=nt(),i=c.isFetching,s=c.data,l=rt({params:{type:_}}),o=l.isFetching,d=l.data,u={defaultValues:{branchId:null,deliveryType:null,supplierName:null,supplierAddress:null,supplierLandline:null,supplierPhone:null,supplierDescription:null,preorderProducts:[]},schema:vt.c().shape({branchId:vt.d().required().label("Branch").nullable(),deliveryType:vt.d().required().label("Delivery Type").nullable(),supplierName:vt.d().required().label("Supplier Name").nullable(),supplierAddress:vt.d().required().label("Supplier Address").nullable(),supplierLandline:vt.d().label("Supplier Telephone").nullable(),supplierPhone:vt.d().label("Supplier Phone").nullable(),supplierDescription:vt.d().label("Supplier Description").nullable(),preorderProducts:vt.a().of(vt.c().shape({productId:vt.b().required(),productName:vt.d().required(),productStatus:vt.d().required(),productPrices:vt.a().of(vt.c().shape({branchProductId:vt.b().required().label("Product"),unitTypeId:vt.b().required(),quantity:vt.b().required().min(0,"Must not be negative").label("Quantity")}))}))})},b=function(e){rn.a.success({title:"Success",content:"Preorder is successfully created. Press the button below to go back to the preorders screen.",keyboard:!1,okText:"View Preorder",onOk:function(){r("/preorders/".concat(e))}})};return Object(we.jsx)(Wt,{title:"Create Preorder",children:Object(we.jsx)(wt.a,{spinning:i||o,children:Object(we.jsx)(ze.c,{initialValues:u.defaultValues,validationSchema:u.schema,onSubmit:function(){var e=Object(ye.a)(ge.a.mark((function e(t,n){var r,c,i,s,l;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.setFieldError,a(!0),!(t.preorderProducts.length>0)){e.next=23;break}if(e.prev=3,c=d.find((function(e){return e.name===t.supplierName})),!((i=Object(Lt.flatten)(t.preorderProducts.map((function(e){return e.productPrices.filter((function(e){return e.quantity>0})).map((function(e){return{branch_product_id:e.branchProductId,quantity:e.quantity}}))})))).length>0)){e.next=14;break}return e.next=9,Qe.create({body:{branch_id:t.branchId,delivery_type:t.deliveryType,supplier:{id:null===c||void 0===c?void 0:c.id,name:t.supplierName,description:t.supplierDescription,address:t.supplierAddress,landline:t.supplierLandline,phone:t.supplierPhone},preorder_products:i}});case 9:s=e.sent,l=s.data,b(l.id),e.next=15;break;case 14:xn.b.error("Please add quantity to products first");case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),console.error(e.t0),r("response",S);case 21:e.next=24;break;case 23:xn.b.error("Please add a product first");case 24:a(!1);case 25:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,a=e.setFieldValue;return Object(we.jsx)(ze.b,{style:{width:"100%"},children:Object(we.jsxs)(wt.a,{spinning:n,children:[Object(we.jsx)(Mn,{branches:s,suppliers:d,values:t,onSetFieldValue:a}),null!==t.branchId&&Object(we.jsx)(Ee,{children:Object(we.jsxs)(on.a,{defaultActiveKey:qn,size:"large",type:"card",children:[Object(we.jsx)(on.a.TabPane,{tab:"All",children:Object(we.jsx)(Yn,{values:t,onSetFieldValue:a})},qn),Object(we.jsx)(on.a.TabPane,{tab:"Selected Products (".concat(t.preorderProducts.length,")"),children:Object(we.jsx)(Gn,{values:t,onSetFieldValue:a})},Bn)]})}),Object(we.jsx)(Ee,{children:Object(we.jsx)(tn.a,{justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsx)(Ie.a,{htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})})]})})}})})})},Un=function(e){var t=e.preorder,n=e.preorderProducts,a=e.columns,r=e.onSuccess,c=e.onClose,i=Object(ue.useState)(!1),s=Object(Se.a)(i,2),l=s[0],o=s[1],d=Object(ue.useState)([]),u=Object(Se.a)(d,2),b=u[0],j=u[1],p=Object(ue.useState)([]),h=Object(Se.a)(p,2),O=h[0],m=h[1],v=Object(ue.useRef)();Object(ue.useEffect)((function(){var e=[],t=0;j(Object.keys(n).map((function(a){var r={key:a,name:a};return n[a].forEach((function(n){var a=n.branch_product.product_price.unit_type,c="".concat(t,".quantity");r[String(a)]=Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(_e.a,{style:{textAlign:"center"},type:"number",onChange:function(e){v.current.setFieldValue(c,Number(e.target.value))}}),Object(we.jsx)(Dt,{name:c})]}),e.push({preorderProductId:n.id,quantity:""}),t++})),r}))),m(e)}),[n]);var x=Object(ue.useCallback)((function(){return{defaultValues:O,schema:vt.a().of(vt.c().shape({preorderProductId:vt.b().required(),quantity:vt.b().required("Required")}))}}),[O]);return Object(we.jsx)(rn.a,{footer:[Object(we.jsx)(Ie.a,{disabled:l,size:"large",onClick:c,children:"Cancel"},"btnCancel"),Object(we.jsx)(Ie.a,{loading:l,size:"large",type:"primary",onClick:function(){v.current.submitForm()},children:"Submit"},"btnSubmit")],title:"[Create] Preorder Transaction",width:800,centered:!0,closable:!0,visible:!0,onCancel:c,children:Object(we.jsx)(ze.c,{initialValues:x().defaultValues,innerRef:v,validationSchema:x().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(ye.a)(ge.a.mark((function e(n){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,He.create({body:{preorder_id:t.id,preorder_transaction_products:n.map((function(e){return{preorder_product_id:e.preorderProductId,quantity:e.quantity}}))}});case 4:r(),c(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),xn.b.error(S);case 11:return e.prev=11,o(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),children:Object(we.jsx)(ze.b,{children:Object(we.jsx)(an.a,{columns:a,dataSource:b,loading:l,pagination:!1,rowKey:"key",scroll:{x:600}})})})})},Wn=function(e){var t=e.preorderTransaction,n=e.unitTypes,a=e.onClose,r=Object(ue.useState)([]),c=Object(Se.a)(r,2),i=c[0],s=c[1],l=Object(ue.useState)([]),o=Object(Se.a)(l,2),d=o[0],u=o[1];Object(ue.useEffect)((function(){var e={};t.preorder_transaction_products.forEach((function(t){var n=t.product_name;void 0===e[n]&&(e[n]=[]),e[n].push(t)}));var n=[];u(Object.keys(e).map((function(t){var a={key:t,name:t};return e[t].forEach((function(e){var t=e.unit_type_id;n.push(t),a[String(t)]=Number(e.quantity)})),a}))),s(n)}),[t]);var b=Object(ue.useCallback)((function(){var e=n.filter((function(e){return i.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(dn.a)(e.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))))}),[i,n]);return Object(we.jsxs)(rn.a,{footer:[Object(we.jsx)(Ie.a,{size:"large",onClick:a,children:"Close"},"btnCancel")],title:"Preorder Transaction",width:800,centered:!0,closable:!0,visible:!0,onCancel:a,children:[Object(we.jsxs)(Dn.b,{column:1,labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(we.jsx)(Dn.b.Item,{label:"ID",children:t.id}),Object(we.jsxs)(Dn.b.Item,{label:"Received By",children:[t.user.first_name," ",t.user.last_name]}),Object(we.jsx)(Dn.b.Item,{label:"Date Created",children:Mt(t.datetime_created)})]}),Object(we.jsx)(gn.a,{}),Object(we.jsx)(an.a,{columns:b(),dataSource:d,pagination:!1,rowKey:"key",scroll:{x:600}})]})},Qn=[{title:"ID",dataIndex:"id"},{title:"Date Created",dataIndex:"datetime_created"},{title:"Received By",dataIndex:"received_by"},{title:"Action",dataIndex:"actions"}],Hn=function(){var e,t,n,a,r,c,i,s,l,o=Object(ue.useState)(!1),d=Object(Se.a)(o,2),u=d[0],b=d[1],j=Object(ue.useState)(!1),p=Object(Se.a)(j,2),h=p[0],O=p[1],m=Object(ue.useState)([]),v=Object(Se.a)(m,2),x=v[0],f=v[1],g=Object(ue.useState)({}),y=Object(Se.a)(g,2),C=y[0],k=y[1],_=Object(ue.useState)([]),T=Object(Se.a)(_,2),I=T[0],A=T[1],D=Object(ue.useState)(!1),N=Object(Se.a)(D,2),w=N[0],E=N[1],z=Object(ue.useState)([]),L=Object(Se.a)(z,2),R=L[0],V=L[1],q=Object(ue.useState)(null),B=Object(Se.a)(q,2),M=B[0],Y=B[1],G=Object(xe.h)(),K=mt(),U=K.isFetching,W=K.data,Q=dt({id:G.preorderId}),H=Q.isFetching,X=Q.data,Z=Q.refetch;Object(ue.useEffect)((function(){var e={};null===X||void 0===X||X.preorder_products.forEach((function(t){var n=t.branch_product.product_price.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)})),k(e);var t=[];f(Object.keys(e).map((function(n){var a={key:n,name:n};return e[n].forEach((function(e){var n=e.branch_product.product_price.unit_type;t.push(n),a[String(n)]="\n          ".concat(Number(e.fulfilled_quantity)," / ").concat(Number(e.quantity))})),a}))),A(t)}),[X]),Object(ue.useEffect)((function(){(null===X||void 0===X?void 0:X.preorder_transactions)&&V(X.preorder_transactions.map((function(e){return{row:e.id,id:e.id,datetime_created:Mt(e.datetime_created),received_by:"".concat(e.user.first_name," ").concat(e.user.last_name),actions:Object(we.jsx)(Ie.a,{type:"link",onClick:function(){Y(e)},children:"View"})}})))}),[X]);var J=Object(ue.useCallback)((function(){var e=W.filter((function(e){return I.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(dn.a)(e.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))))}),[I,W]),$=function(e){b(!0),Qe.edit({id:G.preorderId,body:{status:e}}).then(Z).catch((function(e){console.error(e),xn.b.error(S)})).finally((function(){b(!1)}))};return Object(we.jsx)(Wt,{className:"ViewPreorder",title:"Preorder",children:Object(we.jsxs)(wt.a,{spinning:H||U||u,children:[Object(we.jsxs)(Ee,{children:[Object(we.jsxs)(tn.a,{className:"ViewPreorder_setPreorderAsComplete",gutter:[25,12],justify:"space-between",children:[Object(we.jsx)(nn.a,{sm:12,xs:24,children:Object(we.jsx)(Ie.a,{loading:h,size:"large",type:"primary",ghost:!0,onClick:function(){X?(O(!0),new Nn.a("p","pt","a4").html(function(e,t){var n,a,r,c,i,s,l,o=e.preorder_products.map((function(e){var n=t.find((function(t){return t.id===e.unit_type_id})).name;return{name:"".concat(e.product_name," (").concat(n,")"),quantity:e.quantity}}));return'\n\t\t<div style="width: 430pt; font-family: Verdana, Geneva, Tahoma, sans-serif; font-size: 10pt; line-height: 100%">\n\t\t\t<div style="text-align: center;">\n\t\t\t\t\t<div style="font-size: 15pt;">Marigold Store</div>\n\t\t\t\t\t<div>[ORDER SLIP]</div>\n\t\t\t</div>\n\n\t\t\t<br />\n\n\t\t\t<table style="width: 100%;">\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Order ID:</td>\n\t\t\t\t\t<td>'.concat(e.id,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Created By:</td>\n\t\t\t\t\t<td>').concat(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.first_name," ").concat(null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.last_name,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Delivery Type:</td>\n\t\t\t\t\t<td>').concat(Object(Lt.upperFirst)(null===e||void 0===e?void 0:e.delivery_type),'</td>\n\t\t\t\t</tr>\n                <tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Datetime Created:</td>\n\t\t\t\t\t<td>').concat(Mt(null===e||void 0===e?void 0:e.datetime_created),'</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<br />\n\n            <table style="width: 100%;">\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Supplier Name:</td>\n\t\t\t\t\t<td>').concat(null===e||void 0===e||null===(r=e.supplier)||void 0===r?void 0:r.name,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n                    <td style="width: 200pt; font-weight: bold;">Supplier Phone:</td>\n                    <td>').concat((null===e||void 0===e||null===(c=e.supplier)||void 0===c?void 0:c.phone)||"",'</td>\n\t\t\t\t<tr>\n\t\t\t\t<tr>\n                    <td style="width: 200pt; font-weight: bold;">Supplier Telephone:</td>\n                    <td>').concat((null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.landline)||"",'</td>\n\t\t\t\t<tr>\n                <tr>\n                    <td style="width: 200pt; font-weight: bold;">Supplier Address:</td>\n                    <td>').concat(null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.address,'</td>\n\t\t\t\t<tr>\n                <tr>\n                    <td style="width: 200pt; font-weight: bold;">Supplier Description:</td>\n                    <td>').concat(null===e||void 0===e||null===(l=e.supplier)||void 0===l?void 0:l.description,'</td>\n\t\t\t\t<tr>\n\t\t\t</table>\n\n\t\t\t<br />\n\n\t\t\t<table style="width: 100%;">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th style="text-align: left">Name</th>\n\t\t\t\t\t\t<th style="text-align: center">Quantity</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>  \n\t\t\t\t<tbody>\n\t\t\t\t\t').concat(o.map((function(e){return'\t\n                        <tr>\n                            <td style="width: 200pt;">'.concat(e.name,'</td>\n                            <td style="text-align: center">').concat(e.quantity,"</td>\n                        </tr>")})).join(""),"\n\t\t\t\t</tbody>\n\t\t\t</table>\t\t\t\n\t\t</div>\n\t")}(X,W),{x:10,y:10,filename:"Preorder_".concat(X.id),callback:function(e){window.open(e.output("bloburl").toString()),O(!1)}})):xn.b.error(S)},children:"Print Preorder"})}),(null===X||void 0===X?void 0:X.status)===F.APPROVED&&(null===X||void 0===X||null===(e=X.preorder_transactions)||void 0===e?void 0:e.length)>0&&Object(we.jsx)(nn.a,{sm:12,xs:24,children:Object(we.jsx)(Ie.a,{className:"ViewPreorder_setPreorderAsComplete_button",size:"large",type:"primary",onClick:function(){$(F.DELIVERED)},children:"Set Preorder As Complete"})})]}),Object(we.jsxs)(Dn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(we.jsx)(Dn.b.Item,{label:"ID",span:2,children:null===X||void 0===X?void 0:X.id}),Object(we.jsx)(Dn.b.Item,{label:"Branch",children:null===X||void 0===X||null===(t=X.branch)||void 0===t?void 0:t.name}),Object(we.jsx)(Dn.b.Item,{label:"Delivery Type",children:Object(Lt.upperFirst)(null===X||void 0===X?void 0:X.delivery_type)}),Object(we.jsxs)(Dn.b.Item,{label:"Created By",children:[null===X||void 0===X||null===(n=X.user)||void 0===n?void 0:n.first_name," ",null===X||void 0===X||null===(a=X.user)||void 0===a?void 0:a.last_name]}),Object(we.jsx)(Dn.b.Item,{label:"Datetime Created",children:Mt(null===X||void 0===X?void 0:X.datetime_created)}),Object(we.jsx)(Dn.b.Item,{label:"Datetime Fulfilled",children:Mt(null===X||void 0===X?void 0:X.datetime_fulfilled)}),Object(we.jsx)(Dn.b.Item,{label:"Status",children:Object(we.jsx)(Ht,{status:null===X||void 0===X?void 0:X.status})})]}),Object(we.jsx)(gn.a,{}),Object(we.jsxs)(Dn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Supplier",bordered:!0,children:[Object(we.jsx)(Dn.b.Item,{label:"Name",span:2,children:null===X||void 0===X||null===(r=X.supplier)||void 0===r?void 0:r.name}),Object(we.jsx)(Dn.b.Item,{label:"Phone",children:(null===X||void 0===X||null===(c=X.supplier)||void 0===c?void 0:c.phone)||P}),Object(we.jsx)(Dn.b.Item,{label:"Telephone",children:(null===X||void 0===X||null===(i=X.supplier)||void 0===i?void 0:i.landline)||P}),Object(we.jsx)(Dn.b.Item,{label:"Address",span:2,children:null===X||void 0===X||null===(s=X.supplier)||void 0===s?void 0:s.address}),Object(we.jsx)(Dn.b.Item,{label:"Description",span:2,children:null===X||void 0===X||null===(l=X.supplier)||void 0===l?void 0:l.description})]}),Object(we.jsx)(gn.a,{}),Object(we.jsx)(an.a,{columns:J(),dataSource:x,pagination:!1,rowKey:"key",scroll:{x:800}}),(null===X||void 0===X?void 0:X.status)===F.PENDING&&Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(gn.a,{}),Object(we.jsxs)(tn.a,{gutter:[25,12],children:[Object(we.jsx)(nn.a,{sm:12,xs:24,children:Object(we.jsx)(Ie.a,{size:"large",block:!0,danger:!0,onClick:function(){$(F.CANCELLED)},children:"Cancel Preorder"})}),Object(we.jsx)(nn.a,{sm:12,xs:24,children:Object(we.jsx)(Ie.a,{size:"large",type:"primary",block:!0,onClick:function(){$(F.APPROVED)},children:"Approve Preorder"})})]})]})]}),[F.APPROVED,F.DELIVERED].includes(null===X||void 0===X?void 0:X.status)&&Object(we.jsxs)(Ee,{children:[Object(we.jsxs)(tn.a,{className:"ViewPreorder_transaction_createRow",justify:"space-between",children:[Object(we.jsx)(nn.a,{children:Object(we.jsx)(Te.a.Title,{level:4,children:"Transactions"})}),(null===X||void 0===X?void 0:X.status)===F.APPROVED&&Object(we.jsx)(nn.a,{children:Object(we.jsxs)(Ie.a,{size:"large",type:"primary",onClick:function(){E(!0)},children:[Object(we.jsx)($t.a,{})," Create Transaction"]})})]}),Object(we.jsx)(an.a,{columns:Qn,dataSource:R,pagination:!1,rowKey:"key",scroll:{x:800}})]}),w&&Object(we.jsx)(Un,{columns:J(),preorder:X,preorderProducts:C,onClose:function(){E(!1)},onSuccess:function(){Z(),E(!1)}}),M&&Object(we.jsx)(Wn,{preorderTransaction:M,unitTypes:W,onClose:function(){Y(null)}})]})})},Xn=n(191),Zn=(n(251),n(449)),Jn=function(e){var t,n=e.product,a=e.unitTypes,r=e.onClose;return Object(we.jsxs)(rn.a,{className:"ViewProductModal Modal__large Modal__hasFooter",footer:[Object(we.jsx)(Ie.a,{onClick:r,children:"Close"})],title:"View Product",centered:!0,closable:!0,visible:!0,onCancel:r,children:[Object(we.jsxs)(tn.a,{gutter:[8,8],children:[Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Name: "})}),Object(we.jsx)(nn.a,{lg:12,children:n.name}),Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Unit Cost: "})}),Object(we.jsx)(nn.a,{lg:12,children:Bt(n.unit_cost)}),Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Vat Type: "})}),Object(we.jsx)(nn.a,{lg:12,children:Object(Lt.upperCase)(n.vat_type)})]}),Object(we.jsx)(gn.a,{}),Object(we.jsx)(Zn.a,{children:null===n||void 0===n||null===(t=n.product_prices)||void 0===t?void 0:t.map((function(e){var t=a.find((function(t){return t.id===e.unit_type_id})).name||"";return Object(we.jsx)(Zn.a.Panel,{header:t,children:Object(we.jsxs)(tn.a,{gutter:[8,8],children:[Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price Market: "})}),Object(we.jsx)(nn.a,{lg:12,children:Bt(e.price_market)}),Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price Delivery: "})}),Object(we.jsx)(nn.a,{lg:12,children:Bt(e.price_delivery)}),Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price Pickup: "})}),Object(we.jsx)(nn.a,{lg:12,children:Bt(e.price_pickup)}),Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price Special: "})}),Object(we.jsx)(nn.a,{lg:12,children:Bt(e.price_special)}),Object(we.jsx)(nn.a,{lg:12,children:Object(we.jsx)(Te.a.Text,{strong:!0,children:"Reorder Point: "})}),Object(we.jsx)(nn.a,{lg:12,children:e.reorder_point})]})},String(e.id))}))})]})},$n=function(e){var t=e.onSetPriceType,n=Object(ve.c)(),a=Object(Se.a)(n,1)[0],r=ct().setSearchParams,c=Object(bn.a)((function(e){r({search:e})}),500);return Object(we.jsxs)(tn.a,{className:"Products_filter",gutter:[15,15],children:[Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Search"}),Object(we.jsx)(_e.a,{defaultValue:a.get("search"),allowClear:!0,onChange:function(e){return c(e.target.value.trim())}})]}),Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price Type"}),Object(we.jsx)(Xn.a.Group,{defaultValue:D,options:[{label:"Delivery",value:D},{label:"Market",value:N},{label:"Pickup",value:w},{label:"Special",value:E}],optionType:"button",style:{width:"100%"},onChange:function(e){t(e.target.value)}})]})]})},ea=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ue.useState)(D),c=Object(Se.a)(r,2),i=c[0],s=c[1],l=Object(ue.useState)(null),o=Object(Se.a)(l,2),d=o[0],u=o[1],b=Object(ue.useState)(!1),j=Object(Se.a)(b,2),p=j[0],h=j[1],O=Object(ve.c)(),m=Object(Se.a)(O,1)[0],v=Object(xe.g)(),x=ct().setSearchParams,f=mt(),g=f.isFetching,y=f.data,P=jt({params:{page:m.get("page"),pageSize:m.get("pageSize"),search:m.get("search")}}),C=P.isFetching,k=P.data,_=k.total,T=k.products,I=P.refetch;Object(ue.useEffect)((function(){var e=T.map((function(e){var t={key:e.id,name:Object(we.jsx)(Ie.a,{className:"Products_productName",type:"link",onClick:function(){u(e)},children:e.name}),unitCost:Bt(e.unit_cost),actions:Object(we.jsxs)(ke.b,{size:"small",children:[Object(we.jsx)(Ie.a,{type:"link",onClick:function(){v("/products/".concat(e.id))},children:"Edit"}),Object(we.jsx)(en.a,{cancelText:"Cancel",okButtonProps:{danger:!0},okText:"Delete",placement:"topLeft",title:"Are you sure you want to delete ".concat(e.name,"?"),onConfirm:function(){var t;t=e.id,h(!0),Ze.delete(t).then((function(){I()})).catch((function(){xn.b.error(S)})).finally((function(){h(!1)}))},children:Object(we.jsx)(Ie.a,{type:"link",danger:!0,children:"Delete"})})]})};return e.product_prices.forEach((function(e){t[String(e.unit_type_id)]=Bt(e["price_".concat(i)])})),t}));a(e)}),[T,i]);var A=Object(ue.useCallback)((function(){var e=Object(Lt.flatten)(null===T||void 0===T?void 0:T.map((function(e){return e.product_prices.map((function(e){return e.unit_type_id}))}))),t=y.filter((function(t){return e.includes(t.id)}));return[{title:"Name",dataIndex:"name",width:150,fixed:"left"},{title:"Unit Cost",dataIndex:"unitCost"}].concat(Object(dn.a)(t.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))),[{title:"Actions",dataIndex:"actions"}])}),[T,y]);return Object(we.jsxs)(Wt,{className:"Products",title:"Products",children:[Object(we.jsxs)(Ee,{children:[Object(we.jsx)(tn.a,{className:"Products_createRow",justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsxs)(Ie.a,{size:"large",type:"primary",onClick:function(){v("create")},children:[Object(we.jsx)($t.a,{})," Create Product"]})})}),Object(we.jsx)($n,{onSetPriceType:s}),Object(we.jsx)(an.a,{columns:A(),dataSource:n,loading:C||g||p,pagination:{current:m.get("page")||1,total:_,pageSize:m.get("pageSize")||10,onChange:function(e,t){x({page:e,pageSize:t})},disabled:0===T.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:800}})]}),d&&Object(we.jsx)(Jn,{product:d,unitTypes:y,onClose:function(){u(null)}})]})},ta=n(69),na=function(e){var t=e.index,n=e.isCreate,a=e.unitTypes,r=e.values,c=e.onRemoveProductPrice,i=e.onSetFieldValue;return Object(we.jsxs)(tn.a,{gutter:[4,4],children:[Object(we.jsxs)(nn.a,{sm:6,xs:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price (Market)"}),Object(we.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.priceMarket,onChange:function(e){i("productPrices.".concat(t,".priceMarket"),e.target.value)}}),Object(we.jsx)(ze.a,{name:"productPrices.".concat(t,".priceMarket"),render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{sm:6,xs:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price (Delivery)"}),Object(we.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.priceDelivery,onChange:function(e){i("productPrices.".concat(t,".priceDelivery"),e.target.value)}}),Object(we.jsx)(ze.a,{name:"productPrices.".concat(t,".priceDelivery"),render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{sm:6,xs:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price (Pickup)"}),Object(we.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.pricePickup,onChange:function(e){i("productPrices.".concat(t,".pricePickup"),e.target.value)}}),Object(we.jsx)(ze.a,{name:"productPrices.".concat(t,".pricePickup"),render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{sm:6,xs:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Price (Special)"}),Object(we.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.priceSpecial,onChange:function(e){i("productPrices.".concat(t,".priceSpecial"),e.target.value)}}),Object(we.jsx)(ze.a,{name:"productPrices.".concat(t,".priceSpecial"),render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{sm:6,xs:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Reorder Point"}),Object(we.jsx)(_e.a,{type:"number",value:r.reorderPoint,onChange:function(e){i("productPrices.".concat(t,".reorderPoint"),e.target.value)}}),Object(we.jsx)(ze.a,{name:"productPrices.".concat(t,".reorderPoint"),render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{sm:6,xs:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Unit Type"}),Object(we.jsx)(un.a,{filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},optionFilterProp:"children",style:{width:"100%"},value:r.unitType,showSearch:!0,onChange:function(e){i("productPrices.".concat(t,".unitType"),e)},children:a.map((function(e){return Object(we.jsx)(un.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(we.jsx)(ze.a,{name:"productPrices.".concat(t,".unitType"),render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),n&&Object(we.jsx)(nn.a,{sm:12,xs:24,children:Object(we.jsx)(tn.a,{align:"middle",justify:"center",style:{height:"100%"},children:Object(we.jsx)(nn.a,{children:Object(we.jsxs)(Ie.a,{htmlType:"button",type:"dashed",danger:!0,onClick:c,children:[Object(we.jsx)(ta.a,{})," DELETE PRICE"]})})})})]})},aa=function(){var e=Object(ue.useState)(!1),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(xe.h)(),c=Object(xe.g)(),i=mt(),s=i.isFetching,l=i.data,o=bt({id:r.productId}),d=o.isFetching,u=o.data,b=void 0===r.productId,j=Object(ue.useCallback)((function(){return{defaultValues:{id:null===u||void 0===u?void 0:u.id,name:(null===u||void 0===u?void 0:u.name)||"",unitCost:(null===u||void 0===u?void 0:u.unit_cost)||"",vatType:(null===u||void 0===u?void 0:u.vat_type)||"",productPrices:(null===u||void 0===u?void 0:u.product_prices.map((function(e){return{id:e.id,priceMarket:Number(e.price_market),priceDelivery:Number(e.price_delivery),pricePickup:Number(e.price_pickup),priceSpecial:Number(e.price_special),reorderPoint:Number(e.reorder_point),unitType:e.unit_type_id}})))||[]},schema:vt.c().shape({name:vt.d().required().label("Name"),unitCost:vt.d().required().label("Unit Cost"),vatType:vt.d().required().label("VAT"),productPrices:vt.a().of(vt.c().shape({priceMarket:vt.b().positive("Must be greater than zero").required("Required"),priceDelivery:vt.b().positive("Must be greater than zero").required("Required"),pricePickup:vt.b().positive("Must be greater than zero").required("Required"),priceSpecial:vt.b().positive("Must be greater than zero").required("Required"),reorderPoint:vt.b(),unitType:vt.d().required("Required")}))})}}),[u]),p=function(e){var t=b?"created":"updated";rn.a.success({title:"Success",content:"".concat(e.name," is successfully ").concat(t,". Press the button below to go back to the products screen."),keyboard:!1,okText:"Proceed",onOk:function(){c("/products")}})};return Object(we.jsx)(Wt,{title:"Products",children:Object(we.jsx)(wt.a,{spinning:s||d||n,children:Object(we.jsx)(Ee,{children:Object(we.jsx)(ze.c,{initialValues:j().defaultValues,validationSchema:j().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(ye.a)(ge.a.mark((function e(t,n){var r,c,i,s;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.setFieldError,a(!0),!(t.productPrices.length>0)){e.next=18;break}return e.prev=3,c=b?Ze.create:Ze.edit,e.next=7,c({id:t.id,body:{name:t.name,unit_cost:t.unitCost,vat_type:t.vatType,product_prices:t.productPrices.map((function(e){return{id:e.id,unit_type_id:e.unitType,price_market:e.priceMarket,price_delivery:e.priceDelivery,price_pickup:e.pricePickup,price_special:e.priceSpecial,reorder_point:e.reorderPoint||0}}))}});case 7:i=e.sent,s=i.data,p(s),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0),r("response",S);case 16:e.next=19;break;case 18:xn.b.error("Please add a product price first");case 19:a(!1);case 20:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(we.jsxs)(ze.b,{style:{width:"100%"},children:[Object(we.jsx)(ze.a,{name:"response",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}}),Object(we.jsxs)(tn.a,{gutter:[24,24],children:[Object(we.jsxs)(nn.a,{lg:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Name"}),Object(we.jsx)(_e.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(we.jsx)(ze.a,{name:"name",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{lg:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Unit Cost"}),Object(we.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:t.unitCost,onChange:function(e){n("unitCost",e.target.value)}}),Object(we.jsx)(ze.a,{name:"unitCost",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]}),Object(we.jsxs)(nn.a,{lg:12,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"VAT"}),Object(we.jsx)(Xn.a.Group,{buttonStyle:"solid",options:[{label:"VAT",value:I},{label:"VAT-Exempted",value:A}],optionType:"button",style:{width:"100%"},value:t.vatType,onChange:function(e){n("vatType",e.target.value)}}),Object(we.jsx)(ze.a,{name:"vatType",render:function(e){return Object(we.jsx)(Te.a.Text,{type:"danger",children:e})}})]})]}),Object(we.jsx)(gn.a,{children:"PRICES"}),Object(we.jsxs)(tn.a,{gutter:[16,32],children:[t.productPrices.map((function(e,a){return Object(we.jsx)(nn.a,{span:24,children:Object(we.jsx)(na,{index:a,isCreate:b,unitTypes:l,values:e,onRemoveProductPrice:function(){n("productPrices",function(e,t){return t.productPrices.filter((function(t,n){return n!==e}))}(a,t))},onSetFieldValue:n})},a)})),Object(we.jsx)(nn.a,{span:24,children:Object(we.jsxs)(Ie.a,{className:"ModifyProduct_btnAddPrice",htmlType:"button",size:"large",type:"primary",ghost:!0,onClick:function(){n("productPrices",function(e){return[].concat(Object(dn.a)(e.productPrices),[{priceMarket:"",priceDelivery:"",pricePickup:"",priceSpecial:"",reorderPoint:"",unitType:""}])}(t))},children:[Object(we.jsx)($t.a,{})," Add Price"]})})]}),Object(we.jsx)(gn.a,{}),Object(we.jsx)(tn.a,{justify:"end",children:Object(we.jsx)(nn.a,{children:Object(we.jsx)(Ie.a,{className:"ModifyProduct_btnSubmit",htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})]})}})})})})},ra=[{title:"Rank",dataIndex:"rank"},{title:"Name",dataIndex:"name"},{title:"Total Purchase",dataIndex:"total_purchase"}],ca=function(){var e,t,n,a=Object(ue.useState)(W.DAILY),r=Object(Se.a)(a,2),c=r[0],i=r[1],s=Object(ve.c)(),l=Object(Se.a)(s,1)[0],o=ct().setSearchParams,d=(null===(e=l.get("dateRange"))||void 0===e?void 0:e.toString())||W.DAILY;return Object(ue.useEffect)((function(){![W.DAILY,W.MONTHLY].includes(d)&&(null===d||void 0===d?void 0:d.indexOf(","))?i(W.DATE_RANGE):i(d)}),[d]),Object(we.jsx)(tn.a,{className:"Products_filter",gutter:[15,15],children:Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{style:{width:"100%",display:"block"},strong:!0,children:"Date Range"}),Object(we.jsx)(Xn.a.Group,{options:[{label:"Daily",value:W.DAILY},{label:"Monthly",value:W.MONTHLY},{label:"Select Date Range",value:W.DATE_RANGE}],optionType:"button",value:c,onChange:function(e){var t=e.target.value;i(t),t!==W.DATE_RANGE&&o({dateRange:t})}}),c===W.DATE_RANGE&&Object(we.jsx)(fn.a.RangePicker,{defaultPickerValue:2===(null===(t=d.split(","))||void 0===t?void 0:t.length)?[Ft()(d.split(",")[0]),Ft()(d.split(",")[1])]:void 0,defaultValue:2===(null===(n=d.split(","))||void 0===n?void 0:n.length)?[Ft()(d.split(",")[0]),Ft()(d.split(",")[1])]:void 0,format:"MM/DD/YY",onCalendarChange:function(e,t){(null===e||void 0===e?void 0:e[0])&&(null===e||void 0===e?void 0:e[1])&&o({dateRange:t.join(",")})}})]})})},ia=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ve.c)(),c=Object(Se.a)(r,1)[0],i=ct().setSearchParams,s=pt({params:{page:c.get("page"),pageSize:c.get("pageSize"),dateRange:c.get("dateRange")||W.DAILY}}),l=s.isFetching,o=s.data,d=o.total,u=o.customers;return Object(ue.useEffect)((function(){var e=c.get("page")||1,t=c.get("pageSize")||10,n=(Number(e)-1)*Number(t),r=u.map((function(e,t){var a=n+t+1;return{key:e.id,rank:Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(Zt,{rank:a})," ",Object(we.jsx)("span",{children:a})]}),name:e.name,total_purchase:Bt(e.total_purchase)}}));a(r)}),[u]),Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(ca,{}),Object(we.jsx)(an.a,{columns:ra,dataSource:n,loading:l,pagination:{current:c.get("page")||1,total:d,pageSize:c.get("pageSize")||10,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===u.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:800}})]})},sa=function(e){var t,n,a,r=e.branches,c=Object(ue.useState)(W.DAILY),i=Object(Se.a)(c,2),s=i[0],l=i[1],o=Object(ve.c)(),d=Object(Se.a)(o,1)[0],u=ct().setSearchParams,b=(null===(t=d.get("dateRange"))||void 0===t?void 0:t.toString())||W.DAILY;return Object(ue.useEffect)((function(){![W.DAILY,W.MONTHLY].includes(b)&&(null===b||void 0===b?void 0:b.indexOf(","))?l(W.DATE_RANGE):l(b)}),[b]),Object(we.jsxs)(tn.a,{className:"Products_filter",gutter:[15,15],children:[Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{strong:!0,children:"Branch"}),Object(we.jsx)(un.a,{style:{width:"100%"},value:Number(d.get("branchId"))||void 0,allowClear:!0,onChange:function(e){u({branchId:e})},children:r.map((function(e){return Object(we.jsx)(un.a.Option,{value:e.id,children:e.name},e.id)}))})]}),Object(we.jsxs)(nn.a,{lg:12,span:24,children:[Object(we.jsx)(Te.a.Text,{style:{width:"100%",display:"block"},strong:!0,children:"Date Range"}),Object(we.jsx)(Xn.a.Group,{options:[{label:"Daily",value:W.DAILY},{label:"Monthly",value:W.MONTHLY},{label:"Select Date Range",value:W.DATE_RANGE}],optionType:"button",value:s,onChange:function(e){var t=e.target.value;l(t),t!==W.DATE_RANGE&&u({dateRange:t})}}),s===W.DATE_RANGE&&Object(we.jsx)(fn.a.RangePicker,{defaultPickerValue:2===(null===(n=b.split(","))||void 0===n?void 0:n.length)?[Ft()(b.split(",")[0]),Ft()(b.split(",")[1])]:void 0,defaultValue:2===(null===(a=b.split(","))||void 0===a?void 0:a.length)?[Ft()(b.split(",")[0]),Ft()(b.split(",")[1])]:void 0,format:"MM/DD/YY",onCalendarChange:function(e,t){(null===e||void 0===e?void 0:e[0])&&(null===e||void 0===e?void 0:e[1])&&u({dateRange:t.join(",")})}})]})]})},la=function(){var e=Object(ue.useState)([]),t=Object(Se.a)(e,2),n=t[0],a=t[1],r=Object(ve.c)(),c=Object(Se.a)(r,1)[0],i=ct().setSearchParams,s=nt(),l=s.isFetching,o=s.data,d=ht({params:{page:c.get("page"),pageSize:c.get("pageSize"),branchId:c.get("branchId"),dateRange:c.get("dateRange")||W.DAILY}}),u=d.isFetching,b=d.data,j=b.total,p=b.products;Object(ue.useEffect)((function(){var e=c.get("page")||1,t=c.get("pageSize")||10,n=(Number(e)-1)*Number(t),r=p.map((function(e,t){var a=n+t+1,r={key:e.id,rank:Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(Zt,{rank:a})," ",Object(we.jsx)("span",{children:a})]}),name:e.name,total_sales:Bt(e.total_sales)};return e.product_prices.forEach((function(e){r[String(e.unit_type.id)]="".concat(Bt(e.total_sales)," - (").concat(e.total_quantity,")")})),r}));a(r)}),[p]);var h=Object(ue.useCallback)((function(){var e={};Object(Lt.flatten)(null===p||void 0===p?void 0:p.map((function(e){return e.product_prices.map((function(e){return e.unit_type}))}))).forEach((function(t){e[t.name]=t}));var t=Object.keys(e).sort().map((function(t){return{title:e[t].name,dataIndex:String(e[t].id)}}));return[{title:"Rank",dataIndex:"rank"},{title:"Name",dataIndex:"name"},{title:"Total Sales",dataIndex:"total_sales"}].concat(Object(dn.a)(t))}),[p]);return Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(sa,{branches:o}),Object(we.jsx)(an.a,{columns:h(),dataSource:n,loading:u||l,pagination:{current:c.get("page")||1,total:j,pageSize:c.get("pageSize")||10,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===p.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},rowKey:"key",scroll:{x:1250}})]})},oa=function(){var e=ct().setSearchParams;return Object(we.jsx)(Wt,{title:"Reports",children:Object(we.jsx)(Ee,{children:Object(we.jsxs)(on.a,{type:"card",destroyInactiveTabPane:!0,onTabClick:function(){e({},{shouldResetPage:!0})},children:[Object(we.jsx)(on.a.TabPane,{tab:"Customers",children:Object(we.jsx)(ia,{})},"customers"),Object(we.jsx)(on.a.TabPane,{tab:"Products",children:Object(we.jsx)(la,{})},"products")]})})})},da=function(){return Object(we.jsx)(ve.a,{children:Object(we.jsxs)(xe.d,{children:[Object(we.jsxs)(xe.b,{element:Object(we.jsx)(Jt,{}),path:"/",children:[Object(we.jsx)(xe.b,{element:Object(we.jsx)(hn,{}),path:"dashboard"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(ln,{}),path:"branches"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(ea,{}),path:"products"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(aa,{}),path:"products/create"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(aa,{}),path:"products/:productId"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(Vn,{}),path:"preorders"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(Hn,{}),path:"preorders/:preorderId"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(Kn,{}),path:"preorders/create"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(vn,{}),path:"deliveries"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(En,{}),path:"deliveries/:deliveryId"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(An,{}),path:"deliveries/create"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(oa,{}),path:"reports"}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(Rn,{}),path:"notifications"})]}),Object(we.jsx)(xe.b,{element:Object(we.jsx)(ft,{}),path:"login"})]})})},ua=(n(431),function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,608)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))}),ba=de();Kt=ba,c.a.defaults.baseURL=g.API_URL,c.a.defaults.timeout=4e4,c.a.defaults.headers.common["Content-Type"]="application/json",c.a.interceptors.request.use((function(e){if(e.baseURL!==g.API_URL)return e;var t=Kt.getState().AUTH.accessToken;return e.headers.authorization=t?"Bearer ".concat(t):null,e}),(function(e){return Promise.reject(e)})),c.a.interceptors.response.use(null,(function(e){if(e.config&&e.response&&401===e.response.status){var t=Kt.getState().AUTH.refreshToken;return t?fetch("".concat(g.API_URL,"/tokens/access/verify/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})}).then((function(e){return e.json()})).then((function(e){if("token_not_valid"===(null===e||void 0===e?void 0:e.code))throw Kt.dispatch(h.logout()),new Error("refresh token has already expired");return fetch("".concat(g.API_URL,"/tokens/renew/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})})})).then((function(e){return e.json()})).then((function(t){var n=t.access,a=t.refresh;return Kt.dispatch(h.login({access_token:n,refresh_token:a})),e.config.headers.authorization=n,c.a.request(e.config)})).catch((function(){return Promise.reject(e)})):Promise.reject(e)}return Promise.reject(e)}));var ja=new pe.QueryClient;je.a.render(Object(we.jsxs)(pe.QueryClientProvider,{client:ja,children:[Object(we.jsx)(Oe.a,{store:ba,children:Object(we.jsx)(me.a,{loading:null,persistor:Object(oe.b)(ba),children:Object(we.jsx)(da,{})})}),Object(we.jsx)(he.ReactQueryDevtools,{initialIsOpen:!0})]}),document.getElementById("root")),ua()}},[[432,1,2]]]);
//# sourceMappingURL=main.ef46d7f5.chunk.js.map