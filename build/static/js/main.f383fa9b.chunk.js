(this["webpackJsonpmarigold-app"]=this["webpackJsonpmarigold-app"]||[]).push([[0],{255:function(e,t,n){},256:function(e,t,n){},323:function(e,t,n){},423:function(e,t,n){},425:function(e,t,n){},426:function(e,t,n){},431:function(e,t,n){},432:function(e,t,n){},435:function(e,t,n){},436:function(e,t,n){},437:function(e,t,n){"use strict";n.r(t);var a,r=n(24),c=n.n(r),i=n(86),s=n(35),l=n(451),o=n(456),d=n(135),u="AUTH",b={LOGIN:"".concat(u,"/LOGIN"),LOGOUT:"".concat(u,"/LOGOUT")},j={user:null,accessToken:null,refreshToken:null},p=Object(l.a)(Object(i.a)({},b.LOGIN,(function(e,t){var n=t.payload;return Object(s.a)(Object(s.a)({},e),n)})),j),h={login:Object(o.a)(b.LOGIN),logout:Object(o.a)(b.LOGOUT)},O=function(e){return e.AUTH||j},m=function(){return Object(d.a)(O,(function(e){return e.user}))},v=function(){return Object(d.a)(O,(function(e){return e.accessToken}))},x=function(){return Object(d.a)(O,(function(e){return e.refreshToken}))},f=p,g={API_URL:"http://".concat(window.location.hostname,":8000/v1/")},y="marigold_app",S="An error occurred while processing your request",C="\u2014",P=10,k="manager",I="personnel",T="supplier",_="customer",N="vat",A="vat-e",D="delivery",E="market",w="pickup",z="special",L="available",R="reorder",F="out_of_stock",V={APPROVED:"approved",PENDING:"pending",DELIVERED:"delivered",CANCELLED:"cancelled"},q="pending",B="delivered",M="cancelled",Y="paid",G="unpaid",U="pickup",Q="delivery",H="market",K="special",W={DAILY:"daily",MONTHLY:"monthly",DATE_RANGE:"date_range"},X=n(166),Z=n(80),J=n(167),$=n.n(J),ee="USER_INTEFACE",te={ON_COLLAPSE_SIDEBAR:"".concat(ee,"/ON_COLLAPSE_SIDEBAR")},ne={isSidebarCollapsed:!1},ae=Object(l.a)(Object(i.a)({},te.ON_COLLAPSE_SIDEBAR,(function(e,t){var n=t.payload;return Object(s.a)(Object(s.a)({},e),{},{isSidebarCollapsed:n})})),ne),re={onCollapseSidebar:Object(o.a)(te.ON_COLLAPSE_SIDEBAR)},ce=function(e){return e[ee]||ne},ie=function(){return Object(d.a)(ce,(function(e){return e.isSidebarCollapsed}))},se=ae,le=Object(Z.b)((a={router:X.routerReducer},Object(i.a)(a,u,f),Object(i.a)(a,ee,se),a)),oe=function(e,t){return t.type===b.LOGOUT&&($.a.removeItem(y),e=void 0),le(e,t)},de=n(58),ue=n(194),be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(de.b)(),n=[Object(X.routerMiddleware)(t)],a=[Z.a.apply(void 0,n)],r={key:y,storage:$.a,blacklist:["_persist"],keyPrefix:""},c=Object(ue.a)(r,oe),i=Object(Z.d)(c,e,Z.c.apply(void 0,a));return i},je=n(0),pe=n(39),he=n.n(pe),Oe=n(33),me=n(260),ve=n(81),xe=n(262),fe=n(28),ge=n(20),ye=n(41),Se=n.n(ye),Ce=n(53),Pe=n(8),ke=n(462),Ie=n(463),Te=n(457),_e=n(453),Ne=n(449),Ae=n(48),De=n.p+"static/media/logo.6979545f.png",Ee=n(5),we=n.n(Ee),ze=(n(323),n(1)),Le=function(e){var t=e.children,n=e.className;return Object(ze.jsx)("div",{className:we()("Box",n),children:t})},Re=n(29),Fe=function(e){var t=Object(ve.b)();return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(e(n))}},Ve=function(){return{user:Object(ve.c)(m()),accessToken:Object(ve.c)(v()),refreshToken:Object(ve.c)(x()),login:Fe(h.login),logout:Fe(h.logout)}},qe={login:function(e){var t=e.body;return c.a.post("".concat("/users/","login/"),t)}},Be="/branches/",Me={list:function(e){var t=e.params;return c.a.get("".concat(Be),{params:t})},create:function(e){var t=e.body;return c.a.post("".concat(Be),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(Be).concat(t,"/"),n)},delete:function(e){return c.a.delete("".concat(Be).concat(e,"/"))}},Ye={list:function(e){var t=e.params;return c.a.get("".concat("/branch-products/"),{params:t})}},Ge={list:function(e){var t=e.params;return c.a.get("".concat("/clients/"),{params:t})}},Ue="/deliveries/",Qe={list:function(e){var t=e.params;return c.a.get("".concat(Ue),{params:t})},retrieve:function(e){return c.a.get("".concat(Ue).concat(e,"/"))},create:function(e){var t=e.body;return c.a.post("".concat(Ue),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(Ue).concat(t,"/"),n)}},He="/notifications/",Ke={list:function(e){var t=e.params;return c.a.get("".concat(He),{params:t})},count:function(){return c.a.get("".concat(He,"count/"))}},We="/preorders/",Xe={list:function(e){var t=e.params;return c.a.get("".concat(We),{params:t})},retrieve:function(e){return c.a.get("".concat(We).concat(e,"/"))},create:function(e){var t=e.body;return c.a.post("".concat(We),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(We).concat(t,"/"),n)}},Ze={create:function(e){var t=e.body;return c.a.post("".concat("/preorder-transactions/"),t)}},Je="/products/",$e={list:function(e){var t=e.params;return c.a.get("".concat(Je),{params:t})},retrieve:function(e){return c.a.get("".concat(Je).concat(e,"/"))},create:function(e){var t=e.body;return c.a.post("".concat(Je),t)},edit:function(e){var t=e.id,n=e.body;return c.a.patch("".concat(Je).concat(t,"/"),n)},delete:function(e){return c.a.delete("".concat(Je).concat(e,"/"))}},et="/reports/",tt={listTopPayingCustomers:function(e){var t=e.params;return c.a.get("".concat(et,"top-customers/"),{params:t})},listTopSellingProducts:function(e){var t=e.params;return c.a.get("".concat(et,"top-products/"),{params:t})}},nt={acquire:function(e){var t=e.body;return c.a.post("".concat("/tokens/","acquire/"),t)}},at={list:function(e){var t=e.params;return c.a.get("".concat("/unit-types/"),{params:t})}},rt=function(){return Object(Oe.useQuery)("useBranches",(function(){return Me.list({params:{page:1,page_size:100}})}),{initialData:{data:{results:[]}},select:function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.results}})},ct=function(e){var t=e.params,n=e.options;return Object(Oe.useQuery)(["useBranchProducts",null===t||void 0===t?void 0:t.branchId,null===t||void 0===t?void 0:t.page,null===t||void 0===t?void 0:t.pageSize,null===t||void 0===t?void 0:t.search,null===t||void 0===t?void 0:t.status],(function(){return Ye.list({params:{branch_id:null===t||void 0===t?void 0:t.branchId,page_size:(null===t||void 0===t?void 0:t.pageSize)||P,page:(null===t||void 0===t?void 0:t.page)||1,search:null===t||void 0===t?void 0:t.search,status:null===t||void 0===t?void 0:t.status}})}),Object(s.a)({initialData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}},n))},it=function(e){var t=e.params;return Object(Oe.useQuery)(["useClients",t.type],(function(){return Ge.list({params:{type:t.type}})}),{initialData:{data:[]},select:function(e){return e.data}})},st=function(){var e=Object(fe.c)(),t=Object(Pe.a)(e,2),n=t[0],a=t[1];return{setSearchParams:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.shouldResetPage,c=void 0!==r&&r,i=t.shouldIncludeCurrentParams,l=void 0===i||i,o=Object(s.a)(Object(s.a)(Object(s.a)({},l?Object.fromEntries(n):{}),c?{page:1}:{}),e);Object.keys(o).forEach((function(e){return void 0===o[e]?delete o[e]:{}})),a(o)}}},lt=function(e){var t=e.params;return Object(Oe.useQuery)(["useDeliveries",t.page,t.pageSize,t.paymentStatus],(function(){return Qe.list({params:{payment_status:t.paymentStatus,page:t.page,page_size:t.pageSize}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{deliveries:e.data.results,total:e.data.count}}})},ot=function(e){var t=e.params;return Object(Oe.useQuery)(["useNotifications",t.page,t.pageSize,t.branchId],(function(){return Ke.list({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{notifications:e.data.results,total:e.data.count}}})},dt=function(){return Object(Oe.useQuery)("useNotificationsCount",(function(){return Ke.count()}),{initialData:{data:0},select:function(e){return e.data},refetchInterval:2500})},ut=function(e){var t=e.id;return Object(Oe.useQuery)(["usePreorderRetrieve",t],(function(){return Xe.retrieve(t)}),{select:function(e){return e.data},enabled:void 0!==t})},bt=function(){return Object(Oe.useMutation)((function(e){var t=e.id,n=e.description,a=e.preorderProducts,r=e.status;return Xe.edit({id:t,body:{description:n,preorder_products:a,status:r}})}))},jt=function(e){var t=e.params;return Object(Oe.useQuery)(["usePreorders",null===t||void 0===t?void 0:t.dateCreated,null===t||void 0===t?void 0:t.dateFulfilled,null===t||void 0===t?void 0:t.page,null===t||void 0===t?void 0:t.pageSize,null===t||void 0===t?void 0:t.search,null===t||void 0===t?void 0:t.status],(function(){return Xe.list({params:{date_created:null===t||void 0===t?void 0:t.dateCreated,date_fulfilled:null===t||void 0===t?void 0:t.dateFulfilled,page:(null===t||void 0===t?void 0:t.page)||1,page_size:(null===t||void 0===t?void 0:t.pageSize)||P,search:null===t||void 0===t?void 0:t.search,status:null===t||void 0===t?void 0:t.status}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{preorders:e.data.results,total:e.data.count}}})},pt=function(e){var t=e.id;return Object(Oe.useQuery)(["useProduct",t],(function(){return $e.retrieve(t)}),{select:function(e){return e.data},enabled:void 0!==t})},ht=function(e){var t=e.params,n=e.options;return Object(Oe.useQuery)(["useProducts",null===t||void 0===t?void 0:t.page,null===t||void 0===t?void 0:t.pageSize,null===t||void 0===t?void 0:t.search],(function(){return $e.list({params:{page:(null===t||void 0===t?void 0:t.page)||1,page_size:(null===t||void 0===t?void 0:t.pageSize)||P,search:null===t||void 0===t?void 0:t.search,ids:null===t||void 0===t?void 0:t.ids}})}),Object(s.a)({initialData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}},n))},Ot=function(e){var t=e.params;return Object(Oe.useQuery)(["useReportsCustomers",t.page,t.pageSize,t.dateRange],(function(){return tt.listTopPayingCustomers({params:{page:t.page,page_size:t.pageSize,date_range:t.dateRange}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{customers:e.data.results,total:e.data.count}}})},mt=function(e){var t=e.params;return Object(Oe.useQuery)(["useReportsProducts",t.page,t.pageSize,t.branchId,t.dateRange],(function(){return tt.listTopSellingProducts({params:{page:t.page,page_size:t.pageSize,branch_id:t.branchId,date_range:t.dateRange}})}),{initialData:{data:{results:[],count:0}},select:function(e){return{products:e.data.results,total:e.data.count}}})},vt=function(){return{isSidebarCollapsed:Object(ve.c)(ie()),onCollapseSidebar:Fe(re.onCollapseSidebar)}},xt=function(){return Object(Oe.useQuery)("useUnitTypes",(function(){return at.list({params:{page:1,page_size:100}})}),{initialData:{data:{results:[]}},select:function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.results}})},ft=n(14),gt=(n(423),{defaultValues:{login:"",password:""},schema:ft.c().shape({login:ft.d().required().label("Username"),password:ft.d().required().label("Password")})}),yt=function(){var e=Object(je.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(ge.h)(),c=Ve(),i=c.user,s=c.login;return Object(je.useEffect)((function(){i&&r("/")}),[i]),Object(ze.jsx)("section",{className:"Login",children:Object(ze.jsxs)(Le,{className:"Login_container",children:[Object(ze.jsx)("img",{alt:"logo",className:"Login_logo",src:De}),Object(ze.jsx)(Re.c,{initialValues:gt.defaultValues,validationSchema:gt.schema,onSubmit:function(e,t){var n=t.setFieldError;a(!0),qe.login({body:e}).then(function(){var t=Object(Ce.a)(Se.a.mark((function t(n){var a,r,c,i;return Se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt.acquire({body:{username:e.login,password:e.password}});case 2:a=t.sent,r=a.data,c=r.access,i=r.refresh,s({user:n.data,accessToken:c,refreshToken:i});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){n("password","Username, email, or password is invalid.")})).finally((function(){a(!1)}))},children:function(e){var t=e.setFieldValue;return Object(ze.jsx)(Re.b,{className:"w-100",children:Object(ze.jsxs)(Te.b,{className:"w-100",direction:"vertical",size:"large",children:[Object(ze.jsxs)("div",{children:[Object(ze.jsx)(_e.a,{placeholder:"Username",prefix:Object(ze.jsx)(ke.a,{}),size:"large",onChange:function(e){t("login",e.target.value)}}),Object(ze.jsx)(Re.a,{name:"login",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)("div",{children:[Object(ze.jsx)(_e.a,{placeholder:"Password",prefix:Object(ze.jsx)(Ie.a,{}),size:"large",type:"password",onChange:function(e){t("password",e.target.value)}}),Object(ze.jsx)(Re.a,{name:"password",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsx)(Ae.a,{htmlType:"submit",loading:n,size:"large",type:"primary",block:!0,children:"Login"})]})})}})]})})},St=n(465),Ct=n(466),Pt=n(467),kt=n(468),It=n(469),Tt=n(470),_t=n(471),Nt=n(281),At=function(e){var t=e.status;return Object(je.useCallback)((function(){var e=null;switch(t){case L:e=Object(ze.jsx)(Nt.a,{color:"green",children:"Available"});break;case R:e=Object(ze.jsx)(Nt.a,{color:"orange",children:"Reorder"});break;case F:e=Object(ze.jsx)(Nt.a,{color:"red",children:"Out of Stock"})}return e}),[t])()},Dt=function(e){var t=e.status;return Object(je.useCallback)((function(){var e=null;switch(t){case q:e=Object(ze.jsx)(Nt.a,{color:"orange",children:"Pending"});break;case B:e=Object(ze.jsx)(Nt.a,{color:"green",children:"Delivered"});break;case M:e=Object(ze.jsx)(Nt.a,{color:"red",children:"Cancelled"})}return e}),[t])()},Et=function(e){var t=e.name;return Object(ze.jsx)(Re.a,{name:t,render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})},wt=n(444),zt=n(270),Lt=n.p+"static/media/icon-account.d6cf778e.svg",Rt=n.p+"static/media/icon-logout.a7e54751.svg",Ft=n(40),Vt=n.n(Ft),qt=n(36),Bt=n.n(qt),Mt=function(e){switch(e){case k:return"Manager";case I:return"Personnel";default:return null}},Yt=function(e){return e.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")},Gt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u20b1",n=Number(e);return Object(Ft.isNaN)(n)?"":"".concat(t).concat(Yt(Object(Ft.round)(n,2).toFixed(2)))},Ut=function(e){return e?Bt()(e).format("MM/DD/YYYY h:mma"):""},Qt=(n(425),function(e){var t=e.items,n=Object(je.useState)(!1),a=Object(Pe.a)(n,2),r=a[0],c=a[1],i=Object(ge.g)().pathname,s=Ve(),l=s.user,o=s.logout,d=vt(),u=d.isSidebarCollapsed,b=d.onCollapseSidebar,j=Object(je.useCallback)((function(){return"".concat(null===l||void 0===l?void 0:l.first_name," ").concat(null===l||void 0===l?void 0:l.last_name)}),[l]);return Object(ze.jsxs)(wt.a.Sider,{breakpoint:"md",className:we()("Sidebar",{Sidebar__collapsed:u}),collapsedWidth:"0",theme:"light",width:280,onCollapse:function(e){return b(e)},children:[Object(ze.jsx)("img",{alt:"logo",className:"Sidebar_logo",src:De}),Object(ze.jsx)("div",{className:"Sidebar_sidebarList",children:t.map((function(e){return Object(ze.jsx)(fe.b,{tabIndex:-1,to:e.link,children:Object(ze.jsxs)("div",{className:we()("Sidebar_sidebarList_item",{Sidebar_sidebarList_item__active:i.startsWith(e.link)}),children:[Object(ze.jsx)(e.icon,{className:"Sidebar_sidebarList_item_icon",style:{fontSize:20,color:i.startsWith(e.link)?"#e0bc5d":"#626b77"}}),Object(ze.jsx)("span",{className:"Sidebar_sidebarList_item_name",children:e.name}),(null===e||void 0===e?void 0:e.count)>0&&Object(ze.jsx)("span",{className:"Sidebar_sidebarList_item_itemCount",children:null===e||void 0===e?void 0:e.count})]})},e.link)}))}),Object(ze.jsxs)("div",{className:we()("bottom",{active:r}),onClick:function(){return c((function(e){return!e}))},children:[Object(ze.jsxs)("div",{className:"menu",children:[Object(ze.jsxs)("div",{className:"item",children:[Object(ze.jsx)("img",{alt:"icon",className:"icon",src:Lt}),Object(ze.jsx)("span",{className:"name",children:"Account"})]}),Object(ze.jsxs)("div",{className:"item",onClick:function(){return o()},children:[Object(ze.jsx)("img",{alt:"icon",className:"icon",src:Rt}),Object(ze.jsx)("span",{className:"name",children:"Logout"})]})]}),Object(ze.jsxs)("div",{className:"user-details",children:[Object(ze.jsx)("img",{alt:"user avatar",className:"avatar",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAvVBMVEXh4eGjo6OkpKSpqamrq6vg4ODc3Nzd3d2lpaXf39/T09PU1NTBwcHOzs7ExMS8vLysrKy+vr7R0dHFxcXX19e5ubmzs7O6urrZ2dmnp6fLy8vHx8fY2NjMzMywsLDAwMDa2trV1dWysrLIyMi0tLTCwsLKysrNzc2mpqbJycnQ0NC/v7+tra2qqqrDw8OoqKjGxsa9vb3Pz8+1tbW3t7eurq7e3t62travr6+xsbHS0tK4uLi7u7vW1tbb29sZe/uLAAAG2UlEQVR4XuzcV47dSAyG0Z+KN+ccO+ecHfe/rBl4DMNtd/cNUtXD6DtLIAhCpMiSXwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIhHnfm0cVirHTam884sVu6Q1GvPkf0heq7VE+UF5bt2y97Vat+VlRniev/EVjjp12NlgdEytLWEy5G2hepDYOt7qGob2L23Dd3valPY6dsW+jvaBOKrkm2ldBVrbag+2tYeq1oX6RxYBsF6SY3vA8to8F0roRJaZmFFK2ASWA6CiT6EhuWkoQ9gablZ6l1oW47aWoF8dpvT6FrOunoD5pa7uf6CaslyV6rqD0guzYHLRK/hwJw40Cu4MUdu9Bt8C8yR4Jt+gRbmzEKvUTicFw8kY3NonOg/aJpTTf2AWWBOBTNBkvrmWF+QNDPnZoLUNOeagpKSOVdKhK550BVa5kGLOFfMCxY92ubFuYouNC9CFdyuebKrYrsyL9hcGpgnAxVaXDJPSrGKrGreVFVkU/NmykDJj1sV2Z55s0e74hwtS9k8KvNzxY8ZozvX+L67M4/uVFwT84Kt9CPz6EjFdUqgMyCjCTSHWD4cq7jOzKMzxtGu8ddwxzzaUXHFgXkTxCqwyLyJOON0j9POc/OCpbAj+hU/Zsz9Pbk2T65VbM/mybOKbd882VexjegLPXk0L154uvF/tR5N7RjJB9bvBsLEPJgI5dCcC2P5wL3QlSClJ+bYSSpIqpljh4IkpWNzapzqB3T9vCGBuGUOtWL9hDNPizMYmjND/QIloTkSJvKB4tHRK1iaE0u9hnhgDgxi/QFJZLmLEv0FvbHlbNzTG9ApWa5KHb0J9cByFNT1DhznGOngWO9CvWQ5KdX1AXweWy7Gn/Uh9CLLQdTTCkgPLLODVCshPrSMarHWgUpkGURrl2c83drWbp+0PlRebCsvFW0G+6FtLNzXxlDuXttGrrtlbQPlacvW1ppmCDPOHgJbQ/BwpmyQnh6siHVwcJoqB3iqNx/tHY/N+pPyg7Rz83Xv0n5zuff1ppPKCSS9audf1V6i9QAAAAAAAAAAAAAAAAAAAAAAEMdyAuVeZ9I4H95/uojGgf0QjKOLT/fD88ak0ysrI6SVo9qXRWgrhIsvtaNKqs2hXNlvD0LbSDho71fKWhsxvulf2NYu+jcro42d+e0isMyCxe18R2/D6HQYWY6i4elIryE9brbMgVbzONVP2G3sBeZMsNfYFf5h715302aDIADP2Lw+CIdDQhKcGuIgKKSIk1MSMND7v6zvBvqprdqY3bWfS1itRto/O+52t+KnW+2+OdSYK+5TViS9LxxqyX07p6xUeq7hXl+WPq/AX15QI+9fDryaw5d31EP7HPGqonMb5rmvYwow/upgWTDzKYQ/C2BV3o8oSNTPYVH26FEY7zGDNfnZo0DeOYclwc6jUN4ugBVxZ0HBFp0YJoxaFK41gn7ZGxWYZtDNrSOqEK0dFLscqMbhArXuIioS3UGnHw9U5uEHFCp9quOXUGfrUSFvC11cl0p1nbK+KwHs92yFYyo2DqFEsKdq+wAqhHsqtw+hQHykescY4rnvNOC7g3TPNOEZwt3QiBuINkxpRDqEZFOaMYVgTzTkCWKFGxqyCSHVkqYsIVQQ0ZQogEwJjUkgkvNpjO8g0ZzmzCHRieacIJBLaU7qIE+bBrUhz5YGbSHPmQadIc+EBk0gT48G9SDPPQ06QZ5gQ3M2AQQa0ZwRqtCExz1kClc0ZRVCqFuacguxEhqSQC53pBlHB8HyDY3Y5BDttgnoinRoQgfinZrTuxrxgeodYiiQ+1TOz6HCy4KqLV6gREHVCqjxSsVeociaaq2hyjOVeoYyXarUhTrdZs4VeaQ6j9DIdZsXEhXpU5U+1EqoSALFtlRjC9VGHlXwRlCuTKlAWkK9rEfxehkMCB8o3EMIE1yfovUdrHiKKFb0BEMuPQrVu8CU9xNFOr3DmtcFxVm8wqBsTGHGGUxya4+CeGsHqwZjijEewDAn5Rt9dOdgWzZt6kAqMm/xylpz1EI8i3hF0SxGXQxPvJrTEHXyMuVVTF9QN+WElZuUqKPiyEodC9RV+cbKvJWos0E1TbTe4wB1l89W/GSrWY4G4G4+NUHebhwEkGGYtPgpWskQAkjSXvr8x/xlGz/RKHcr/jOrXYn/1bh0Jh7/mjfpXPALjXC+O/Av7HfzEL+nERbJZME/tpgkRYg/1Mjms48Wf1PrYzbPIIBW8aDY9j/2vsef8vz9R39bDOL/2qlDIwCBGACCOMTLl4klOpP+i4MimFe7DZy7v3rcuaYqej+f3VE1K09+AgAAAAAAAAAAAAAAAAAAAAAAgBf6wsTW1jN3CAAAAABJRU5ErkJggg=="}),Object(ze.jsxs)("div",{className:"user-text-info",children:[Object(ze.jsx)("span",{className:"name",children:j()}),Object(ze.jsx)("span",{className:"role",children:Mt(null===l||void 0===l?void 0:l.user_type)})]})]})]})]})}),Ht=(n(426),function(e){var t=e.loading,n=e.loadingText,a=e.sidebarItems,r=e.children;return Object(ze.jsx)(wt.a,{className:"Container",children:Object(ze.jsxs)(zt.a,{size:"large",spinning:t,tip:n,wrapperClassName:"Container_spinner",children:[Object(ze.jsx)(Qt,{items:a}),r]})})});Ht.defaultProps={loading:!1,loadingText:"Fetching data..."};var Kt,Wt=Ht,Xt=(n(431),function(e){var t=e.title,n=e.breadcrumb,a=e.className,r=e.children,c=vt().isSidebarCollapsed;return Object(ze.jsxs)(wt.a,{className:we()("ContentLayout",a,{ContentLayout__sidebarCollapsed:c}),children:[Object(ze.jsx)(wt.a.Header,{className:"ContentLayout_header",children:Object(ze.jsxs)("div",{children:[Object(ze.jsx)("h3",{className:"ContentLayout_header_title",children:t}),n]})}),Object(ze.jsx)(wt.a.Content,{className:"ContentLayout_mainContent",children:r})]})}),Zt=function(e){var t=e.status;return Object(je.useCallback)((function(){var e=null;switch(t){case G:e=Object(ze.jsx)(Nt.a,{color:"orange",children:"Unpaid"});break;case Y:e=Object(ze.jsx)(Nt.a,{color:"green",children:"Paid"})}return e}),[t])()},Jt=function(e){var t=e.status;return Object(je.useCallback)((function(){var e=null;switch(t){case V.APPROVED:e=Object(ze.jsx)(Nt.a,{color:"blue",children:"Approved"});break;case V.PENDING:e=Object(ze.jsx)(Nt.a,{color:"orange",children:"Pending"});break;case V.DELIVERED:e=Object(ze.jsx)(Nt.a,{color:"green",children:"Delivered"});break;case V.CANCELLED:e=Object(ze.jsx)(Nt.a,{color:"red",children:"Cancelled"})}return e}),[t])()},$t=n(464),en=function(e){var t=e.rank;return Object(je.useCallback)((function(){var e=null;switch(t){case 1:e=Object(ze.jsx)($t.a,{style:{fontSize:"1.5rem",marginRight:"5px",color:"#FFD700"}});break;case 2:e=Object(ze.jsx)($t.a,{style:{fontSize:"1.25rem",marginRight:"5px",color:"#C0C0C0"}});break;case 3:e=Object(ze.jsx)($t.a,{style:{fontSize:"1rem",marginRight:"5px",color:"#CD7F32"}})}return e}),[t])()},tn=function(){var e=Object(ge.h)(),t=Ve().user,n=dt().data;Object(je.useEffect)((function(){t||e("/login")}),[t]);var a=Object(je.useCallback)((function(){return[{name:"Dashboard",icon:St.a,link:"/dashboard"},{name:"Products",icon:Ct.a,link:"/products"},{name:"Branches",icon:Pt.a,link:"/branches"},{name:"Preorders",icon:kt.a,link:"/preorders"},{name:"Deliveries",icon:It.a,link:"/deliveries"},{name:"Reports",icon:Tt.a,link:"/reports"},{name:"Notifications",icon:_t.a,link:"/notifications",count:n}]}),[n]);return Object(ze.jsx)(Wt,{sidebarItems:a(),children:Object(ze.jsx)(ge.b,{})})},nn=n(282),an=n(458),rn=n(447),cn=n(452),sn=function(e){var t=e.branch,n=e.onSuccess,a=e.onClose,r=Object(je.useState)(!1),c=Object(Pe.a)(r,2),i=c[0],s=c[1],l=Object(je.useRef)(),o=Object(je.useCallback)((function(){return{defaultValues:{id:null===t||void 0===t?void 0:t.id,name:(null===t||void 0===t?void 0:t.name)||""},schema:ft.c().shape({name:ft.d().required().label("Name")})}}),[t]);return Object(ze.jsx)(cn.a,{footer:[Object(ze.jsx)(Ae.a,{disabled:i,size:"large",onClick:a,children:"Cancel"}),Object(ze.jsx)(Ae.a,{loading:i,size:"large",type:"primary",onClick:function(){l.current.submitForm()},children:"Submit"})],title:t?"[Edit] Branch":"[Create] Branch",centered:!0,closable:!0,visible:!0,onCancel:a,children:Object(ze.jsx)(Re.c,{initialValues:o().defaultValues,innerRef:l,validationSchema:o().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ce.a)(Se.a.mark((function e(t,r){var c,i;return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.setFieldError,s(!0),e.prev=2,i=t.id?Me.edit:Me.create,e.next=6,i({id:t.id,body:t});case 6:n(),a(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),c("name",S);case 13:return e.prev=13,s(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(ze.jsxs)(Re.b,{children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Name"}),Object(ze.jsx)(_e.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(ze.jsx)(Re.a,{name:"name",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]})}})})},ln=[{title:"Name",dataIndex:"name"},{title:"Actions",dataIndex:"actions"}],on=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(je.useState)(!1),c=Object(Pe.a)(r,2),i=c[0],s=c[1],l=Object(je.useState)(null),o=Object(Pe.a)(l,2),d=o[0],u=o[1],b=Object(je.useState)(!1),j=Object(Pe.a)(b,2),p=j[0],h=j[1],O=rt(),m=O.isFetching,v=O.data,x=O.refetch;return Object(je.useEffect)((function(){var e=v.map((function(e){return{key:e.id,name:e.name,actions:Object(ze.jsxs)(Te.b,{children:[Object(ze.jsx)(Ae.a,{type:"link",onClick:function(){!function(e){u(e),s(!0)}(e)},children:"Edit"}),Object(ze.jsx)(an.a,{cancelText:"No",okButtonProps:{loading:p},okText:"Yes",placement:"top",title:"Are you sure you want to delete ".concat(e.name,"?"),onConfirm:function(){var t;t=e.id,h(!0),Me.delete(t).then((function(){x()})).finally((function(){h(!1)}))},children:Object(ze.jsx)(Ae.a,{type:"link",danger:!0,children:"Delete"})})]})}}));a(e)}),[v]),Object(ze.jsx)(Xt,{title:"Branches",children:Object(ze.jsxs)(Le,{children:[Object(ze.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(ze.jsxs)(Ae.a,{size:"large",type:"primary",onClick:function(){u(null),s(!0)},children:[Object(ze.jsx)(nn.a,{})," Create Branch"]})}),Object(ze.jsx)(rn.a,{columns:ln,dataSource:n,loading:m,pagination:!1}),i&&Object(ze.jsx)(sn,{branch:d,onClose:function(){u(null),s(!1)},onSuccess:x})]})})},dn=n(450),un=n(26),bn=n(459),jn=n(460),pn=n(148),hn=n(445),On=function(){var e=Object(fe.c)(),t=Object(Pe.a)(e,1)[0],n=st().setSearchParams,a=Object(hn.a)((function(e){n({search:e})}),500);return Object(ze.jsxs)(bn.a,{className:"mb-4",gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Search"}),Object(ze.jsx)(_e.a,{defaultValue:t.get("search"),allowClear:!0,onChange:function(e){return a(e.target.value.trim())}})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Status"}),Object(ze.jsxs)(pn.a,{className:"w-100",value:t.get("status"),allowClear:!0,onChange:function(e){n({status:e})},children:[Object(ze.jsx)(pn.a.Option,{value:L,children:"Available"}),Object(ze.jsx)(pn.a.Option,{value:R,children:"Reorder"}),Object(ze.jsx)(pn.a.Option,{value:F,children:"Out of Stock"})]})]})]})},mn=function(e){var t=e.unitTypes,n=Object(je.useState)([]),a=Object(Pe.a)(n,2),r=a[0],c=a[1],i=Object(fe.c)(),s=Object(Pe.a)(i,1)[0],l=st().setSearchParams,o=ct({params:{page:s.get("page"),pageSize:s.get("pageSize"),branchId:s.get("branchId"),search:s.get("search"),status:s.get("status")}}),d=o.isFetching,u=o.data,b=u.total,j=u.products;Object(je.useEffect)((function(){var e=j.map((function(e){var t={key:e.id,name:Object(ze.jsx)(fe.b,{to:"/products?search=".concat(e.name),children:e.name}),status:Object(ze.jsx)(At,{status:e.status})};return e.product_prices.forEach((function(e){t[String(e.unit_type_id)]=e.balance})),t}));c(e)}),[j]);var p=Object(je.useCallback)((function(){var e=Object(Ft.flatten)(null===j||void 0===j?void 0:j.map((function(e){return e.product_prices.map((function(e){return e.unit_type_id}))}))),n=t.filter((function(t){return e.includes(t.id)}));return[{title:"Name",dataIndex:"name",fixed:"left"}].concat(Object(un.a)(n.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))),[{title:"Status",dataIndex:"status"}])}),[j,t]);return Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(On,{}),Object(ze.jsx)(rn.a,{columns:p(),dataSource:r,loading:d,pagination:{current:Number(s.get("page"))||1,total:b,pageSize:Number(s.get("pageSize"))||P,onChange:function(e,t){l({page:e,pageSize:t})},disabled:0===j.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:1e3}})]})},vn=function(){var e=Object(fe.c)(),t=Object(Pe.a)(e,1)[0],n=st().setSearchParams,a=rt(),r=a.isFetching,c=a.data,i=xt(),s=i.isFetching,l=i.data;Object(je.useEffect)((function(){var e;!t.has("branchId")&&c.length>0&&n({branchId:null===c||void 0===c||null===(e=c[0])||void 0===e?void 0:e.id})}),[c,t]);return Object(ze.jsx)(Xt,{title:"Dashboard",children:Object(ze.jsx)(Le,{children:Object(ze.jsx)(zt.a,{spinning:r||s,children:Object(ze.jsx)(dn.a,{activeKey:t.get("branchId"),type:"card",onTabClick:function(e){n({branchId:e})},children:c.map((function(e){var t=e.name,n=e.id;return Object(ze.jsx)(dn.a.TabPane,{tab:t,children:Object(ze.jsx)(mn,{unitTypes:l})},n)}))})})})})},xn=[{title:"ID",dataIndex:"id"},{title:"Customer",dataIndex:"customer"},{title:"Date Created",dataIndex:"date_created"},{title:"Schedule of Delivery",dataIndex:"schedule_of_delivery"},{title:"Date Completed",dataIndex:"date_completed"},{title:"Payment",dataIndex:"payment",align:"center"},{title:"Status",dataIndex:"status",align:"center"},{title:"Actions",dataIndex:"actions"}],fn=function(){var e=Object(fe.c)(),t=Object(Pe.a)(e,1)[0],n=st().setSearchParams;return Object(ze.jsx)(bn.a,{gutter:[16,16],children:Object(ze.jsxs)(jn.a,{span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Payment Status"}),Object(ze.jsxs)(pn.a,{className:"w-100",value:t.get("paymentStatus"),allowClear:!0,onChange:function(e){n({paymentStatus:e})},children:[Object(ze.jsx)(pn.a.Option,{value:G,children:"Unpaid"}),Object(ze.jsx)(pn.a.Option,{value:Y,children:"Paid"})]})]})})},gn=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(fe.c)(),c=Object(Pe.a)(r,1)[0],i=Object(ge.h)(),s=st().setSearchParams,l=lt({params:{paymentStatus:c.get("paymentStatus"),page:c.get("page"),pageSize:c.get("pageSize")}}),o=l.isFetching,d=l.data,u=d.total,b=d.deliveries;return Object(je.useEffect)((function(){var e=b.map((function(e){var t;return{key:e.id,id:e.id,date_created:Ut(e.datetime_created),schedule_of_delivery:Ut(e.datetime_delivery),date_completed:Ut(e.datetime_completed),payment:Object(ze.jsx)(Zt,{status:null===e||void 0===e?void 0:e.payment_status}),customer:null===e||void 0===e||null===(t=e.customer)||void 0===t?void 0:t.name,status:Object(ze.jsx)(Dt,{status:e.status}),actions:Object(ze.jsx)(Ae.a,{type:"primary",ghost:!0,children:Object(ze.jsx)(fe.b,{to:"/deliveries/".concat(e.id),children:"View"})})}}));a(e)}),[b]),Object(ze.jsx)(Xt,{className:"Deliveries",title:"Deliveries",children:Object(ze.jsxs)(Le,{children:[Object(ze.jsxs)(bn.a,{className:"mb-4",gutter:[16,16],justify:"space-between",children:[Object(ze.jsx)(jn.a,{md:6,sm:12,span:24,children:Object(ze.jsx)(fn,{})}),Object(ze.jsx)(jn.a,{children:Object(ze.jsxs)(Ae.a,{size:"large",type:"primary",onClick:function(){i("create")},children:[Object(ze.jsx)(nn.a,{})," Create Delivery"]})})]}),Object(ze.jsx)(rn.a,{columns:xn,dataSource:n,loading:o,pagination:{current:Number(c.get("page"))||1,total:u,pageSize:Number(c.get("pageSize"))||P,onChange:function(e,t){s({page:e,pageSize:t})},disabled:0===b.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})]})})},yn=n(280),Sn=n(448),Cn=n(446),Pn=n(195),kn=n(461),In=n(149),Tn=n(126),_n=(n(432),"ALL"),Nn="SELECTED",An=function(e,t){var n=t.priceMarket,a=t.priceDelivery,r=t.pricePickup,c=t.priceSpecial,i=0;return e===U?i=n:e===Q?i=a:e===H?i=r:e===K&&(i=c),i},Dn=function(e){var t=e.branches,n=e.customers,a=e.values,r=e.onSetFieldValue,c=Object(je.useState)(!1),i=Object(Pe.a)(c,2),s=i[0],l=i[1];return Object(ze.jsx)(Le,{children:Object(ze.jsxs)(bn.a,{gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Branch Source"}),Object(ze.jsx)(pn.a,{className:"w-100",value:a.branchId,onChange:function(e){r("branchId",e)},children:t.map((function(e){return Object(ze.jsx)(pn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(ze.jsx)(Et,{name:"branchId"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Delivery Type"}),Object(ze.jsxs)(pn.a,{className:"w-100",value:a.deliveryType,onChange:function(e){r("deliveryType",e)},children:[Object(ze.jsx)(pn.a.Option,{value:Q,children:"Delivery"},Q),Object(ze.jsx)(pn.a.Option,{value:U,children:"Pickup"},U),Object(ze.jsx)(pn.a.Option,{value:H,children:"Market"},H),Object(ze.jsx)(pn.a.Option,{value:K,children:"Special"},K)]}),Object(ze.jsx)(Et,{name:"deliveryType"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Schedule of Delivery"}),Object(ze.jsx)(Sn.a,{allowClear:!1,className:"w-100",format:"MMM DD, YYYY hh:mm A",showTime:{format:"hh:mm A"},onOk:function(e){r("datetimeDelivery",e)}}),Object(ze.jsx)(Et,{name:"datetimeDelivery"})]}),Object(ze.jsx)(jn.a,{span:24,children:Object(ze.jsx)(Cn.a,{children:"Customer"})}),Object(ze.jsxs)(jn.a,{md:12,xs:18,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Customer's Name"}),Object(ze.jsx)(pn.a,{className:"w-100",mode:"tags",value:null!==a.customerName?[a.customerName]:[],onDeselect:function(){r("customerName",null),r("customerAddress",null),r("customerLandline",null),r("customerPhone",null),r("customerDescription",null),r("customerIsBakery",!1)},onSelect:function(e){var t=e;r("customerName",t);var a=n.find((function(e){return e.name===t}));r("customerAddress",(null===a||void 0===a?void 0:a.address)||""),r("customerLandline",(null===a||void 0===a?void 0:a.landline)||""),r("customerPhone",(null===a||void 0===a?void 0:a.phone)||""),r("customerDescription",(null===a||void 0===a?void 0:a.description)||""),r("customerIsBakery",(null===a||void 0===a?void 0:a.is_bakery)||!1)},children:n.map((function(e){return Object(ze.jsx)(pn.a.Option,{value:e.name,children:e.name},e.id)}))}),Object(ze.jsx)(Et,{name:"customerName"})]}),Object(ze.jsxs)(jn.a,{md:12,xs:6,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Is Customer a Bakery/Non-market?"}),Object(ze.jsx)(Pn.a.Group,{className:"w-100",options:[{label:"Yes",value:!0},{label:"No",value:!1}],optionType:"button",value:a.customerIsBakery,onChange:function(e){r("customerIsBakery",e.target.value)}}),Object(ze.jsx)(Et,{name:"customerIsBakery"})]}),Object(ze.jsxs)(jn.a,{md:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Customer's Phone Number"}),Object(ze.jsx)(_e.a,{value:a.customerPhone,onChange:function(e){r("customerPhone",e.target.value)}}),Object(ze.jsx)(Et,{name:"customerPhone"})]}),Object(ze.jsxs)(jn.a,{md:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Customer's Telephone Number"}),Object(ze.jsx)(_e.a,{value:a.customerLandline,onChange:function(e){r("customerLandline",e.target.value)}}),Object(ze.jsx)(Et,{name:"customerLandline"})]}),Object(ze.jsxs)(jn.a,{span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Customer's Address"}),Object(ze.jsx)(_e.a,{value:a.customerAddress,onChange:function(e){r("customerAddress",e.target.value)}}),Object(ze.jsx)(Et,{name:"customerAddress"})]}),Object(ze.jsxs)(jn.a,{span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Customer's Description"}),s?Object(ze.jsxs)(_e.a.Group,{compact:!0,children:[Object(ze.jsx)(_e.a,{style:{width:"calc(100% - 70px)"},value:a.customerDescription,onChange:function(e){r("customerDescription",e.target.value)}}),Object(ze.jsx)(Ae.a,{type:"primary",onClick:function(){l(!1)},children:"Save"})]}):Object(ze.jsx)(kn.a,{action:Object(ze.jsx)(Ae.a,{size:"small",type:"link",onClick:function(){l(!0)},children:"Edit"}),description:a.customerDescription,type:"info",showIcon:!0}),Object(ze.jsx)(Et,{name:"customerDescription"})]})]})})},En=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(je.useState)(1),r=Object(Pe.a)(a,2),c=r[0],i=r[1],s=Object(je.useState)(P),l=Object(Pe.a)(s,2),o=l[0],d=l[1],u=Object(je.useState)(""),b=Object(Pe.a)(u,2),j=b[0],p=b[1],h=Object(je.useState)(""),O=Object(Pe.a)(h,2),m=O[0],v=O[1],x=Object(je.useState)([]),f=Object(Pe.a)(x,2),g=f[0],y=f[1],S=ct({params:{branchId:t.branchId,page:c,pageSize:o,search:j,status:m},options:{enabled:!!t.branchId}}),C=S.isFetching,k=S.data,I=k.total,T=k.products;Object(je.useEffect)((function(){y(T.map((function(e){var a=t.deliveryProducts.find((function(t){return t.productId===e.id}));return{key:e.id,name:Object(ze.jsx)(In.a,{checked:a,disabled:e.status===F,onChange:function(a){var r=[];r=a.target.checked?[].concat(Object(un.a)(t.deliveryProducts),[{productId:e.id,productName:e.name,productStatus:e.status,productPrices:e.product_prices.map((function(e){return{branchProductId:e.branch_product_id,unitTypeId:e.unit_type_id,priceMarket:e.price_market,priceDelivery:e.price_delivery,pricePickup:e.price_pickup,priceSpecial:e.price_special,balance:e.balance,quantity:0}}))}]):t.deliveryProducts.filter((function(t){return t.productId!==e.id})),n("deliveryProducts",r)},children:e.name}),status:Object(ze.jsx)(At,{status:e.status})}})))}),[T,t]),Object(je.useEffect)((function(){y([]),n("deliveryProducts",[])}),[t.branchId]);var _=Object(Tn.useDebouncedCallback)((function(e){p(e)}),500);return Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsxs)(bn.a,{className:"mb-4",gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Search"}),Object(ze.jsx)(_e.a,{allowClear:!0,onChange:function(e){return _(e.target.value.trim())}})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Status"}),Object(ze.jsxs)(pn.a,{className:"w-100",allowClear:!0,onChange:function(e){v(e)},children:[Object(ze.jsx)(pn.a.Option,{value:L,children:"Available"}),Object(ze.jsx)(pn.a.Option,{value:R,children:"Reorder"})]})]})]}),Object(ze.jsx)(rn.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}],dataSource:g,loading:C,pagination:{current:c,total:I,pageSize:o,onChange:function(e,t){i(e),d(t)},disabled:C,position:["bottomCenter"],pageSizeOptions:["10","20","50"]}})]})},wn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(je.useState)([]),r=Object(Pe.a)(a,2),c=r[0],i=r[1],s=Object(je.useState)(0),l=Object(Pe.a)(s,2),o=l[0],d=l[1],u=xt(),b=u.isFetching,j=u.data;Object(je.useEffect)((function(){var e=0;i(t.deliveryProducts.map((function(a,r){var c={key:a.productId,name:Object(ze.jsx)(In.a,{checked:!0,onChange:function(){n("deliveryProducts",t.deliveryProducts.filter((function(e){return e.productId!==a.productId})))},children:a.productName})},i=0;return a.productPrices.forEach((function(e,a){var s=e.quantity,l=An(t.deliveryType,{priceMarket:e.priceMarket,priceDelivery:e.priceDelivery,pricePickup:e.pricePickup,priceSpecial:e.priceSpecial});i+=l*s,c[String(e.unitTypeId)]=Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(_e.a,{style:{textAlign:"center"},type:"number",onChange:function(e){n("deliveryProducts.".concat(r,".productPrices.").concat(a,".quantity"),Number(e.target.value))}}),Object(ze.jsx)(Et,{name:"deliveryProducts.".concat(r,".productPrices.").concat(a,".quantity")})]})})),c.subtotal=Gt(i),e+=i,c}))),d(e)}),[t,j]);var p=Object(je.useCallback)((function(){var e,n=Object(Ft.flatten)(null===t||void 0===t||null===(e=t.deliveryProducts)||void 0===e?void 0:e.map((function(e){return e.productPrices.map((function(e){return e.unitTypeId}))}))),a=j.filter((function(e){return n.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(un.a)(a.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Subtotal",dataIndex:"subtotal"}])}),[t,j]);return Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(rn.a,{columns:p(),dataSource:c,loading:b,pagination:!1,scroll:{x:800}}),Object(ze.jsxs)(Ne.a.Title,{className:"CreateDelivery_grandTotal",level:3,children:["Grand Total: ",Gt(o)]})]})},zn=function(){var e,t=Object(je.useState)(!1),n=Object(Pe.a)(t,2),a=n[0],r=n[1],c=Object(ge.h)(),i=rt(),s=i.isFetching,l=i.data,o=it({params:{type:_}}),d=o.isFetching,u=o.data,b={defaultValues:{branchId:null,deliveryType:null,datetimeDelivery:null,customerName:null,customerAddress:null,customerLandline:null,customerPhone:null,customerDescription:null,customerIsBakery:!1,deliveryProducts:[]},schema:ft.c().shape({branchId:ft.d().required().label("Branch").nullable(),deliveryType:ft.d().required().label("Delivery Type").nullable(),datetimeDelivery:(e="Schedule Of Delivery",ft.d().required().nullable().test("is-valid-date","".concat(e," is not a valid time"),(function(e){return Bt()(e).isValid()})).label(e)),customerName:ft.d().required().label("Customer Name").nullable(),customerAddress:ft.d().required().label("Customer Address").nullable(),customerLandline:ft.d().label("Customer Telephone").nullable(),customerPhone:ft.d().label("Customer Phone").nullable(),customerDescription:ft.d().label("Customer Description").nullable(),deliveryProducts:ft.a().of(ft.c().shape({productId:ft.b().required(),productName:ft.d().required(),productStatus:ft.d().required(),productPrices:ft.a().of(ft.c().shape({branchProductId:ft.b().required().label("Product"),unitTypeId:ft.b().required(),price:ft.b(),quantity:ft.b().required().min(0,"Must not be negative").label("Quantity")}))}))})},j=function(e){cn.a.success({title:"Success",content:"Delivery is successfully created.",keyboard:!1,okText:"View Delivery",onOk:function(){c("/deliveries/".concat(e))}})};return Object(ze.jsx)(Xt,{title:"Create Delivery",children:Object(ze.jsx)(zt.a,{spinning:s||d,children:Object(ze.jsx)(Re.c,{initialValues:b.defaultValues,validationSchema:b.schema,onSubmit:function(){var e=Object(Ce.a)(Se.a.mark((function e(t){var n,a,c,i;return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(!0),!(t.deliveryProducts.length>0)){e.next=22;break}if(e.prev=2,n=u.find((function(e){return e.name===t.customerName})),!((a=Object(Ft.flatten)(t.deliveryProducts.map((function(e){return e.productPrices.filter((function(e){return e.quantity>0})).map((function(e){var n=An(t.deliveryType,{priceMarket:e.priceMarket,priceDelivery:e.priceDelivery,pricePickup:e.pricePickup,priceSpecial:e.priceSpecial});return{branch_product_id:e.branchProductId,quantity:e.quantity,price:n}}))})))).length>0)){e.next=13;break}return e.next=8,Qe.create({body:{branch_id:t.branchId,delivery_type:t.deliveryType,datetime_delivery:(s=Bt()(t.datetimeDelivery),Bt()(s).format("YYYY-MM-DD HH:mm:ss")),customer:{id:null===n||void 0===n?void 0:n.id,name:t.customerName,description:t.customerDescription,address:t.customerAddress,landline:t.customerLandline.length>0?t.customerLandline:void 0,phone:t.customerPhone.length>0?t.customerPhone:void 0,is_bakery:t.customerIsBakery},delivery_products:a}});case 8:c=e.sent,i=c.data,j(i.id),e.next=14;break;case 13:yn.b.error("Please add quantity to products first");case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0),yn.b.error(S);case 20:e.next=23;break;case 22:yn.b.error("Please add a product first");case 23:r(!1);case 24:case"end":return e.stop()}var s}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(ze.jsx)(Re.b,{className:"w-100",children:Object(ze.jsxs)(zt.a,{spinning:a,children:[Object(ze.jsx)(Dn,{branches:l,customers:u,values:t,onSetFieldValue:n}),null!==t.branchId&&Object(ze.jsx)(Le,{children:Object(ze.jsxs)(dn.a,{defaultActiveKey:_n,size:"large",type:"card",children:[Object(ze.jsx)(dn.a.TabPane,{tab:"All",children:Object(ze.jsx)(En,{values:t,onSetFieldValue:n})},_n),Object(ze.jsx)(dn.a.TabPane,{tab:"Selected Products (".concat(t.deliveryProducts.length,")"),children:Object(ze.jsx)(wn,{values:t,onSetFieldValue:n})},Nn)]})}),Object(ze.jsx)(Le,{children:Object(ze.jsx)(bn.a,{justify:"end",children:Object(ze.jsx)(jn.a,{children:Object(ze.jsx)(Ae.a,{htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})})]})})}})})})},Ln=n(113),Rn=n(455),Fn=n(193),Vn={defaultValues:{preparedBy:"",checkedBy:"",pulledOutBy:"",deliveredBy:"",paymentStatus:""},schema:ft.c().shape({preparedBy:ft.d().label("Prepared By"),checkedBy:ft.d().label("Checked By"),pulledOutBy:ft.d().label("Pulled Out By"),deliveredBy:ft.d().label("Delivered By"),paymentStatus:ft.d().label("Payment Status")})},qn=function(){var e,t,n,a,r,c,i,s,l,o=Object(je.useState)([]),d=Object(Pe.a)(o,2),u=d[0],b=d[1],j=Object(je.useState)(!1),p=Object(Pe.a)(j,2),h=p[0],O=p[1],m=Object(je.useState)(""),v=Object(Pe.a)(m,2),x=v[0],f=v[1],g=Object(ge.i)(),y=Object(ge.h)(),P=xt(),k=P.isFetching,I=P.data,T=function(e){var t=e.id;return Object(Oe.useQuery)(["useDeliveryRetrieve",t],(function(){return Qe.retrieve(t)}),{select:function(e){return e.data},enabled:void 0!==t})}({id:g.deliveryId}),_=T.isFetching,N=T.data,A=T.refetch,D=Object(Oe.useMutation)((function(e){var t=e.checkedBy,n=e.deliveredBy,a=e.id,r=e.paymentStatus,c=e.preparedBy,i=e.pulledOutBy,s=e.status;return Qe.edit({id:a,body:{checked_by:t,delivered_by:n,payment_status:r,prepared_by:c,pulled_out_by:i,status:s}})})),E=D.mutateAsync,w=D.isLoading;Object(je.useEffect)((function(){var e={};null===N||void 0===N||N.delivery_products.forEach((function(t){var n=t.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)})),b(Object.keys(e).map((function(t){var n=e[t],a={key:t,name:t};return n.forEach((function(e){var t=String(e.unit_type.id);a[t]=Number(e.quantity)})),a})))}),[N]);var z=Object(je.useCallback)((function(){var e,t=(null===N||void 0===N||null===(e=N.delivery_products)||void 0===e?void 0:e.map((function(e){return e.unit_type.id})))||[],n=I.filter((function(e){return t.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(un.a)(n.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))))}),[N,I]),L=function(){cn.a.confirm({icon:Object(ze.jsx)(Ln.a,{}),autoFocusButton:"cancel",centered:!0,content:"Are you sure you want to cancel this delivery?",confirmLoading:w,okText:"Yes",onOk:function(){var e=Object(Ce.a)(Se.a.mark((function e(){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({id:g.deliveryId,status:M});case 2:cn.a.destroyAll(),yn.b.success("Delivery is cancelled successfully"),y("/deliveries");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})};return Object(ze.jsxs)(Xt,{className:"ViewDelivery",title:"Delivery",children:[Object(ze.jsxs)(zt.a,{spinning:_||k||w,children:[Object(ze.jsxs)(Le,{children:[(null===N||void 0===N?void 0:N.status)!==M&&Object(ze.jsx)(bn.a,{className:"mb-4",children:Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{className:"mb-4",loading:h,size:"large",type:"primary",ghost:!0,onClick:function(){if(N){O(!0);var e=new Fn.a({orientation:"p",unit:"px",format:"legal",hotfixes:["px_scaling"]}),t=function(e){var t="#000",n="#3498DB",a="#6A0DAD",r="#E74C3C",c=e.delivery_products.length+1>21,i=0,s=[].concat(Object(un.a)(e.delivery_products.map((function(e){var t=Number(e.quantity)*Number(e.price);return i+=t,"\n    <tr>\n      <td>".concat(e.quantity,"</td>\n      <td>").concat(Object(Ft.upperCase)(e.unit_type.name),"</td>\n      <td>").concat(Object(Ft.upperCase)(e.product.name),"</td>\n      <td>").concat(Gt(e.price,"P"),"</td>\n      <td>").concat(Gt(t,"P"),"</td>\n    </tr>\n    ")}))),["<tr>\n      <td></td>\n      <td></td>\n      <td><b>TOTAL: </b></td>\n      <td></td>\n      <td>".concat(Gt(i,"P"),"</td>\n    </tr>\n    ")]).join(""),l=function(t){var n=t.color;return'\n    <div style="min-height: '.concat(c?"1324px":"auto","; color: ").concat(n," !important; border-color: ").concat(n,'; font-size: 11px !important;">\n\n      <div class="header">\n        <div class="header-text font-weight-bold">DELIVERY RECEIPT - #').concat(e.id,'</div>\n        <div>\n          <strong>ORDERED BY:</strong>\n        </div>\n        <div>\n          <span class="text-center font-weight-bold">\n            ').concat(e.customer.name,'\n          </span>\n        </div>\n        <div>\n          <strong>DATE: </strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(Bt()(e.datetime_created).format("MMM DD, YYYY"),'\n          </span>\n        </div>\n        <div>\n          <strong>ADDRESS:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.customer.address,'\n          </span>\n        </div>\n        <div>\n          <strong>RECEIVED BY:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.user.first_name," ").concat(e.user.last_name,'\n          </span>\n        </div>\n        <div>\n          <strong>TIME:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(Bt()(e.datetime_created).format("hh:mm A"),'\n          </span>\n        </div>\n        <div>\n          <strong>CONTACT NO:</strong>\n        </div>\n        <div>\n          <span class="text-center">\n            ').concat(e.customer.phone||""," ").concat(e.customer.landline||"",'\n          </span>\n        </div>\n      </div>\n\n      <div class="products">\n        <table>\n          <tr>\n            <th colspan="2">QUANTITY</th>\n            <th>ARTICLES</th>\n            <th>UNIT PRICE</th>\n            <th>AMOUNT</th>\n          </tr>\n          ').concat(s,'\n        </table>\n      </div>\n\n      <div class="footer">\n        <div>\n          <div>Receive the above goods in good order and conditions.</div>\n          <div class="signature"></div>\n          <div class="signature-label">Customer\'s Complete Name & Signature</div>\n        </div>\n\n        <div class="users">\n          <div>\n            <strong>PREPARED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>CHECKED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>PULLED-OUT BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n          <div>\n            <strong>DELIVERED BY:</strong>\n          </div>\n          <div>\n            <span></span>\n          </div>\n        </div>\n\n        <div class="disclaimer">\n          NOTE: This order slip at the same time serves as the temporary delivery\n          receipt. Our official invoice will be issued upon return of the receipt\n          and fully signed by the customer.\n        </div>\n      </div>\n\n      <div class="note">\n        <span>BLACK = CUSTOMER\'S COPY</span>\n        <span>').concat(e.customer.is_bakery?"GREEN":"BLUE"," = MARIGOLD'S COPY</span>\n      </div>\n    </div>\n  ")};return'\n  <html lang="en">\n    <head>\n      <style>\n        .header, .products, .footer, .note {\n          width: 795px;\n        }\n  \n        .header {\n          display: grid;\n          grid-template-columns: repeat(4, 1fr);\n          border-width: 1px;\n          border-style: solid;\n        }\n  \n        .header-text {\n          grid-column: 1 / span 4;\n          text-align: center;\n        }\n  \n        .header > div {\n          padding: 1px;\n          border-top-width: 1px;\n          border-top-style: solid;\n        }\n  \n        .products table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n  \n        .products table th,\n        .products table td {\n          border-width: 1px;\n          border-style: solid;\n          text-align: center;\n        }\n  \n        .footer {\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n        }\n  \n        .footer > div {\n          padding: 2.5px;\n          border-width: 1px;\n          border-style: solid;\n        }\n  \n        .footer .signature {\n          width: 80%;\n          margin: 15px auto 0;\n          border-bottom-width: 1px;\n          border-bottom-style: solid;\n        }\n  \n        .footer .signature-label {\n          text-align: center;\n        }\n  \n        .footer .users {\n          display: grid;\n          grid-template-columns: repeat(2, 1fr);\n        }\n  \n        .footer .users span {\n          width: 80%;\n          height: 100%;\n          margin: auto 0;\n          display: block;\n          border-bottom-width: 1px;\n          border-bottom-style: solid;\n        }\n  \n        .footer .disclaimer {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          text-align: center;\n          padding: 10px;\n          font-size: 10px;\n        }\n  \n        .note {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n  \n        .text-center {\n          text-align: center;\n        }\n  \n        .font-weight-bold {\n          font-weight: bold;\n        }\n      </style>\n    </head>\n  \n    <body>\n      '.concat(l({color:t}),"\n\n      ").concat(c?"":'<hr style="width: 795px; margin: 32px 0; border-style: dotted; border-width: 1px; border-color: #9A9A9A" />',"\n\n      ").concat(l({color:e.customer.is_bakery?n:r}),"\n      \n      ").concat(c?"":'<hr style="width: 795px; margin: 32px 0; border-style: dotted; border-width: 1px; border-color: #9A9A9A" />',"\n\n      ").concat(l({color:a}),"\n    </body>\n  </html>\n  ")}(N);f(t),setTimeout((function(){e.html(t,{margin:10,filename:"Delivery_".concat(N.id),callback:function(e){window.open(e.output("bloburl").toString()),O(!1),f("")}})}),500)}else yn.b.error(S)},children:"Print Delivery"})})}),Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"ID",span:2,children:null===N||void 0===N?void 0:N.id}),Object(ze.jsx)(Rn.b.Item,{label:"Branch",children:null===N||void 0===N||null===(e=N.branch)||void 0===e?void 0:e.name}),Object(ze.jsx)(Rn.b.Item,{label:"Delivery Type",children:Object(Ft.upperFirst)(null===N||void 0===N?void 0:N.delivery_type)}),Object(ze.jsxs)(Rn.b.Item,{label:"Created By",children:[null===N||void 0===N||null===(t=N.user)||void 0===t?void 0:t.first_name," ",null===N||void 0===N||null===(n=N.user)||void 0===n?void 0:n.last_name]}),Object(ze.jsx)(Rn.b.Item,{label:"Datetime Created",children:Ut(null===N||void 0===N?void 0:N.datetime_created)}),Object(ze.jsx)(Rn.b.Item,{label:"Schedule of Delivery",children:Ut(null===N||void 0===N?void 0:N.datetime_delivery)}),Object(ze.jsx)(Rn.b.Item,{label:"Status",children:Object(ze.jsx)(Jt,{status:null===N||void 0===N?void 0:N.status})})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Customer",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"Name",children:null===N||void 0===N||null===(a=N.customer)||void 0===a?void 0:a.name}),Object(ze.jsx)(Rn.b.Item,{label:"Is a Bakery Shop?",children:(null===N||void 0===N||null===(r=N.customer)||void 0===r?void 0:r.is_bakery)?"Yes":"No"}),Object(ze.jsx)(Rn.b.Item,{label:"Phone",children:(null===N||void 0===N||null===(c=N.customer)||void 0===c?void 0:c.phone)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Telephone",children:(null===N||void 0===N||null===(i=N.customer)||void 0===i?void 0:i.landline)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Address",span:2,children:null===N||void 0===N||null===(s=N.customer)||void 0===s?void 0:s.address}),Object(ze.jsx)(Rn.b.Item,{label:"Description",span:2,children:null===N||void 0===N||null===(l=N.customer)||void 0===l?void 0:l.description})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsx)(rn.a,{columns:z(),dataSource:u,pagination:!1,scroll:{x:800}})]}),(null===N||void 0===N?void 0:N.status)===B&&Object(ze.jsx)(Le,{children:Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Delivery",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"Delivery Completed",span:2,children:Ut(null===N||void 0===N?void 0:N.datetime_completed)}),Object(ze.jsx)(Rn.b.Item,{label:"Prepared By",children:(null===N||void 0===N?void 0:N.prepared_by)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Checked By",children:(null===N||void 0===N?void 0:N.checked_by)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Pulled Out By",children:(null===N||void 0===N?void 0:N.pulled_out_by)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Delivered By",children:(null===N||void 0===N?void 0:N.delivered_by)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Payment Status",children:Object(ze.jsx)(Zt,{status:null===N||void 0===N?void 0:N.payment_status})})]})}),(null===N||void 0===N?void 0:N.status)===q&&Object(ze.jsx)(Le,{children:Object(ze.jsx)(Re.c,{initialValues:Vn.defaultValues,validationSchema:Vn.schema,onSubmit:function(){var e=Object(Ce.a)(Se.a.mark((function e(t){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E({id:g.deliveryId,status:B,paymentStatus:t.paymentStatus,preparedBy:t.preparedBy,checkedBy:t.checkedBy,pulledOutBy:t.pulledOutBy,deliveredBy:t.deliveredBy}),A();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(ze.jsxs)(Re.b,{children:[Object(ze.jsxs)(bn.a,{gutter:[24,24],children:[Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Prepared By"}),Object(ze.jsx)(_e.a,{value:t.name,onChange:function(e){n("preparedBy",e.target.value)}}),Object(ze.jsx)(Et,{name:"preparedBy"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Checked By"}),Object(ze.jsx)(_e.a,{value:t.name,onChange:function(e){n("checkedBy",e.target.value)}}),Object(ze.jsx)(Et,{name:"checkedBy"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Pulled Out"}),Object(ze.jsx)(_e.a,{value:t.name,onChange:function(e){n("pulledOutBy",e.target.value)}}),Object(ze.jsx)(Et,{name:"pulledOutBy"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Delivered By"}),Object(ze.jsx)(_e.a,{value:t.name,onChange:function(e){n("deliveredBy",e.target.value)}}),Object(ze.jsx)(Et,{name:"deliveredBy"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Payment Status"}),Object(ze.jsxs)(pn.a,{className:"w-100",value:t.payment_status,allowClear:!0,onChange:function(e){n("paymentStatus",e)},children:[Object(ze.jsx)(pn.a.Option,{value:G,children:"Unpaid"}),Object(ze.jsx)(pn.a.Option,{value:Y,children:"Paid"})]}),Object(ze.jsx)(Et,{name:"paymentStatus"})]})]}),Object(ze.jsxs)(bn.a,{className:"mt-6",gutter:[16,16],children:[Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{size:"large",block:!0,danger:!0,onClick:L,children:"Cancel Delivery"})}),Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{htmlType:"submit",size:"large",type:"primary",block:!0,children:"Set As Delivered"})})]})]})}})})]}),Object(ze.jsx)("div",{dangerouslySetInnerHTML:{__html:x}})]})},Bn=(n(435),[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}]),Mn=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(fe.c)(),c=Object(Pe.a)(r,1)[0],i=st().setSearchParams,s=ot({params:{page:c.get("page"),pageSize:c.get("pageSize"),branchId:c.get("branchId")}}),l=s.isFetching,o=s.data,d=o.total,u=o.notifications;return Object(je.useEffect)((function(){var e=u.map((function(e){return{key:e.id,name:"".concat(e.product.name," (").concat(e.unit_type.name,")"),status:Object(ze.jsx)(At,{status:e.status})}}));a(e)}),[u]),Object(ze.jsx)(rn.a,{columns:Bn,dataSource:n,loading:l,pagination:{current:Number(c.get("page"))||1,total:d,pageSize:Number(c.get("pageSize"))||P,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===u.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})},Yn=function(){var e=Object(fe.c)(),t=Object(Pe.a)(e,1)[0],n=st().setSearchParams,a=rt(),r=a.isFetching,c=a.data;Object(je.useEffect)((function(){var e;!t.has("branchId")&&c.length>0&&n({branchId:null===c||void 0===c||null===(e=c[0])||void 0===e?void 0:e.id})}),[c,t]);return Object(ze.jsx)(Xt,{title:"Notifications",children:Object(ze.jsx)(Le,{children:Object(ze.jsx)(zt.a,{spinning:r,children:Object(ze.jsx)(dn.a,{activeKey:t.get("branchId"),type:"card",onTabClick:function(e){n({branchId:e})},children:c.map((function(e){var t=e.name,n=e.id;return Object(ze.jsx)(dn.a.TabPane,{tab:t,children:Object(ze.jsx)(Mn,{})},n)}))})})})})},Gn=(n(255),[{title:"ID",dataIndex:"id"},{title:"Supplier",dataIndex:"supplier"},{title:"Date Created",dataIndex:"dateCreated"},{title:"Date Fulfilled",dataIndex:"dateFulfilled"},{title:"Status",dataIndex:"status",align:"center"},{title:"Actions",dataIndex:"actions"}]),Un=function(){var e=Object(fe.c)(),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(Tn.useDebouncedCallback)((function(e){a(Object(s.a)(Object(s.a)({},Object.fromEntries(n)),{},{search:e}))}),500);return Object(ze.jsxs)(bn.a,{className:"mb-4",gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Search"}),Object(ze.jsx)(_e.a,{defaultValue:n.get("search"),allowClear:!0,onChange:function(e){return r(e.target.value.trim())}})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Status"}),Object(ze.jsxs)(pn.a,{className:"w-100",value:n.get("status"),allowClear:!0,onChange:function(e){a(Object(s.a)(Object(s.a)({},Object.fromEntries(n)),{},{status:e||""}))},children:[Object(ze.jsx)(pn.a.Option,{value:V.APPROVED,children:"Approved"}),Object(ze.jsx)(pn.a.Option,{value:V.PENDING,children:"Pending"}),Object(ze.jsx)(pn.a.Option,{value:V.DELIVERED,children:"Delivered"}),Object(ze.jsx)(pn.a.Option,{value:V.CANCELLED,children:"Cancelled"})]})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Date Created"}),Object(ze.jsx)(Sn.a,{className:"w-100",defaultValue:n.get("dateCreated")?Bt()(n.get("dateCreated")):null,allowClear:!0,onChange:function(e,t){a(Object(s.a)(Object(s.a)({},Object.fromEntries(n)),{},{dateCreated:t}))}})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Date Fulfilled"}),Object(ze.jsx)(Sn.a,{className:"w-100",defaultValue:n.get("dateFulfilled")?Bt()(n.get("dateFulfilled")):null,allowClear:!0,onChange:function(e,t){a(Object(s.a)(Object(s.a)({},Object.fromEntries(n)),{},{dateFulfilled:t}))}})]})]})},Qn=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(ge.h)(),c=Object(fe.c)(),i=Object(Pe.a)(c,2),l=i[0],o=i[1],d=jt({params:{dateCreated:l.get("dateCreated"),dateFulfilled:l.get("dateFulfilled"),page:l.get("page"),pageSize:l.get("pageSize"),search:l.get("search"),status:l.get("status")}}),u=d.isFetching,b=d.data,j=b.total,p=b.preorders;return Object(je.useEffect)((function(){var e=p.map((function(e){return{key:e.id,id:e.id,supplier:e.supplier.name,dateCreated:Ut(e.datetime_created),dateFulfilled:Ut(e.datetime_fulfilled),status:Object(ze.jsx)(Jt,{status:e.status}),actions:Object(ze.jsx)(Ae.a,{type:"primary",ghost:!0,children:Object(ze.jsx)(fe.b,{to:"/preorders/".concat(e.id),children:"View"})})}}));a(e)}),[p]),Object(ze.jsx)(Xt,{className:"Preorders",title:"Preorders",children:Object(ze.jsxs)(Le,{children:[Object(ze.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(ze.jsxs)(Ae.a,{size:"large",type:"primary",onClick:function(){r("create")},children:[Object(ze.jsx)(nn.a,{})," Create Preorder"]})}),Object(ze.jsx)(Un,{}),Object(ze.jsx)(rn.a,{columns:Gn,dataSource:n,loading:u,pagination:{current:Number(l.get("page"))||1,total:j,pageSize:Number(l.get("pageSize"))||P,onChange:function(e,t){o(Object(s.a)(Object(s.a)({},Object.fromEntries(l)),{},{page:e,pageSize:t}))},disabled:0===p.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})]})})},Hn="ALL",Kn="SELECTED",Wn=function(e){var t,n,a,r,c,i,s,l,o=e.preorder,d=e.branches,u=e.suppliers,b=e.values,j=e.onSetFieldValue,p=Object(je.useState)(!1),h=Object(Pe.a)(p,2),O=h[0],m=h[1];return Object(ze.jsx)(Le,{children:o?Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"ID",span:2,children:null===o||void 0===o?void 0:o.id}),Object(ze.jsx)(Rn.b.Item,{label:"Branch",children:null===o||void 0===o||null===(t=o.branch)||void 0===t?void 0:t.name}),Object(ze.jsx)(Rn.b.Item,{label:"Delivery Type",children:Vt.a.upperFirst(null===o||void 0===o?void 0:o.delivery_type)}),Object(ze.jsxs)(Rn.b.Item,{label:"Created By",children:[null===o||void 0===o||null===(n=o.user)||void 0===n?void 0:n.first_name," ",null===o||void 0===o||null===(a=o.user)||void 0===a?void 0:a.last_name]}),Object(ze.jsx)(Rn.b.Item,{label:"Datetime Created",children:Ut(null===o||void 0===o?void 0:o.datetime_created)}),Object(ze.jsx)(Rn.b.Item,{label:"Datetime Fulfilled",children:Ut(null===o||void 0===o?void 0:o.datetime_fulfilled)}),Object(ze.jsx)(Rn.b.Item,{label:"Status",children:Object(ze.jsx)(Jt,{status:null===o||void 0===o?void 0:o.status})}),Object(ze.jsx)(Rn.b.Item,{label:"Description",span:2,children:Object(ze.jsx)(kn.a,{description:o.description,type:"info",showIcon:!0})})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Supplier",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"Name",span:2,children:null===o||void 0===o||null===(r=o.supplier)||void 0===r?void 0:r.name}),Object(ze.jsx)(Rn.b.Item,{label:"Phone",children:(null===o||void 0===o||null===(c=o.supplier)||void 0===c?void 0:c.phone)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Telephone",children:(null===o||void 0===o||null===(i=o.supplier)||void 0===i?void 0:i.landline)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Address",span:2,children:null===o||void 0===o||null===(s=o.supplier)||void 0===s?void 0:s.address}),Object(ze.jsx)(Rn.b.Item,{label:"Description",span:2,children:null===o||void 0===o||null===(l=o.supplier)||void 0===l?void 0:l.description})]})]}):Object(ze.jsxs)(bn.a,{gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Branch Destination"}),Object(ze.jsx)(pn.a,{className:"w-100",value:b.branchId,onChange:function(e){j("branchId",e)},children:d.map((function(e){return Object(ze.jsx)(pn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(ze.jsx)(Et,{name:"branchId"})]}),Object(ze.jsxs)(jn.a,{sm:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Delivery Type"}),Object(ze.jsxs)(pn.a,{className:"w-100",value:b.deliveryType,onChange:function(e){j("deliveryType",e)},children:[Object(ze.jsx)(pn.a.Option,{value:Q,children:"Delivery"},Q),Object(ze.jsx)(pn.a.Option,{value:U,children:"Pickup"},U)]}),Object(ze.jsx)(Et,{name:"deliveryType"})]}),Object(ze.jsxs)(jn.a,{span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Description"}),Object(ze.jsx)(_e.a,{value:b.description,onChange:function(e){j("description",e.target.value)}}),Object(ze.jsx)(Et,{name:"description"})]}),Object(ze.jsx)(jn.a,{span:24,children:Object(ze.jsx)(Cn.a,{children:"Supplier"})}),Object(ze.jsxs)(jn.a,{md:12,xs:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Supplier's Name"}),Object(ze.jsx)(pn.a,{className:"w-100",mode:"tags",value:null!==b.supplierName?[b.supplierName]:[],onDeselect:function(){j("supplierName",null),j("supplierAddress",null),j("supplierLandline",null),j("supplierPhone",null),j("supplierDescription",null)},onSelect:function(e){var t=e;j("supplierName",t);var n=u.find((function(e){return e.name===t}));j("supplierAddress",(null===n||void 0===n?void 0:n.address)||""),j("supplierLandline",(null===n||void 0===n?void 0:n.landline)||""),j("supplierPhone",(null===n||void 0===n?void 0:n.phone)||""),j("supplierDescription",(null===n||void 0===n?void 0:n.description)||"")},children:u.map((function(e){return Object(ze.jsx)(pn.a.Option,{value:e.name,children:e.name},e.id)}))}),Object(ze.jsx)(Et,{name:"supplierName"})]}),Object(ze.jsxs)(jn.a,{md:6,sm:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Supplier's Phone Number"}),Object(ze.jsx)(_e.a,{value:b.supplierPhone,onChange:function(e){j("supplierPhone",e.target.value)}}),Object(ze.jsx)(Et,{name:"supplierPhone"})]}),Object(ze.jsxs)(jn.a,{md:6,sm:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Supplier's Telephone Number"}),Object(ze.jsx)(_e.a,{value:b.supplierLandline,onChange:function(e){j("supplierLandline",e.target.value)}}),Object(ze.jsx)(Et,{name:"supplierLandline"})]}),Object(ze.jsxs)(jn.a,{span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Supplier's Address"}),Object(ze.jsx)(_e.a,{value:b.supplierAddress,onChange:function(e){j("supplierAddress",e.target.value)}}),Object(ze.jsx)(Et,{name:"supplierAddress"})]}),Object(ze.jsxs)(jn.a,{span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Supplier's Description"}),O?Object(ze.jsxs)(_e.a.Group,{compact:!0,children:[Object(ze.jsx)(_e.a,{style:{width:"calc(100% - 70px)"},value:b.supplierDescription,onChange:function(e){j("supplierDescription",e.target.value)}}),Object(ze.jsx)(Ae.a,{type:"primary",onClick:function(){m(!1)},children:"Save"})]}):Object(ze.jsx)(kn.a,{action:Object(ze.jsx)(Ae.a,{size:"small",type:"link",onClick:function(){m(!0)},children:"Edit"}),description:b.supplierDescription,type:"info",showIcon:!0}),Object(ze.jsx)(Et,{name:"supplierDescription"})]})]})})},Xn=function(e){var t=e.preorder,n=e.values,a=e.onSetFieldValue,r=Object(je.useState)(1),c=Object(Pe.a)(r,2),i=c[0],s=c[1],l=Object(je.useState)(P),o=Object(Pe.a)(l,2),d=o[0],u=o[1],b=Object(je.useState)(""),j=Object(Pe.a)(b,2),p=j[0],h=j[1],O=Object(je.useState)(""),m=Object(Pe.a)(O,2),v=m[0],x=m[1],f=Object(je.useState)([]),g=Object(Pe.a)(f,2),y=g[0],S=g[1],C=ct({params:{branchId:n.branchId,page:i,pageSize:d,search:p,status:v},options:{enabled:!!n.branchId}}),k=C.isFetching,I=C.data,T=I.total,_=I.products;Object(je.useEffect)((function(){var e=_.map((function(e){var t=n.preorderProducts.find((function(t){return t.productId===e.id}));return{key:e.id,name:Object(ze.jsx)(In.a,{checked:t,onChange:function(t){var r=[];r=t.target.checked?[].concat(Object(un.a)(n.preorderProducts),[{productId:e.id,productName:e.name,productStatus:e.status,productPrices:e.product_prices.map((function(e){return{branchProductId:e.branch_product_id,unitTypeId:e.unit_type_id,quantity:0}}))}]):n.preorderProducts.filter((function(t){return t.productId!==e.id})),a("preorderProducts",r)},children:e.name}),status:Object(ze.jsx)(At,{status:e.status})}}));S(e)}),[_,n]),Object(je.useEffect)((function(){t||(S([]),a("preorderProducts",[]))}),[t,n.branchId]);var N=Object(Tn.useDebouncedCallback)((function(e){h(e)}),500);return Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsxs)(bn.a,{className:"mb-4",gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Search"}),Object(ze.jsx)(_e.a,{allowClear:!0,onChange:function(e){return N(e.target.value.trim())}})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Status"}),Object(ze.jsxs)(pn.a,{className:"w-100",allowClear:!0,onChange:function(e){x(e)},children:[Object(ze.jsx)(pn.a.Option,{value:L,children:"Available"}),Object(ze.jsx)(pn.a.Option,{value:R,children:"Reorder"}),Object(ze.jsx)(pn.a.Option,{value:F,children:"Out of Stock"})]})]})]}),Object(ze.jsx)(rn.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Status",dataIndex:"status"}],dataSource:y,loading:k,pagination:{current:i,total:T,pageSize:d,onChange:function(e,t){s(e),u(t)},disabled:k,position:["bottomCenter"],pageSizeOptions:["10","20","50"]}})]})},Zn=function(e){var t=e.values,n=e.onSetFieldValue,a=Object(je.useState)([]),r=Object(Pe.a)(a,2),c=r[0],i=r[1],s=xt(),l=s.isFetching,o=s.data;Object(je.useEffect)((function(){i(t.preorderProducts.map((function(e,a){var r={key:e.productId,name:Object(ze.jsx)(In.a,{checked:!0,onChange:function(){n("preorderProducts",t.preorderProducts.filter((function(t){return t.productId!==e.productId})))},children:e.productName}),remarks:Object(ze.jsx)(_e.a,{className:"text-center",value:e.remarks||"",onChange:function(e){n("preorderProducts.".concat(a,".remarks"),e.target.value)}}),status:Object(ze.jsx)(At,{status:e.productStatus})};return e.productPrices.forEach((function(e,t){r[String(e.unitTypeId)]=Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(_e.a,{className:"text-center",type:"number",value:e.quantity||"",onChange:function(e){n("preorderProducts.".concat(a,".productPrices.").concat(t,".quantity"),Number(e.target.value))}}),Object(ze.jsx)(Et,{name:"preorderProducts.".concat(a,".productPrices.").concat(t,".quantity")})]})})),r})))}),[t,o]);var d=Object(je.useCallback)((function(){var e,n=Object(Ft.flatten)(null===t||void 0===t||null===(e=t.preorderProducts)||void 0===e?void 0:e.map((function(e){return e.productPrices.map((function(e){return e.unitTypeId}))}))),a=o.filter((function(e){return n.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(un.a)(a.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Remarks",dataIndex:"remarks"},{title:"Status",dataIndex:"status"}])}),[t,o]);return Object(ze.jsx)(rn.a,{columns:d(),dataSource:c,loading:l,pagination:!1,scroll:{x:800}})},Jn=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(ge.i)(),c=Object(ge.h)(),i=ut({id:r.preorderId}),l=i.isFetching,o=i.data,d=rt(),u=d.isFetching,b=d.data,j=it({params:{type:T}}),p=j.isFetching,h=j.data,O=ht({params:{ids:(null===o||void 0===o?void 0:o.preorder_products)?o.preorder_products.map((function(e){return e.product.id})).join(","):null},options:{enabled:!!o}}),m=O.isFetching,v=O.data.products,x=Object(Oe.useMutation)((function(e){var t=e.branchId,n=e.deliveryType,a=e.description,r=e.supplier,c=e.preorderProducts;return Xe.create({body:{branch_id:t,delivery_type:n,description:a,supplier:r,preorder_products:c}})})),f=x.mutateAsync,g=x.isLoading,y=bt(),C=y.mutateAsync,P=y.isLoading;Object(je.useEffect)((function(){if(o&&0!==v.length){var e={};null===o||void 0===o||o.preorder_products.forEach((function(t){var n=t.branch_product.product_price.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)}));var t=Object.keys(e).map((function(t){var n=e[t][0],a=e[t].map((function(e){return{id:e.branch_product.product_price.id,branchProductId:e.branch_product.id,unitTypeId:e.unit_type_id,quantity:Number(e.quantity)}})),r=a.map((function(e){return e.id})),c=v.find((function(e){return e.id===n.product.id}));if(c){var i=((null===c||void 0===c?void 0:c.product_prices)||[]).filter((function(e){var t=e.id;return!r.includes(t)}));i.length>0&&(i=i.forEach((function(e){a.push({branchProductId:n.branch_product.id,unitTypeId:e.unit_type_id,quantity:0})})))}return{productId:n.product.id,productName:n.product.name,productStatus:null,productPrices:a,remarks:n.remarks||""}}));a(t)}}),[o,v]);var k=Object(je.useCallback)((function(){var e;return{defaultValues:{branchId:null===o||void 0===o||null===(e=o.branch)||void 0===e?void 0:e.id,deliveryType:null,description:null,supplierName:null,supplierAddress:null,supplierLandline:null,supplierPhone:null,supplierDescription:null,preorderProducts:n},schema:ft.c().shape(Object(s.a)(Object(s.a)({branchId:ft.d().required().label("Branch").nullable()},o?{}:{deliveryType:ft.d().required().label("Delivery Type").nullable(),description:ft.d().label("Description").nullable(),supplierName:ft.d().required().label("Supplier Name").nullable(),supplierAddress:ft.d().required().label("Supplier Address").nullable(),supplierLandline:ft.d().label("Supplier Telephone").nullable(),supplierPhone:ft.d().label("Supplier Phone").nullable(),supplierDescription:ft.d().label("Supplier Description").nullable()}),{},{preorderProducts:ft.a().of(ft.c().shape({productId:ft.b().required(),productName:ft.d().required(),productStatus:ft.d().nullable(),remarks:ft.d().nullable(),productPrices:ft.a().of(ft.c().shape({branchProductId:ft.b().required().label("Product"),unitTypeId:ft.b().required(),quantity:ft.b().required().min(0,"Must not be negative").label("Quantity"),remarks:ft.d().label("Remarks")}))}))}))}}),[o,n]),I=function(e){cn.a.success({title:"Success",content:"Preorder is successfully created.",keyboard:!1,okText:"View Preorder",onOk:function(){c("/preorders/".concat(e))}})};return Object(ze.jsx)(Xt,{title:o?"Edit Preorder":"Create Preorder",children:Object(ze.jsx)(zt.a,{spinning:l||u||p||m,children:Object(ze.jsx)(Re.c,{initialValues:k().defaultValues,validationSchema:k().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ce.a)(Se.a.mark((function e(t,n){var a,r,c,i,s,l,d,u;return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.setFieldError,!(t.preorderProducts.length>0)){e.next=31;break}if(e.prev=2,r=h.find((function(e){return e.name===t.supplierName})),!((c=Object(Ft.flatten)(t.preorderProducts.map((function(e){return e.productPrices.filter((function(e){return e.quantity>0})).map((function(t){return{branch_product_id:t.branchProductId,quantity:t.quantity,remarks:e.remarks}}))})))).length>0)){e.next=23;break}if(i=null,!o){e.next=15;break}return e.next=10,C({id:o.id,preorderProducts:c});case 10:s=e.sent,l=s.data,i=l,e.next=20;break;case 15:return e.next=17,f({branchId:t.branchId,deliveryType:t.deliveryType,description:t.description,supplier:{id:null===r||void 0===r?void 0:r.id,name:t.supplierName,description:t.supplierDescription,address:t.supplierAddress,landline:t.supplierLandline,phone:t.supplierPhone},preorderProducts:c});case 17:d=e.sent,u=d.data,i=u;case 20:I(i.id),e.next=24;break;case 23:yn.b.error("Please add quantity to products first");case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(2),a("response",S);case 29:e.next=32;break;case 31:yn.b.error("Please add a product first");case 32:case"end":return e.stop()}}),e,null,[[2,26]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(ze.jsx)(Re.b,{className:"w-100",children:Object(ze.jsxs)(zt.a,{spinning:g||P,children:[Object(ze.jsx)(Wn,{branches:b,preorder:o,suppliers:h,values:t,onSetFieldValue:n}),null!==t.branchId&&Object(ze.jsx)(Le,{children:Object(ze.jsxs)(dn.a,{defaultActiveKey:Hn,size:"large",type:"card",children:[Object(ze.jsx)(dn.a.TabPane,{tab:"All",children:Object(ze.jsx)(Xn,{preorder:o,values:t,onSetFieldValue:n})},Hn),Object(ze.jsx)(dn.a.TabPane,{tab:"Selected Products (".concat(t.preorderProducts.length,")"),children:Object(ze.jsx)(Zn,{values:t,onSetFieldValue:n})},Kn)]})}),Object(ze.jsx)(Le,{children:Object(ze.jsx)(bn.a,{justify:"end",children:Object(ze.jsx)(jn.a,{children:Object(ze.jsx)(Ae.a,{htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})})]})})}})})})},$n=function(e){var t=e.preorder,n=e.preorderProducts,a=e.columns,r=e.onSuccess,c=e.onClose,i=Object(je.useState)(!1),s=Object(Pe.a)(i,2),l=s[0],o=s[1],d=Object(je.useState)([]),u=Object(Pe.a)(d,2),b=u[0],j=u[1],p=Object(je.useState)([]),h=Object(Pe.a)(p,2),O=h[0],m=h[1],v=Object(je.useRef)();Object(je.useEffect)((function(){var e=[],t=0;j(Object.keys(n).map((function(a){var r={key:a,name:a};return n[a].forEach((function(n){var a=n.branch_product.product_price.unit_type,c="".concat(t,".quantity");r[String(a)]=Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(_e.a,{style:{textAlign:"center"},type:"number",onChange:function(e){v.current.setFieldValue(c,Number(e.target.value))}}),Object(ze.jsx)(Et,{name:c})]}),e.push({preorderProductId:n.id,quantity:""}),t++})),r}))),m(e)}),[n]);var x=Object(je.useCallback)((function(){return{defaultValues:O,schema:ft.a().of(ft.c().shape({preorderProductId:ft.b().required(),quantity:ft.b().required("Required")}))}}),[O]);return Object(ze.jsx)(cn.a,{footer:[Object(ze.jsx)(Ae.a,{disabled:l,size:"large",onClick:c,children:"Cancel"},"btnCancel"),Object(ze.jsx)(Ae.a,{loading:l,size:"large",type:"primary",onClick:function(){v.current.submitForm()},children:"Submit"},"btnSubmit")],title:"[Create] Preorder Transaction",width:800,centered:!0,closable:!0,visible:!0,onCancel:c,children:Object(ze.jsx)(Re.c,{initialValues:x().defaultValues,innerRef:v,validationSchema:x().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ce.a)(Se.a.mark((function e(n){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,Ze.create({body:{preorder_id:t.id,preorder_transaction_products:n.map((function(e){return{preorder_product_id:e.preorderProductId,quantity:e.quantity}}))}});case 4:r(),c(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),yn.b.error(S);case 11:return e.prev=11,o(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),children:Object(ze.jsx)(Re.b,{children:Object(ze.jsx)(rn.a,{columns:a,dataSource:b,loading:l,pagination:!1,scroll:{x:600}})})})})},ea=function(e){var t=e.preorderTransaction,n=e.unitTypes,a=e.onClose,r=Object(je.useState)([]),c=Object(Pe.a)(r,2),i=c[0],s=c[1],l=Object(je.useState)([]),o=Object(Pe.a)(l,2),d=o[0],u=o[1];Object(je.useEffect)((function(){var e={};t.preorder_transaction_products.forEach((function(t){var n=t.product_name;void 0===e[n]&&(e[n]=[]),e[n].push(t)}));var n=[];u(Object.keys(e).map((function(t){var a={key:t,name:t};return e[t].forEach((function(e){var t=e.unit_type_id;n.push(t),a[String(t)]=Number(e.quantity)})),a}))),s(n)}),[t]);var b=Object(je.useCallback)((function(){var e=n.filter((function(e){return i.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(un.a)(e.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))))}),[i,n]);return Object(ze.jsxs)(cn.a,{footer:[Object(ze.jsx)(Ae.a,{size:"large",onClick:a,children:"Close"},"btnCancel")],title:"Preorder Transaction",width:800,centered:!0,closable:!0,visible:!0,onCancel:a,children:[Object(ze.jsxs)(Rn.b,{column:1,labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"ID",children:t.id}),Object(ze.jsxs)(Rn.b.Item,{label:"Received By",children:[t.user.first_name," ",t.user.last_name]}),Object(ze.jsx)(Rn.b.Item,{label:"Date Created",children:Ut(t.datetime_created)})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsx)(rn.a,{columns:b(),dataSource:d,pagination:!1,scroll:{x:600}})]})},ta=[{title:"ID",dataIndex:"id"},{title:"Date Created",dataIndex:"datetime_created"},{title:"Received By",dataIndex:"received_by"},{title:"Action",dataIndex:"actions"}],na=function(){var e,t,n,a,r,c,i,s,l,o=Object(je.useState)(!1),d=Object(Pe.a)(o,2),u=d[0],b=d[1],j=Object(je.useState)(!1),p=Object(Pe.a)(j,2),h=p[0],O=p[1],m=Object(je.useState)([]),v=Object(Pe.a)(m,2),x=v[0],f=v[1],g=Object(je.useState)({}),y=Object(Pe.a)(g,2),P=y[0],k=y[1],I=Object(je.useState)([]),T=Object(Pe.a)(I,2),_=T[0],N=T[1],A=Object(je.useState)(!1),D=Object(Pe.a)(A,2),E=D[0],w=D[1],z=Object(je.useState)([]),L=Object(Pe.a)(z,2),R=L[0],F=L[1],q=Object(je.useState)(null),B=Object(Pe.a)(q,2),M=B[0],Y=B[1],G=Object(je.useState)(""),U=Object(Pe.a)(G,2),Q=U[0],H=U[1],K=Object(je.useState)(!1),W=Object(Pe.a)(K,2),X=W[0],Z=W[1],J=Object(ge.i)(),$=xt(),ee=$.isFetching,te=$.data,ne=ut({id:J.preorderId}),ae=ne.isFetching,re=ne.data,ce=ne.refetch,ie=bt(),se=ie.isLoading,le=ie.mutateAsync;Object(je.useEffect)((function(){var e={};null===re||void 0===re||re.preorder_products.forEach((function(t){var n=t.branch_product.product_price.product.name;void 0===e[n]&&(e[n]=[]),e[n].push(t)})),k(e);var t=[];f(Object.keys(e).map((function(n){var a,r={key:n,name:n,remarks:(null===(a=e[n][0])||void 0===a?void 0:a.remarks)||""};return e[n].forEach((function(e){var n=e.branch_product.product_price.unit_type;t.push(n),r[String(n)]="\n          ".concat(Number(e.fulfilled_quantity)," / ").concat(Number(e.quantity))})),r}))),N(t),H((null===re||void 0===re?void 0:re.description)||"")}),[re]),Object(je.useEffect)((function(){(null===re||void 0===re?void 0:re.preorder_transactions)&&F(re.preorder_transactions.map((function(e){return{row:e.id,id:e.id,datetime_created:Ut(e.datetime_created),received_by:"".concat(e.user.first_name," ").concat(e.user.last_name),actions:Object(ze.jsx)(Ae.a,{type:"link",onClick:function(){Y(e)},children:"View"})}})))}),[re]);var oe=Object(je.useCallback)((function(){var e=te.filter((function(e){return _.includes(e.id)}));return[{title:"Name",dataIndex:"name"}].concat(Object(un.a)(e.map((function(e){return{title:e.name,dataIndex:String(e.id),align:"center"}}))),[{title:"Remarks",dataIndex:"remarks"}])}),[_,te]),de=function(e){b(!0),Xe.edit({id:J.preorderId,body:{status:e}}).then(ce).catch((function(e){console.error("Error: ",e),yn.b.error(S)})).finally((function(){b(!1)}))};return Object(ze.jsx)(Xt,{className:"ViewPreorder",title:"Preorder",children:Object(ze.jsxs)(zt.a,{spinning:ae||ee||u,children:[Object(ze.jsxs)(Le,{children:[Object(ze.jsxs)(bn.a,{className:"ViewPreorder_setPreorderAsComplete",gutter:[25,12],justify:"space-between",children:[Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{loading:h,size:"large",type:"primary",ghost:!0,onClick:function(){re?(O(!0),new Fn.a("p","pt","a4").html(function(e,t){var n,a,r,c,i,s,l,o=e.preorder_products.map((function(e){var n=t.find((function(t){return t.id===e.unit_type_id})).name;return{name:"".concat(e.product.name," (").concat(n,")"),quantity:e.quantity}}));return'\n\t\t<div style="width: 430pt; font-family: \'Courier\', Geneva, Tahoma, sans-serif; font-size: 10pt; line-height: 125%">\n\t\t\t<div style="text-align: center;">\n\t\t\t\t\t<div style="font-size: 15pt;">Marigold Store</div>\n\t\t\t\t\t<div>[ORDER SLIP]</div>\n\t\t\t</div>\n\n\t\t\t<br />\n\n\t\t\t<table style="width: 100%;">\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Order ID:</td>\n\t\t\t\t\t<td>'.concat(e.id,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Created By:</td>\n\t\t\t\t\t<td>').concat(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.first_name," ").concat(null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.last_name,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Delivery Type:</td>\n\t\t\t\t\t<td>').concat(Object(Ft.upperFirst)(null===e||void 0===e?void 0:e.delivery_type),'</td>\n\t\t\t\t</tr>\n                <tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Datetime Created:</td>\n\t\t\t\t\t<td>').concat(Ut(null===e||void 0===e?void 0:e.datetime_created),'</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<br />\n\n      <table style="width: 100%;">\n\t\t\t\t<tr>\n\t\t\t\t\t<td style="width: 200pt; font-weight: bold;">Supplier Name:</td>\n\t\t\t\t\t<td>').concat(null===e||void 0===e||null===(r=e.supplier)||void 0===r?void 0:r.name,'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Phone:</td>\n          <td>').concat((null===e||void 0===e||null===(c=e.supplier)||void 0===c?void 0:c.phone)||"",'</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Telephone:</td>\n          <td>').concat((null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.landline)||"",'</td>\n\t\t\t\t</tr>\n        <tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Address:</td>\n          <td>').concat(null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.address,'</td>\n\t\t\t\t</tr>\n        <tr>\n          <td style="width: 200pt; font-weight: bold;">Supplier Description:</td>\n          <td>').concat(null===e||void 0===e||null===(l=e.supplier)||void 0===l?void 0:l.description,'</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<br />\n\n\t\t\t<table style="width: 100%;">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th style="text-align: left">Name</th>\n\t\t\t\t\t\t<th style="text-align: center">Quantity</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>  \n\t\t\t\t<tbody>\n\t\t\t\t\t').concat(o.map((function(e){return'\t\n                <tr>\n                    <td style="width: 200pt;">'.concat(e.name,'</td>\n                    <td style="text-align: center">').concat(e.quantity,"</td>\n                </tr>")})).join(""),"\n\t\t\t\t</tbody>\n\t\t\t</table>\t\t\t\n\t\t</div>\n\t")}(re,te),{x:10,y:10,filename:"Preorder_".concat(re.id),callback:function(e){window.open(e.output("bloburl").toString()),O(!1)}})):yn.b.error(S)},children:"Print Preorder"})}),(null===re||void 0===re?void 0:re.status)===V.APPROVED&&(null===re||void 0===re||null===(e=re.preorder_transactions)||void 0===e?void 0:e.length)>0&&Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{className:"ViewPreorder_setPreorderAsComplete_button",size:"large",type:"primary",onClick:function(){de(V.DELIVERED)},children:"Set Preorder As Complete"})})]}),Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"ID",span:2,children:null===re||void 0===re?void 0:re.id}),Object(ze.jsx)(Rn.b.Item,{label:"Branch",children:null===re||void 0===re||null===(t=re.branch)||void 0===t?void 0:t.name}),Object(ze.jsx)(Rn.b.Item,{label:"Delivery Type",children:Object(Ft.upperFirst)(null===re||void 0===re?void 0:re.delivery_type)}),Object(ze.jsxs)(Rn.b.Item,{label:"Created By",children:[null===re||void 0===re||null===(n=re.user)||void 0===n?void 0:n.first_name," ",null===re||void 0===re||null===(a=re.user)||void 0===a?void 0:a.last_name]}),Object(ze.jsx)(Rn.b.Item,{label:"Datetime Created",children:Ut(null===re||void 0===re?void 0:re.datetime_created)}),Object(ze.jsx)(Rn.b.Item,{label:"Datetime Fulfilled",children:Ut(null===re||void 0===re?void 0:re.datetime_fulfilled)}),Object(ze.jsx)(Rn.b.Item,{label:"Status",children:Object(ze.jsx)(Jt,{status:null===re||void 0===re?void 0:re.status})}),Object(ze.jsx)(Rn.b.Item,{label:"Description",span:2,children:X?Object(ze.jsxs)(_e.a.Group,{compact:!0,children:[Object(ze.jsx)(_e.a,{style:{width:"calc(100% - 80px)"},value:Q,onChange:function(e){H(e.target.value)}}),Object(ze.jsx)(Ae.a,{loading:se,type:"primary",onClick:Object(Ce.a)(Se.a.mark((function e(){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le({id:re.id,description:Q});case 2:Z(!1);case 3:case"end":return e.stop()}}),e)}))),children:"Save"})]}):Object(ze.jsx)(kn.a,{action:Object(ze.jsx)(Ae.a,{size:"small",type:"link",onClick:function(){Z(!0)},children:"Edit"}),description:Q,type:"info",showIcon:!0})})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsxs)(Rn.b,{column:{xs:1,sm:1,md:2},labelStyle:{fontWeight:"bold"},size:"small",title:"Supplier",bordered:!0,children:[Object(ze.jsx)(Rn.b.Item,{label:"Name",span:2,children:null===re||void 0===re||null===(r=re.supplier)||void 0===r?void 0:r.name}),Object(ze.jsx)(Rn.b.Item,{label:"Phone",children:(null===re||void 0===re||null===(c=re.supplier)||void 0===c?void 0:c.phone)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Telephone",children:(null===re||void 0===re||null===(i=re.supplier)||void 0===i?void 0:i.landline)||C}),Object(ze.jsx)(Rn.b.Item,{label:"Address",span:2,children:null===re||void 0===re||null===(s=re.supplier)||void 0===s?void 0:s.address}),Object(ze.jsx)(Rn.b.Item,{label:"Description",span:2,children:null===re||void 0===re||null===(l=re.supplier)||void 0===l?void 0:l.description})]}),Object(ze.jsx)(Cn.a,{}),(null===re||void 0===re?void 0:re.status)===V.PENDING&&Object(ze.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(ze.jsx)(Ae.a,{size:"large",type:"primary",ghost:!0,children:Object(ze.jsx)(fe.b,{to:"/preorders/".concat(null===re||void 0===re?void 0:re.id,"/edit"),children:"Edit Products"})})}),Object(ze.jsx)(rn.a,{columns:oe(),dataSource:x,pagination:!1,scroll:{x:800}}),(null===re||void 0===re?void 0:re.status)===V.PENDING&&Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(Cn.a,{}),Object(ze.jsxs)(bn.a,{gutter:[25,12],children:[Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{size:"large",block:!0,danger:!0,onClick:function(){de(V.CANCELLED)},children:"Cancel Preorder"})}),Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(Ae.a,{size:"large",type:"primary",block:!0,onClick:function(){de(V.APPROVED)},children:"Approve Preorder"})})]})]})]}),[V.APPROVED,V.DELIVERED].includes(null===re||void 0===re?void 0:re.status)&&Object(ze.jsxs)(Le,{children:[Object(ze.jsxs)(bn.a,{className:"mb-4",justify:"space-between",children:[Object(ze.jsx)(jn.a,{children:Object(ze.jsx)(Ne.a.Title,{level:4,children:"Transactions"})}),(null===re||void 0===re?void 0:re.status)===V.APPROVED&&Object(ze.jsx)(jn.a,{children:Object(ze.jsxs)(Ae.a,{size:"large",type:"primary",onClick:function(){w(!0)},children:[Object(ze.jsx)(nn.a,{})," Create Transaction"]})})]}),Object(ze.jsx)(rn.a,{columns:ta,dataSource:R,pagination:!1,scroll:{x:800}})]}),E&&Object(ze.jsx)($n,{columns:oe(),preorder:re,preorderProducts:P,onClose:function(){w(!1)},onSuccess:function(){ce(),w(!1)}}),M&&Object(ze.jsx)(ea,{preorderTransaction:M,unitTypes:te,onClose:function(){Y(null)}})]})})},aa=(n(256),n(454)),ra=function(e){var t,n=e.product,a=e.unitTypes,r=e.onClose;return Object(ze.jsxs)(cn.a,{className:"ViewProductModal Modal__large Modal__hasFooter",footer:[Object(ze.jsx)(Ae.a,{onClick:r,children:"Close"})],title:"View Product",centered:!0,closable:!0,visible:!0,onCancel:r,children:[Object(ze.jsxs)(bn.a,{gutter:[8,8],children:[Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Name: "})}),Object(ze.jsx)(jn.a,{lg:12,children:n.name}),Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Unit Cost: "})}),Object(ze.jsx)(jn.a,{lg:12,children:Gt(n.unit_cost)}),Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Vat Type: "})}),Object(ze.jsx)(jn.a,{lg:12,children:Object(Ft.upperCase)(n.vat_type)})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsx)(aa.a,{children:null===n||void 0===n||null===(t=n.product_prices)||void 0===t?void 0:t.map((function(e){var t=a.find((function(t){return t.id===e.unit_type_id})).name||"";return Object(ze.jsx)(aa.a.Panel,{header:t,children:Object(ze.jsxs)(bn.a,{gutter:[8,8],children:[Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price Market: "})}),Object(ze.jsx)(jn.a,{lg:12,children:Gt(e.price_market)}),Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price Delivery: "})}),Object(ze.jsx)(jn.a,{lg:12,children:Gt(e.price_delivery)}),Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price Pickup: "})}),Object(ze.jsx)(jn.a,{lg:12,children:Gt(e.price_pickup)}),Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price Special: "})}),Object(ze.jsx)(jn.a,{lg:12,children:Gt(e.price_special)}),Object(ze.jsx)(jn.a,{lg:12,children:Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Reorder Point: "})}),Object(ze.jsx)(jn.a,{lg:12,children:e.reorder_point})]})},String(e.id))}))})]})},ca=function(e){var t=e.onSetPriceType,n=Object(fe.c)(),a=Object(Pe.a)(n,1)[0],r=st().setSearchParams,c=Object(hn.a)((function(e){r({search:e})}),500);return Object(ze.jsxs)(bn.a,{className:"mb-4",gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Search"}),Object(ze.jsx)(_e.a,{defaultValue:a.get("search"),allowClear:!0,onChange:function(e){return c(e.target.value.trim())}})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price Type"}),Object(ze.jsx)(Pn.a.Group,{className:"w-100",defaultValue:D,options:[{label:"Delivery",value:D},{label:"Market",value:E},{label:"Pickup",value:w},{label:"Special",value:z}],optionType:"button",onChange:function(e){t(e.target.value)}})]})]})},ia=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(je.useState)(D),c=Object(Pe.a)(r,2),i=c[0],s=c[1],l=Object(je.useState)(null),o=Object(Pe.a)(l,2),d=o[0],u=o[1],b=Object(je.useState)(!1),j=Object(Pe.a)(b,2),p=j[0],h=j[1],O=Object(fe.c)(),m=Object(Pe.a)(O,1)[0],v=Object(ge.h)(),x=st().setSearchParams,f=xt(),g=f.isFetching,y=f.data,C=ht({params:{page:m.get("page"),pageSize:m.get("pageSize"),search:m.get("search")}}),k=C.isFetching,I=C.data,T=I.total,_=I.products,N=C.refetch;Object(je.useEffect)((function(){var e=_.map((function(e){var t={key:e.id,name:Object(ze.jsx)(Ae.a,{className:"pa-0",type:"link",onClick:function(){u(e)},children:e.name}),unitCost:Gt(e.unit_cost),actions:Object(ze.jsxs)(Te.b,{size:"small",children:[Object(ze.jsx)(Ae.a,{type:"primary",ghost:!0,onClick:function(){v("/products/".concat(e.id))},children:"Edit"}),Object(ze.jsx)(an.a,{cancelText:"Cancel",okButtonProps:{danger:!0},okText:"Delete",placement:"topLeft",title:"Are you sure you want to delete ".concat(e.name,"?"),onConfirm:function(){var t;t=e.id,h(!0),$e.delete(t).then((function(){N()})).catch((function(){yn.b.error(S)})).finally((function(){h(!1)}))},children:Object(ze.jsx)(Ae.a,{type:"primary",danger:!0,ghost:!0,children:"Delete"})})]})};return e.product_prices.forEach((function(e){t[String(e.unit_type_id)]=Gt(e["price_".concat(i)])})),t}));a(e)}),[_,i]);var A=Object(je.useCallback)((function(){var e=Object(Ft.flatten)(null===_||void 0===_?void 0:_.map((function(e){return e.product_prices.map((function(e){return e.unit_type_id}))}))),t=y.filter((function(t){return e.includes(t.id)}));return[{title:"Name",dataIndex:"name",width:250,fixed:"left"},{title:"Unit Cost",dataIndex:"unitCost"}].concat(Object(un.a)(t.map((function(e){return{title:e.name,dataIndex:String(e.id)}}))),[{title:"Actions",dataIndex:"actions"}])}),[_,y]);return Object(ze.jsxs)(Xt,{className:"Products",title:"Products",children:[Object(ze.jsxs)(Le,{children:[Object(ze.jsx)("div",{className:"mb-4 d-flex justify-end",children:Object(ze.jsxs)(Ae.a,{size:"large",type:"primary",onClick:function(){v("create")},children:[Object(ze.jsx)(nn.a,{})," Create Product"]})}),Object(ze.jsx)(ca,{onSetPriceType:s}),Object(ze.jsx)(rn.a,{columns:A(),dataSource:n,loading:k||g||p,pagination:{current:Number(m.get("page"))||1,total:T,pageSize:Number(m.get("pageSize"))||P,onChange:function(e,t){x({page:e,pageSize:t})},disabled:0===_.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:1500}})]}),d&&Object(ze.jsx)(ra,{product:d,unitTypes:y,onClose:function(){u(null)}})]})},sa=n(72),la=function(e){var t=e.index,n=e.isCreate,a=e.unitTypes,r=e.values,c=e.onRemoveProductPrice,i=e.onSetFieldValue;return Object(ze.jsxs)(bn.a,{gutter:[4,4],children:[Object(ze.jsxs)(jn.a,{sm:6,xs:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price (Market)"}),Object(ze.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.priceMarket,onChange:function(e){i("productPrices.".concat(t,".priceMarket"),e.target.value)}}),Object(ze.jsx)(Re.a,{name:"productPrices.".concat(t,".priceMarket"),render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{sm:6,xs:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price (Delivery)"}),Object(ze.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.priceDelivery,onChange:function(e){i("productPrices.".concat(t,".priceDelivery"),e.target.value)}}),Object(ze.jsx)(Re.a,{name:"productPrices.".concat(t,".priceDelivery"),render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{sm:6,xs:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price (Pickup)"}),Object(ze.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.pricePickup,onChange:function(e){i("productPrices.".concat(t,".pricePickup"),e.target.value)}}),Object(ze.jsx)(Re.a,{name:"productPrices.".concat(t,".pricePickup"),render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{sm:6,xs:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Price (Special)"}),Object(ze.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:r.priceSpecial,onChange:function(e){i("productPrices.".concat(t,".priceSpecial"),e.target.value)}}),Object(ze.jsx)(Re.a,{name:"productPrices.".concat(t,".priceSpecial"),render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{sm:6,xs:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Reorder Point"}),Object(ze.jsx)(_e.a,{type:"number",value:r.reorderPoint,onChange:function(e){i("productPrices.".concat(t,".reorderPoint"),e.target.value)}}),Object(ze.jsx)(Re.a,{name:"productPrices.".concat(t,".reorderPoint"),render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{sm:6,xs:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Unit Type"}),Object(ze.jsx)(pn.a,{className:"w-100",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},optionFilterProp:"children",value:r.unitType,showSearch:!0,onChange:function(e){i("productPrices.".concat(t,".unitType"),e)},children:a.map((function(e){return Object(ze.jsx)(pn.a.Option,{value:e.id,children:e.name},e.id)}))}),Object(ze.jsx)(Re.a,{name:"productPrices.".concat(t,".unitType"),render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),n&&Object(ze.jsx)(jn.a,{sm:12,xs:24,children:Object(ze.jsx)(bn.a,{align:"middle",justify:"center",style:{height:"100%"},children:Object(ze.jsx)(jn.a,{children:Object(ze.jsxs)(Ae.a,{htmlType:"button",type:"dashed",danger:!0,onClick:c,children:[Object(ze.jsx)(sa.a,{})," DELETE PRICE"]})})})})]})},oa=function(){var e=Object(je.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(ge.i)(),c=Object(ge.h)(),i=xt(),s=i.isFetching,l=i.data,o=pt({id:r.productId}),d=o.isFetching,u=o.data,b=void 0===r.productId,j=Object(je.useCallback)((function(){return{defaultValues:{id:null===u||void 0===u?void 0:u.id,name:(null===u||void 0===u?void 0:u.name)||"",unitCost:(null===u||void 0===u?void 0:u.unit_cost)||"",vatType:(null===u||void 0===u?void 0:u.vat_type)||"",productPrices:(null===u||void 0===u?void 0:u.product_prices.map((function(e){return{id:e.id,priceMarket:Number(e.price_market),priceDelivery:Number(e.price_delivery),pricePickup:Number(e.price_pickup),priceSpecial:Number(e.price_special),reorderPoint:Number(e.reorder_point),unitType:e.unit_type_id}})))||[]},schema:ft.c().shape({name:ft.d().required().label("Name"),unitCost:ft.d().required().label("Unit Cost"),vatType:ft.d().required().label("VAT"),productPrices:ft.a().of(ft.c().shape({priceMarket:ft.b().positive("Must be greater than zero").required("Required"),priceDelivery:ft.b().positive("Must be greater than zero").required("Required"),pricePickup:ft.b().positive("Must be greater than zero").required("Required"),priceSpecial:ft.b().positive("Must be greater than zero").required("Required"),reorderPoint:ft.b(),unitType:ft.d().required("Required")}))})}}),[u]),p=function(e){var t=b?"created":"updated";cn.a.success({title:"Success",content:"".concat(e.name," is successfully ").concat(t,". Press the button below to go back to the products screen."),keyboard:!1,okText:"Proceed",onOk:function(){c("/products")}})};return Object(ze.jsx)(Xt,{title:"Products",children:Object(ze.jsx)(zt.a,{spinning:s||d||n,children:Object(ze.jsx)(Le,{children:Object(ze.jsx)(Re.c,{initialValues:j().defaultValues,validationSchema:j().schema,enableReinitialize:!0,onSubmit:function(){var e=Object(Ce.a)(Se.a.mark((function e(t,n){var r,c,i,s;return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.setFieldError,a(!0),!(t.productPrices.length>0)){e.next=18;break}return e.prev=3,c=b?$e.create:$e.edit,e.next=7,c({id:t.id,body:{name:t.name,unit_cost:t.unitCost,vat_type:t.vatType,product_prices:t.productPrices.map((function(e){return{id:e.id,unit_type_id:e.unitType,price_market:e.priceMarket,price_delivery:e.priceDelivery,price_pickup:e.pricePickup,price_special:e.priceSpecial,reorder_point:e.reorderPoint||0}}))}});case 7:i=e.sent,s=i.data,p(s),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0),r("response",S);case 16:e.next=19;break;case 18:yn.b.error("Please add a product price first");case 19:a(!1);case 20:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.setFieldValue;return Object(ze.jsxs)(Re.b,{className:"w-100",children:[Object(ze.jsx)(Re.a,{name:"response",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}}),Object(ze.jsxs)(bn.a,{gutter:[24,24],children:[Object(ze.jsxs)(jn.a,{lg:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Name"}),Object(ze.jsx)(_e.a,{value:t.name,onChange:function(e){n("name",e.target.value)}}),Object(ze.jsx)(Re.a,{name:"name",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{lg:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Unit Cost"}),Object(ze.jsx)(_e.a,{prefix:"\u20b1",type:"number",value:t.unitCost,onChange:function(e){n("unitCost",e.target.value)}}),Object(ze.jsx)(Re.a,{name:"unitCost",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]}),Object(ze.jsxs)(jn.a,{lg:12,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"VAT"}),Object(ze.jsx)(Pn.a.Group,{buttonStyle:"solid",className:"w-100",options:[{label:"VAT",value:N},{label:"VAT-Exempted",value:A}],optionType:"button",value:t.vatType,onChange:function(e){n("vatType",e.target.value)}}),Object(ze.jsx)(Re.a,{name:"vatType",render:function(e){return Object(ze.jsx)(Ne.a.Text,{type:"danger",children:e})}})]})]}),Object(ze.jsx)(Cn.a,{children:"PRICES"}),Object(ze.jsxs)(bn.a,{gutter:[16,32],children:[t.productPrices.map((function(e,a){return Object(ze.jsx)(jn.a,{span:24,children:Object(ze.jsx)(la,{index:a,isCreate:b,unitTypes:l,values:e,onRemoveProductPrice:function(){n("productPrices",function(e,t){return t.productPrices.filter((function(t,n){return n!==e}))}(a,t))},onSetFieldValue:n})},a)})),Object(ze.jsx)(jn.a,{span:24,children:Object(ze.jsxs)(Ae.a,{className:"ModifyProduct_btnAddPrice",htmlType:"button",size:"large",type:"primary",ghost:!0,onClick:function(){n("productPrices",function(e){return[].concat(Object(un.a)(e.productPrices),[{priceMarket:"",priceDelivery:"",pricePickup:"",priceSpecial:"",reorderPoint:"",unitType:""}])}(t))},children:[Object(ze.jsx)(nn.a,{})," Add Price"]})})]}),Object(ze.jsx)(Cn.a,{}),Object(ze.jsx)(bn.a,{justify:"end",children:Object(ze.jsx)(jn.a,{children:Object(ze.jsx)(Ae.a,{className:"ModifyProduct_btnSubmit",htmlType:"submit",size:"large",type:"primary",children:"Submit"})})})]})}})})})})},da=[{title:"Rank",dataIndex:"rank"},{title:"Name",dataIndex:"name"},{title:"Total Purchase",dataIndex:"total_purchase"}],ua=function(){var e,t,n,a=Object(je.useState)(W.DAILY),r=Object(Pe.a)(a,2),c=r[0],i=r[1],s=Object(fe.c)(),l=Object(Pe.a)(s,1)[0],o=st().setSearchParams,d=(null===(e=l.get("dateRange"))||void 0===e?void 0:e.toString())||W.DAILY;return Object(je.useEffect)((function(){![W.DAILY,W.MONTHLY].includes(d)&&(null===d||void 0===d?void 0:d.indexOf(","))?i(W.DATE_RANGE):i(d)}),[d]),Object(ze.jsx)(bn.a,{className:"Products_filter",gutter:[16,16],children:Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{style:{width:"100%",display:"block"},strong:!0,children:"Date Range"}),Object(ze.jsx)(Pn.a.Group,{options:[{label:"Daily",value:W.DAILY},{label:"Monthly",value:W.MONTHLY},{label:"Select Date Range",value:W.DATE_RANGE}],optionType:"button",value:c,onChange:function(e){var t=e.target.value;i(t),t!==W.DATE_RANGE&&o({dateRange:t})}}),c===W.DATE_RANGE&&Object(ze.jsx)(Sn.a.RangePicker,{defaultPickerValue:2===(null===(t=d.split(","))||void 0===t?void 0:t.length)?[Bt()(d.split(",")[0]),Bt()(d.split(",")[1])]:void 0,defaultValue:2===(null===(n=d.split(","))||void 0===n?void 0:n.length)?[Bt()(d.split(",")[0]),Bt()(d.split(",")[1])]:void 0,format:"MM/DD/YY",onCalendarChange:function(e,t){(null===e||void 0===e?void 0:e[0])&&(null===e||void 0===e?void 0:e[1])&&o({dateRange:t.join(",")})}})]})})},ba=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(fe.c)(),c=Object(Pe.a)(r,1)[0],i=st().setSearchParams,s=Ot({params:{page:c.get("page"),pageSize:c.get("pageSize"),dateRange:c.get("dateRange")||W.DAILY}}),l=s.isFetching,o=s.data,d=o.total,u=o.customers;return Object(je.useEffect)((function(){var e=c.get("page")||1,t=c.get("pageSize")||P,n=(Number(e)-1)*Number(t),r=u.map((function(e,t){var a=n+t+1;return{key:e.id,rank:Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(en,{rank:a})," ",Object(ze.jsx)("span",{children:a})]}),name:e.name,total_purchase:Gt(e.total_purchase)}}));a(r)}),[u]),Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(ua,{}),Object(ze.jsx)(rn.a,{columns:da,dataSource:n,loading:l,pagination:{current:Number(c.get("page"))||1,total:d,pageSize:Number(c.get("pageSize"))||P,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===u.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:800}})]})},ja=function(e){var t,n,a,r=e.branches,c=Object(je.useState)(W.DAILY),i=Object(Pe.a)(c,2),s=i[0],l=i[1],o=Object(fe.c)(),d=Object(Pe.a)(o,1)[0],u=st().setSearchParams,b=(null===(t=d.get("dateRange"))||void 0===t?void 0:t.toString())||W.DAILY;return Object(je.useEffect)((function(){![W.DAILY,W.MONTHLY].includes(b)&&(null===b||void 0===b?void 0:b.indexOf(","))?l(W.DATE_RANGE):l(b)}),[b]),Object(ze.jsxs)(bn.a,{className:"Products_filter",gutter:[16,16],children:[Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{strong:!0,children:"Branch"}),Object(ze.jsx)(pn.a,{className:"w-100",value:Number(d.get("branchId"))||void 0,allowClear:!0,onChange:function(e){u({branchId:e})},children:r.map((function(e){return Object(ze.jsx)(pn.a.Option,{value:e.id,children:e.name},e.id)}))})]}),Object(ze.jsxs)(jn.a,{lg:12,span:24,children:[Object(ze.jsx)(Ne.a.Text,{style:{width:"100%",display:"block"},strong:!0,children:"Date Range"}),Object(ze.jsx)(Pn.a.Group,{options:[{label:"Daily",value:W.DAILY},{label:"Monthly",value:W.MONTHLY},{label:"Select Date Range",value:W.DATE_RANGE}],optionType:"button",value:s,onChange:function(e){var t=e.target.value;l(t),t!==W.DATE_RANGE&&u({dateRange:t})}}),s===W.DATE_RANGE&&Object(ze.jsx)(Sn.a.RangePicker,{defaultPickerValue:2===(null===(n=b.split(","))||void 0===n?void 0:n.length)?[Bt()(b.split(",")[0]),Bt()(b.split(",")[1])]:void 0,defaultValue:2===(null===(a=b.split(","))||void 0===a?void 0:a.length)?[Bt()(b.split(",")[0]),Bt()(b.split(",")[1])]:void 0,format:"MM/DD/YY",onCalendarChange:function(e,t){(null===e||void 0===e?void 0:e[0])&&(null===e||void 0===e?void 0:e[1])&&u({dateRange:t.join(",")})}})]})]})},pa=function(){var e=Object(je.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],r=Object(fe.c)(),c=Object(Pe.a)(r,1)[0],i=st().setSearchParams,s=rt(),l=s.isFetching,o=s.data,d=mt({params:{page:c.get("page"),pageSize:c.get("pageSize"),branchId:c.get("branchId"),dateRange:c.get("dateRange")||W.DAILY}}),u=d.isFetching,b=d.data,j=b.total,p=b.products;Object(je.useEffect)((function(){var e=c.get("page")||1,t=c.get("pageSize")||P,n=(Number(e)-1)*Number(t),r=p.map((function(e,t){var a=n+t+1,r={key:e.id,rank:Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(en,{rank:a})," ",Object(ze.jsx)("span",{children:a})]}),name:e.name,total_sales:Gt(e.total_sales)};return e.product_prices.forEach((function(e){r[String(e.unit_type.id)]="".concat(Gt(e.total_sales)," - (").concat(e.total_quantity,")")})),r}));a(r)}),[p]);var h=Object(je.useCallback)((function(){var e={};Object(Ft.flatten)(null===p||void 0===p?void 0:p.map((function(e){return e.product_prices.map((function(e){return e.unit_type}))}))).forEach((function(t){e[t.name]=t}));var t=Object.keys(e).sort().map((function(t){return{title:e[t].name,dataIndex:String(e[t].id)}}));return[{title:"Rank",dataIndex:"rank"},{title:"Name",dataIndex:"name"},{title:"Total Sales",dataIndex:"total_sales"}].concat(Object(un.a)(t))}),[p]);return Object(ze.jsxs)(ze.Fragment,{children:[Object(ze.jsx)(ja,{branches:o}),Object(ze.jsx)(rn.a,{columns:h(),dataSource:n,loading:u||l,pagination:{current:Number(c.get("page"))||1,total:j,pageSize:Number(c.get("pageSize"))||P,onChange:function(e,t){i({page:e,pageSize:t})},disabled:0===p.length,position:["bottomCenter"],pageSizeOptions:["10","20","50"]},scroll:{x:1250}})]})},ha=function(){var e=st().setSearchParams;return Object(ze.jsx)(Xt,{title:"Reports",children:Object(ze.jsx)(Le,{children:Object(ze.jsxs)(dn.a,{type:"card",destroyInactiveTabPane:!0,onTabClick:function(){e({},{shouldResetPage:!0})},children:[Object(ze.jsx)(dn.a.TabPane,{tab:"Customers",children:Object(ze.jsx)(ba,{})},"customers"),Object(ze.jsx)(dn.a.TabPane,{tab:"Products",children:Object(ze.jsx)(pa,{})},"products")]})})})},Oa=function(){return Object(ze.jsx)(fe.a,{children:Object(ze.jsxs)(ge.e,{children:[Object(ze.jsxs)(ge.c,{element:Object(ze.jsx)(tn,{}),path:"/",children:[Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(vn,{}),path:"dashboard"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(on,{}),path:"branches"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(ia,{}),path:"products"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(oa,{}),path:"products/create"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(oa,{}),path:"products/:productId"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(Qn,{}),path:"preorders"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(na,{}),path:"preorders/:preorderId"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(Jn,{}),path:"preorders/:preorderId/edit"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(Jn,{}),path:"preorders/create"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(gn,{}),path:"deliveries"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(qn,{}),path:"deliveries/:deliveryId"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(zn,{}),path:"deliveries/create"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(ha,{}),path:"reports"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(Yn,{}),path:"notifications"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(Yn,{}),path:"notifications"}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(ge.a,{to:"/dashboard",replace:!0}),path:"/"})]}),Object(ze.jsx)(ge.c,{element:Object(ze.jsx)(yt,{}),path:"login"})]})})},ma=(n(436),function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,613)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))}),va=be();Kt=va,c.a.defaults.baseURL=g.API_URL,c.a.defaults.timeout=4e4,c.a.defaults.headers.common["Content-Type"]="application/json",c.a.interceptors.request.use((function(e){if(e.baseURL!==g.API_URL)return e;var t=Kt.getState().AUTH.accessToken;return e.headers.authorization=t?"Bearer ".concat(t):null,e}),(function(e){return Promise.reject(e)})),c.a.interceptors.response.use(null,(function(e){if(e.config&&e.response&&401===e.response.status){var t=Kt.getState().AUTH.refreshToken;return t?fetch("".concat(g.API_URL,"/tokens/access/verify/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})}).then((function(e){return e.json()})).then((function(e){if("token_not_valid"===(null===e||void 0===e?void 0:e.code))throw Kt.dispatch(h.logout()),new Error("refresh token has already expired");return fetch("".concat(g.API_URL,"/tokens/renew/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})})})).then((function(e){return e.json()})).then((function(t){var n=t.access,a=t.refresh;return Kt.dispatch(h.login({access_token:n,refresh_token:a})),e.config.headers.authorization=n,c.a.request(e.config)})).catch((function(){return Promise.reject(e)})):Promise.reject(e)}return Promise.reject(e)}));var xa=new Oe.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1}}});he.a.render(Object(ze.jsxs)(Oe.QueryClientProvider,{client:xa,children:[Object(ze.jsx)(ve.a,{store:va,children:Object(ze.jsx)(xe.a,{loading:null,persistor:Object(ue.b)(va),children:Object(ze.jsx)(Oa,{})})}),Object(ze.jsx)(me.ReactQueryDevtools,{initialIsOpen:!0})]}),document.getElementById("root")),ma()}},[[437,1,2]]]);
//# sourceMappingURL=main.f383fa9b.chunk.js.map